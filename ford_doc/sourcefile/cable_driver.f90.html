<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for CABLE">
    <meta name="author" content="CABLE community" >
    <link rel="icon" href="../favicon.png">

    <title>cable_driver.F90 &ndash; CABLE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">CABLE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>cable_driver.F90
    <small>Source File</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for source files.">730 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/cable_driver.F90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li class="active">cable_driver.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-0">Programs</a></h3></div>
  <div id="progs-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../program/cable_offline_driver.html">cable_offline_driver</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      <a class="list-group-item" href="../proc/preparefiles.html">prepareFiles</a>
      <a class="list-group-item" href="../proc/renamefiles.html">renameFiles</a>
      <a class="list-group-item" href="../proc/lucdriver.html">LUCdriver</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/cable_driver.f90.html#src">cable_driver.F90</a>
  </div>
</div>

</div>

    </div>
    <div class="col-md-9" id='text'>
      <hr>
<p>subroutine for reading LU input data, zeroing biomass in empty secondary forest tiles
 and tranferring LUC-based age weights for secondary forest to POP structure</p>
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 6.0.2 (20221011.1828)
 -->
<!-- Title: sourcefile~~cable_driver.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilecable_driverf90EfferentGraph" width="641pt" height="1194pt"
 viewBox="0.00 0.00 641.00 1194.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~cable_driver.f90~~EfferentGraph" class="graph" transform="scale(0.401126 0.401126) rotate(0) translate(4 2973.81)">
<title>sourcefile~~cable_driver.f90~~EfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2973.81 1594,-2973.81 1594,4 -4,4"/>
<!-- sourcefile~cable_driver.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~cable_driver.f90</title>
<polygon fill="none" stroke="black" points="1590,-1921.73 1498,-1921.73 1498,-1897.73 1590,-1897.73 1590,-1921.73"/>
<text text-anchor="middle" x="1544" y="-1907.33" font-family="Helvetica,sans-Serif" font-size="10.50">cable_driver.F90</text>
</g>
<!-- sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~cable_common.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/cable_common.f90.html" xlink:title="cable_common.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328,-1787.73 221,-1787.73 221,-1763.73 328,-1763.73 328,-1787.73"/>
<text text-anchor="middle" x="274.5" y="-1773.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_common.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-2913.73C752.92,-2895.04 706.92,-2952.72 599,-2894.73 575.82,-2882.27 585.55,-2861.29 563,-2847.73 530.76,-2828.33 509.68,-2856.2 479.5,-2833.73"/>
</g>
<!-- sourcefile~cbl_soilsnow_init_special.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~cbl_soilsnow_init_special.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/cbl_soilsnow_init_special.f90.html" xlink:title="cbl_soilsnow_init_special.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="752,-2885.73 599,-2885.73 599,-2861.73 752,-2861.73 752,-2885.73"/>
<text text-anchor="middle" x="675.5" y="-2871.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilsnow_init_special.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cbl_soilsnow_init_special.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cbl_soilsnow_init_special.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-2951.73C974.07,-2947.48 956.59,-2926.17 876,-2913.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-2239.73C1254.66,-2522.85 1503.23,-2720.15 1275,-2932.73 1203.99,-2998.87 1154.4,-2956.79 1057.5,-2951.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-2913.73C828.61,-2906.72 777.84,-2896.39 739.14,-2887.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="739.59,-2884.49 729.07,-2885.77 738.09,-2891.33 739.59,-2884.49"/>
</g>
<!-- sourcefile~casa_cable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~casa_cable.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/casa_cable.f90.html" xlink:title="casa_cable.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1257,-456.73 1169,-456.73 1169,-432.73 1257,-432.73 1257,-456.73"/>
<text text-anchor="middle" x="1213" y="-442.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_cable.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_cable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_cable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1004.73C1291.5,-806.36 1234.08,-544.32 1218.39,-467.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1221.78,-466.15 1216.38,-457.03 1214.91,-467.53 1221.78,-466.15"/>
</g>
<!-- sourcefile~cable_cru_trendy.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~cable_cru_trendy.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/cable_cru_trendy.f90.html" xlink:title="cable_cru_TRENDY.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="739.5,-1681.73 611.5,-1681.73 611.5,-1657.73 739.5,-1657.73 739.5,-1681.73"/>
<text text-anchor="middle" x="675.5" y="-1667.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_cru_TRENDY.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_cru_trendy.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_cru_trendy.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-1711.73C829.1,-1703.23 778.72,-1692.5 740.08,-1684.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="740.54,-1680.53 730.02,-1681.79 739.03,-1687.36 740.54,-1680.53"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~cbl_model_driver_offline.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/cbl_model_driver_offline.f90.html" xlink:title="cbl_model_driver_offline.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1462,-2191.73 1311,-2191.73 1311,-2167.73 1462,-2167.73 1462,-2191.73"/>
<text text-anchor="middle" x="1386.5" y="-2177.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_model_driver_offline.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cbl_model_driver_offline.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cbl_model_driver_offline.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1535.91,-1922.03C1511.47,-1964.47 1430.49,-2105.09 1399.61,-2158.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1396.41,-2157.25 1394.45,-2167.66 1402.47,-2160.74 1396.41,-2157.25"/>
</g>
<!-- sourcefile~landuse3.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~landuse3.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/landuse3.f90.html" xlink:title="landuse3.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="914,-218.73 836,-218.73 836,-194.73 914,-194.73 914,-218.73"/>
<text text-anchor="middle" x="875" y="-204.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">landuse3.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~landuse3.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~landuse3.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-404.73C1163.53,-345 1128.13,-357.19 1057.5,-326.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-326.73C1028.24,-314.97 1019.06,-313.66 998,-292.73 975.94,-270.81 986.53,-251.84 962,-232.73 951.12,-224.25 937.49,-218.52 924.31,-214.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="924.93,-211.21 914.37,-212.06 923.16,-217.98 924.93,-211.21"/>
</g>
<!-- sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~cable_phys_constants_mod.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/cable_phys_constants_mod.f90.html" xlink:title="cable_phys_constants_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358,-2422.73 191,-2422.73 191,-2398.73 358,-2398.73 358,-2422.73"/>
<text text-anchor="middle" x="274.5" y="-2408.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_phys_constants_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-2951.73C975.82,-2947.83 955.74,-2949.42 876,-2951.73"/>
</g>
<!-- sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~casa_parm.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/casa_parm.f90.html" xlink:title="casa_parm.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="719.5,-567.73 631.5,-567.73 631.5,-543.73 719.5,-543.73 719.5,-567.73"/>
<text text-anchor="middle" x="675.5" y="-553.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_parm.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-444.73C1002.2,-463.34 1013.66,-507.94 962,-530.73 886.63,-563.98 789.34,-564.68 730,-561.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="729.95,-557.51 719.74,-560.32 729.48,-564.5 729.95,-557.51"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-404.73C1206.41,-397.84 1065.92,-441.94 1057.5,-444.73"/>
</g>
<!-- sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~casa_inout.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/casa_inout.f90.html" xlink:title="casa_inout.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1099.5,-416.73 1013.5,-416.73 1013.5,-392.73 1099.5,-392.73 1099.5,-416.73"/>
<text text-anchor="middle" x="1056.5" y="-402.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_inout.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_inout.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-404.73C1185.81,-372.46 1134.73,-379.25 1098.48,-389.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1097.22,-386.37 1088.69,-392.64 1099.27,-393.06 1097.22,-386.37"/>
</g>
<!-- sourcefile~cable_write.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~cable_write.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/cable_write.f90.html" xlink:title="cable_write.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="919,-1415.73 831,-1415.73 831,-1391.73 919,-1391.73 919,-1415.73"/>
<text text-anchor="middle" x="875" y="-1401.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_write.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_write.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_write.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1361.73C1128.45,-1422.85 1000.86,-1419.76 929.35,-1411.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="929.56,-1408.37 919.22,-1410.68 928.75,-1415.32 929.56,-1408.37"/>
</g>
<!-- sourcefile~cable_namelist_input.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~cable_namelist_input.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/cable_namelist_input.f90.html" xlink:title="cable_namelist_input.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1454,-1881.73 1319,-1881.73 1319,-1857.73 1454,-1857.73 1454,-1881.73"/>
<text text-anchor="middle" x="1386.5" y="-1867.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_namelist_input.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_namelist_input.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_namelist_input.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1497.6,-1898.05C1480.97,-1893.77 1461.93,-1888.87 1444.41,-1884.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1444.86,-1880.87 1434.3,-1881.77 1443.11,-1887.65 1444.86,-1880.87"/>
</g>
<!-- sourcefile~cable_input.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~cable_input.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/cable_input.f90.html" xlink:title="cable_input.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1257.5,-1016.73 1168.5,-1016.73 1168.5,-992.73 1257.5,-992.73 1257.5,-1016.73"/>
<text text-anchor="middle" x="1213" y="-1002.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_input.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_input.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_input.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1004.73C1363.81,-958.95 1295.2,-974.02 1251.62,-989.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1250.39,-986 1242.19,-992.72 1252.79,-992.58 1250.39,-986"/>
</g>
<!-- sourcefile~cable_site.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~cable_site.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/cable_site.f90.html" xlink:title="cable_site.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="716.5,-1807.73 634.5,-1807.73 634.5,-1783.73 716.5,-1783.73 716.5,-1807.73"/>
<text text-anchor="middle" x="675.5" y="-1793.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_site.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_site.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_site.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1909.73C936.44,-1885.23 896.9,-1906.74 788,-1852.73 769.08,-1843.35 770.31,-1832.24 752,-1821.73 743.97,-1817.12 734.98,-1813.14 726.09,-1809.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="727.12,-1806.43 716.53,-1806.38 724.78,-1813.03 727.12,-1806.43"/>
</g>
<!-- sourcefile~cable_plume_mip.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~cable_plume_mip.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/cable_plume_mip.f90.html" xlink:title="cable_plume_mip.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-1723.73 616.5,-1723.73 616.5,-1699.73 734.5,-1699.73 734.5,-1723.73"/>
<text text-anchor="middle" x="675.5" y="-1709.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_plume_mip.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_plume_mip.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_plume_mip.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-1711.73C831.63,-1703.71 783.23,-1703.57 744.94,-1705.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="744.72,-1702.01 734.93,-1706.07 745.11,-1709 744.72,-1702.01"/>
</g>
<!-- sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~cable_iovars.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/cable_iovars.f90.html" xlink:title="cable_iovars.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="525.5,-1240.73 431.5,-1240.73 431.5,-1216.73 525.5,-1216.73 525.5,-1240.73"/>
<text text-anchor="middle" x="478.5" y="-1226.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_iovars.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-1515.73C740.14,-1487.78 705.33,-1463.71 599,-1377.73 552.26,-1339.94 511.81,-1280.97 492.16,-1249.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="494.99,-1247.67 486.75,-1241.01 489.04,-1251.36 494.99,-1247.67"/>
</g>
<!-- sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~casa_dimension.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/casa_dimension.f90.html" xlink:title="casa_dimension.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="534.5,-466.73 422.5,-466.73 422.5,-442.73 534.5,-442.73 534.5,-466.73"/>
<text text-anchor="middle" x="478.5" y="-452.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_dimension.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-90.73C747.05,-61.11 694.47,-103.96 599,-192.73 525.65,-260.93 493.92,-382.85 483.59,-432.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="480.12,-432.15 481.6,-442.64 486.98,-433.51 480.12,-432.15"/>
</g>
<!-- sourcefile~popluc.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~popluc.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/popluc.f90.html" xlink:title="POPLUC.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="913.5,-1298.73 836.5,-1298.73 836.5,-1274.73 913.5,-1274.73 913.5,-1298.73"/>
<text text-anchor="middle" x="875" y="-1284.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POPLUC.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~popluc.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~popluc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1361.73C1154,-1402.56 1125.92,-1303.02 1057.5,-1321.73"/>
</g>
<!-- sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~casa_variable.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/casa_variable.f90.html" xlink:title="casa_variable.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.5,-449.73 625.5,-449.73 625.5,-425.73 725.5,-425.73 725.5,-449.73"/>
<text text-anchor="middle" x="675.5" y="-435.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_variable.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-326.73C1000.79,-303.13 842.59,-320.87 788,-344.73 767.83,-353.54 768.69,-364.38 752,-378.73 735.44,-392.96 716.02,-408.11 701.02,-419.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="698.63,-416.91 692.75,-425.72 702.85,-422.5 698.63,-416.91"/>
</g>
<!-- sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~cable_carbon.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/cable_carbon.f90.html" xlink:title="cable_carbon.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="924.5,-2161.73 825.5,-2161.73 825.5,-2137.73 924.5,-2137.73 924.5,-2161.73"/>
<text text-anchor="middle" x="875" y="-2147.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_carbon.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_carbon.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-2239.73C1300.32,-2415.08 993.4,-2228.44 901.91,-2167.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="903.76,-2164.57 893.51,-2161.9 899.86,-2170.38 903.76,-2164.57"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1542.92,-1921.77C1542,-1964.68 1533.56,-2112.24 1462,-2200.73 1438.5,-2229.79 1403.18,-2205.8 1387.5,-2239.73"/>
</g>
<!-- sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~cable_luc_expt.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/cable_luc_expt.f90.html" xlink:title="cable_LUC_EXPT.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-1259.73 616.5,-1259.73 616.5,-1235.73 734.5,-1235.73 734.5,-1259.73"/>
<text text-anchor="middle" x="675.5" y="-1245.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_LUC_EXPT.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-1515.73C820.77,-1499.51 816.27,-1472.66 788,-1424.73 761.23,-1379.33 781.24,-1355.59 752,-1311.73 739.69,-1293.27 720.6,-1277.16 704.69,-1265.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="706.46,-1262.68 696.25,-1259.85 702.47,-1268.43 706.46,-1262.68"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1361.73C1077.67,-1456.28 1033.14,-1563.6 876,-1515.73"/>
</g>
<!-- sourcefile~cable_climate.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~cable_climate.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/cable_climate.f90.html" xlink:title="cable_climate.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.5,-1765.73 625.5,-1765.73 625.5,-1741.73 725.5,-1741.73 725.5,-1765.73"/>
<text text-anchor="middle" x="675.5" y="-1751.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_climate.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_climate.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_climate.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1909.73C996.74,-1895.21 1014.95,-1840.04 962,-1810.73 890.72,-1771.28 796.03,-1758.91 735.66,-1755.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.72,-1751.66 725.54,-1754.59 735.32,-1758.65 735.72,-1751.66"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1909.73C1145.62,-1892.17 1124.71,-1923.8 1057.5,-1909.73"/>
</g>
<!-- sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~cable_define_types.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/cable_define_types.f90.html" xlink:title="cable_define_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="338,-1345.73 211,-1345.73 211,-1321.73 338,-1321.73 338,-1345.73"/>
<text text-anchor="middle" x="274.5" y="-1331.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_define_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1361.73C1171.07,-1389.28 1159.56,-1328.92 1115,-1307.73 958.12,-1233.1 921.84,-1199.29 752,-1162.73 692.74,-1149.97 536.82,-1131.01 479.5,-1150.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M477.5,-1150.73C440.65,-1162.28 425.76,-1152.76 394,-1174.73 341.43,-1211.09 302.78,-1278.35 285.51,-1312.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="282.31,-1311.14 281.03,-1321.66 288.59,-1314.23 282.31,-1311.14"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1004.73C1310.12,-845.66 1360.28,-1263.82 1214,-1361.73"/>
</g>
<!-- sourcefile~cable_output.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~cable_output.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/cable_output.f90.html" xlink:title="cable_output.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1104.5,-1373.73 1008.5,-1373.73 1008.5,-1349.73 1104.5,-1349.73 1104.5,-1373.73"/>
<text text-anchor="middle" x="1056.5" y="-1359.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_output.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_output.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~cable_output.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1361.73C1182.37,-1383.4 1140.27,-1381.9 1107.5,-1375.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1108.15,-1372.37 1097.65,-1373.8 1106.75,-1379.23 1108.15,-1372.37"/>
</g>
<!-- sourcefile~landuse_constant.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~landuse_constant.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/landuse_constant.f90.html" xlink:title="landuse_constant.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-62.73 616.5,-62.73 616.5,-38.73 734.5,-38.73 734.5,-62.73"/>
<text text-anchor="middle" x="675.5" y="-48.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">landuse_constant.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~landuse_constant.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~landuse_constant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-404.73C1148.99,-327.08 1181.37,-276.52 1115,-201.73 1037.27,-114.12 992.51,-102.67 876,-90.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-90.73C831.15,-80.73 782.74,-70.91 744.57,-63.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="745.08,-60.03 734.6,-61.56 743.75,-66.9 745.08,-60.03"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1004.73C1272.94,-767.2 1449.97,-619.88 1275,-423.73 1256.1,-402.54 1232.58,-426.2 1214,-404.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1543.31,-1897.52C1544.89,-1815.75 1546.73,-1340.76 1387.5,-1004.73"/>
</g>
<!-- sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~casa_ncdf.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/casa_ncdf.f90.html" xlink:title="casa_ncdf.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="520,-1566.73 437,-1566.73 437,-1542.73 520,-1542.73 520,-1566.73"/>
<text text-anchor="middle" x="478.5" y="-1552.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_ncdf.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1497.9,-1916.9C1433.63,-1925.51 1312.57,-1935.8 1214,-1909.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1909.73C1140.07,-1887.35 1177.1,-1813.38 1115,-1770.73 1024.81,-1708.79 983.5,-1732.08 876,-1711.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-1711.73C804.11,-1695.16 816.7,-1636.93 752,-1605.73 721.26,-1590.91 710.23,-1596.92 676.5,-1591.73"/>
</g>
<!-- sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~casa_phenvar.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/casa_phenvar.f90.html" xlink:title="casa_phenvar.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="726,-369.73 625,-369.73 625,-345.73 726,-345.73 726,-369.73"/>
<text text-anchor="middle" x="675.5" y="-355.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_phenvar.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~cable_driver.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-326.73C1028.2,-315.06 1022.69,-309.22 998,-292.73 981.37,-281.62 980.18,-274.08 962,-265.73 926.43,-249.39 915.14,-246.57 876,-246.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-246.73C834.86,-246.89 822.59,-247.41 788,-265.73 768.55,-276.03 768.75,-285.45 752,-299.73 735.7,-313.62 716.56,-328.31 701.63,-339.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="699.34,-336.77 693.38,-345.53 703.5,-342.4 699.34,-336.77"/>
</g>
<!-- sourcefile~cable_runtime_opts_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~cable_runtime_opts_mod.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node32"><a xlink:href=".././sourcefile/cable_runtime_opts_mod.f90.html" xlink:title="cable_runtime_opts_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="155,-1787.73 0,-1787.73 0,-1763.73 155,-1763.73 155,-1787.73"/>
<text text-anchor="middle" x="77.5" y="-1773.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_runtime_opts_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_common.f90&#45;&gt;sourcefile~cable_runtime_opts_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~cable_common.f90&#45;&gt;sourcefile~cable_runtime_opts_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M220.99,-1775.73C203.87,-1775.73 184.39,-1775.73 165.44,-1775.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.29,-1772.23 155.29,-1775.73 165.29,-1779.23 165.29,-1772.23"/>
</g>
<!-- sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff3a00" stroke-dasharray="5,2" d="M598.94,-2873.06C560,-2869.27 513.65,-2859.04 479.5,-2833.73"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~cbl_soilsnow_data.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node36"><a xlink:href=".././sourcefile/cbl_soilsnow_data.f90.html" xlink:title="cbl_soilsnow_data.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="539,-2523.73 418,-2523.73 418,-2499.73 539,-2499.73 539,-2523.73"/>
<text text-anchor="middle" x="478.5" y="-2509.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilsnow_data.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff3a00" stroke-dasharray="5,2" d="M653.39,-2861.62C636.67,-2851.09 613.73,-2834.45 599,-2814.73 530.44,-2722.95 495.55,-2586.68 483.98,-2533.81"/>
<polygon fill="#ff3a00" stroke="#ff3a00" points="487.37,-2532.89 481.86,-2523.84 480.52,-2534.35 487.37,-2532.89"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-752.73C1015.24,-779.25 1006.01,-788.05 962,-807.73 807.39,-876.87 746.99,-841.35 599,-923.73 494.33,-982 451.64,-993.71 394,-1098.73 338.72,-1199.45 377.05,-1241.42 358,-1354.73 332.19,-1508.2 293.55,-1691.62 280.22,-1753.85"/>
<polygon fill="#ff7500" stroke="#ff7500" points="276.78,-1753.2 278.1,-1763.72 283.62,-1754.67 276.78,-1753.2"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1168.77,-437.26C1137.06,-433.55 1093.46,-432.17 1057.5,-444.73"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_inout.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1168.96,-433.59C1150.49,-428.8 1128.74,-423.17 1109.38,-418.16"/>
<polygon fill="#ff7500" stroke="#ff7500" points="1110.06,-414.72 1099.51,-415.6 1108.31,-421.5 1110.06,-414.72"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1172.54,-432.59C1164.81,-428.98 1157.19,-424.42 1151,-418.73 1125.83,-395.59 1134.79,-378.61 1115,-350.73 1057.11,-269.18 1053.66,-225.74 962,-185.73 903.7,-160.28 734.68,-181 676.5,-206.73"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M674.5,-206.73C642.26,-220.54 626.07,-207.42 599,-229.73 531.99,-284.94 497.48,-387.79 485.03,-432.74"/>
<polygon fill="#ff7500" stroke="#ff7500" points="481.59,-432.06 482.4,-442.62 488.35,-433.86 481.59,-432.06"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-364.73C932.01,-315.77 772.49,-386.42 706.81,-420.79"/>
<polygon fill="#ff7500" stroke="#ff7500" points="704.99,-417.79 697.81,-425.57 708.28,-423.96 704.99,-417.79"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_carbon.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-866.73C1044.47,-900.98 1012.39,-890.75 998,-923.73 949.76,-1034.28 996.54,-1893.16 962,-2008.73 947.84,-2056.12 913.71,-2103.66 892.96,-2129.64"/>
<polygon fill="#ff7500" stroke="#ff7500" points="890.08,-2127.62 886.48,-2137.59 895.51,-2132.05 890.08,-2127.62"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-752.73C803.13,-905.67 616.24,-615.6 394,-809.73 316.28,-877.61 284.38,-1219.62 277.16,-1311.16"/>
<polygon fill="#ff7500" stroke="#ff7500" points="273.66,-1311.03 276.38,-1321.27 280.64,-1311.57 273.66,-1311.03"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1209.43,-456.77C1199.99,-499.92 1165.18,-650.4 1115,-766.73 1094.7,-813.8 1073.22,-817.93 1057.5,-866.73"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-866.73C1018.23,-982.43 898.21,-872.45 788,-923.73 769.62,-932.28 770.09,-942.59 752,-951.73 688.95,-983.56 643.83,-940.14 599,-994.73 534.07,-1073.8 601.38,-1358.89 563,-1453.73 549.66,-1486.68 521.5,-1517.04 501.58,-1535.69"/>
<polygon fill="#ff7500" stroke="#ff7500" points="499.16,-1533.15 494.13,-1542.48 503.88,-1538.32 499.16,-1533.15"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-364.73C1030.07,-353.76 1018.08,-359.79 998,-340.73 971.18,-315.27 990.97,-288.7 962,-265.73 931.33,-241.41 915.14,-246.57 876,-246.73"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1177.61,-432.68C1168.61,-428.84 1159.15,-424.15 1151,-418.73 1132.42,-406.37 1134.08,-395.3 1115,-383.73 1091.99,-369.77 1082.21,-375.39 1057.5,-364.73"/>
</g>
<!-- sourcefile~casa_cnp.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~casa_cnp.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node41"><a xlink:href=".././sourcefile/casa_cnp.f90.html" xlink:title="casa_cnp.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="915,-298.73 835,-298.73 835,-274.73 915,-274.73 915,-298.73"/>
<text text-anchor="middle" x="875" y="-284.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_cnp.F90</text>
</a>
</g>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_cnp.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_cnp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-364.73C1004.9,-344.67 947.35,-319.17 911.35,-302.9"/>
<polygon fill="#ff7500" stroke="#ff7500" points="912.79,-299.71 902.24,-298.77 909.9,-306.08 912.79,-299.71"/>
</g>
<!-- sourcefile~cable_phenology.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~cable_phenology.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node45"><a xlink:href=".././sourcefile/cable_phenology.f90.html" xlink:title="cable_phenology.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="932,-644.73 818,-644.73 818,-620.73 932,-620.73 932,-644.73"/>
<text text-anchor="middle" x="875" y="-630.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_phenology.F90</text>
</a>
</g>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_phenology.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_phenology.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.5,-752.73C1005.11,-783.27 1012.52,-689.07 962,-658.73 955.16,-654.62 947.61,-651.11 939.92,-648.13"/>
<polygon fill="#ff7500" stroke="#ff7500" points="941.09,-644.84 930.5,-644.76 938.73,-651.43 941.09,-644.84"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1210.42,-456.91C1203.41,-505.27 1170.31,-684.36 1057.5,-752.73"/>
</g>
<!-- sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ffb000" stroke-dasharray="5,2" d="M617.06,-1657.59C610.21,-1654.08 603.92,-1649.55 599,-1643.73 535.63,-1568.71 590.35,-1520.04 563,-1425.73 543.79,-1359.49 508.52,-1285.71 490.59,-1250.17"/>
<polygon fill="#ffb000" stroke="#ffb000" points="493.48,-1248.12 485.82,-1240.8 487.24,-1251.3 493.48,-1248.12"/>
</g>
<!-- sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ffb000" stroke-dasharray="5,2" d="M623.61,-1657.7C552.63,-1640.1 428.67,-1606.1 394,-1575.73 324.14,-1514.53 291.37,-1402.71 280.17,-1355.59"/>
<polygon fill="#ffb000" stroke="#ffb000" points="283.58,-1354.78 277.94,-1345.81 276.75,-1356.33 283.58,-1354.78"/>
</g>
<!-- sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#ffb000" stroke-dasharray="5,2" d="M626.7,-1657.66C617.06,-1654.05 607.34,-1649.47 599,-1643.73 578.47,-1629.6 582.24,-1616.57 563,-1600.73 549.03,-1589.23 531.77,-1579.17 516.57,-1571.41"/>
<polygon fill="#ffb000" stroke="#ffb000" points="517.94,-1568.18 507.42,-1566.88 514.83,-1574.45 517.94,-1568.18"/>
</g>
<!-- sourcefile~cable_weathergenerator.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~cable_weathergenerator.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node38"><a xlink:href=".././sourcefile/cable_weathergenerator.f90.html" xlink:title="cable_weathergenerator.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553.5,-1685.73 403.5,-1685.73 403.5,-1661.73 553.5,-1661.73 553.5,-1685.73"/>
<text text-anchor="middle" x="478.5" y="-1671.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_weathergenerator.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~cable_weathergenerator.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~cable_cru_trendy.f90&#45;&gt;sourcefile~cable_weathergenerator.f90</title>
<path fill="none" stroke="#ffb000" stroke-dasharray="5,2" d="M611.46,-1671.02C596.31,-1671.33 579.88,-1671.67 563.93,-1672"/>
<polygon fill="#ffb000" stroke="#ffb000" points="563.46,-1668.51 553.53,-1672.21 563.6,-1675.5 563.46,-1668.51"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M477.5,-2185.73C445.74,-2163.76 421.55,-2188.79 394,-2161.73 288.57,-2058.18 276.42,-1863.43 275.42,-1797.89"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="278.92,-1797.83 275.34,-1787.86 271.92,-1797.88 278.92,-1797.83"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1212,-2149.73C1168.47,-2151.19 1158.36,-2159.62 1115,-2163.73 930.19,-2181.25 504.11,-2202.75 479.5,-2185.73"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M674.5,-2951.73C612.92,-2957.69 455.32,-2916.01 394,-2847.73 282.3,-2723.36 274.41,-2504.06 274.93,-2433.37"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="278.44,-2433.04 275.08,-2422.99 271.44,-2432.93 278.44,-2433.04"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1353.56,-2191.75C1338.21,-2199.18 1321.02,-2210.3 1311,-2225.73 1246.01,-2325.77 1309.05,-2377.39 1275,-2491.73 1227.79,-2650.25 1244.48,-2724.82 1115,-2827.73 998.5,-2920.32 928.95,-2851.99 788,-2899.73 736.21,-2917.27 731.1,-2954.66 676.5,-2951.73"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-1947.73C993.44,-1936.43 826.2,-1902.93 788,-1852.73 720.14,-1763.55 813.2,-1443.61 752,-1349.73 709.98,-1285.27 640.2,-1333.71 599,-1268.73 506.55,-1122.94 659.77,-635.69 563,-492.73 556.78,-483.54 547.76,-476.54 537.93,-471.21"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="539.25,-467.97 528.72,-466.78 536.21,-474.27 539.25,-467.97"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_carbon.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-2149.73C1015.28,-2147.52 969.92,-2147.54 934.86,-2148.1"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="934.73,-2144.61 924.8,-2148.29 934.86,-2151.61 934.73,-2144.61"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-1947.73C935.5,-1927.17 895.59,-1945.7 788,-1888.73 768.55,-1878.43 772.16,-1863.57 752,-1854.73 696.41,-1830.35 528.08,-1872.13 479.5,-1835.73"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M477.5,-1835.73C440.18,-1806.66 420.07,-1809.2 394,-1769.73 302.67,-1631.44 281.38,-1424.44 276.72,-1356.34"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="280.19,-1355.71 276.07,-1345.95 273.21,-1356.15 280.19,-1355.71"/>
</g>
<!-- sourcefile~cable_air.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~cable_air.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/cable_air.f90.html" xlink:title="cable_air.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="517,-2081.73 440,-2081.73 440,-2057.73 517,-2057.73 517,-2081.73"/>
<text text-anchor="middle" x="478.5" y="-2067.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_air.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_air.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_air.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1344.6,-2167.69C1310.07,-2158.7 1259.16,-2148.22 1214,-2149.73"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-2149.73C1012.97,-2147.39 1003.98,-2135.91 962,-2128.73 801.86,-2101.34 760.18,-2106.07 599,-2085.73 575.34,-2082.74 549.06,-2079.25 527.19,-2076.28"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="527.54,-2072.8 517.16,-2074.92 526.59,-2079.73 527.54,-2072.8"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1212,-2149.73C1143.37,-2152.03 1126.1,-2152.75 1057.5,-2149.73"/>
</g>
<!-- sourcefile~cbl_snow_aging.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~cbl_snow_aging.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node29"><a xlink:href=".././sourcefile/cbl_snow_aging.f90.html" xlink:title="cbl_snow_aging.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1268.5,-2923.73 1157.5,-2923.73 1157.5,-2899.73 1268.5,-2899.73 1268.5,-2923.73"/>
<text text-anchor="middle" x="1213" y="-2909.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snow_aging.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_snow_aging.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_snow_aging.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1352.27,-2191.79C1336.99,-2199.14 1320.24,-2210.18 1311,-2225.73 1235.98,-2352.01 1359.29,-2765.44 1275,-2885.73 1272.82,-2888.83 1270.2,-2891.57 1267.27,-2893.98"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1265.25,-2891.13 1258.94,-2899.64 1269.18,-2896.92 1265.25,-2891.13"/>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~cbl_soilsnow_main.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node31"><a xlink:href=".././sourcefile/cbl_soilsnow_main.f90.html" xlink:title="cbl_soilsnow_main.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1275,-2482.73 1151,-2482.73 1151,-2458.73 1275,-2458.73 1275,-2482.73"/>
<text text-anchor="middle" x="1213" y="-2468.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilsnow_main.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_soilsnow_main.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_soilsnow_main.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1356.89,-2191.91C1341.54,-2199.67 1323.3,-2211.05 1311,-2225.73 1281.04,-2261.49 1237.25,-2395.77 1220.68,-2448.9"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1217.27,-2448.08 1217.66,-2458.66 1223.96,-2450.15 1217.27,-2448.08"/>
</g>
<!-- sourcefile~cable_roughness.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~cable_roughness.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node33"><a xlink:href=".././sourcefile/cable_roughness.f90.html" xlink:title="cable_roughness.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="733.5,-2237.73 617.5,-2237.73 617.5,-2213.73 733.5,-2213.73 733.5,-2237.73"/>
<text text-anchor="middle" x="675.5" y="-2223.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_roughness.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_roughness.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_roughness.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1346.1,-2191.76C1325.11,-2197.92 1298.78,-2205.25 1275,-2210.73 1204.57,-2226.95 1186.98,-2233.26 1115,-2239.73 983.97,-2251.51 830.13,-2241.02 743.91,-2232.95"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="744.03,-2229.44 733.74,-2231.98 743.36,-2236.41 744.03,-2229.44"/>
</g>
<!-- sourcefile~cbl_masks.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~cbl_masks.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node34"><a xlink:href=".././sourcefile/cbl_masks.f90.html" xlink:title="cbl_masks.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1255.5,-2201.73 1170.5,-2201.73 1170.5,-2177.73 1255.5,-2177.73 1255.5,-2201.73"/>
<text text-anchor="middle" x="1213" y="-2187.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_masks.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_masks.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_masks.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1310.78,-2184.09C1295.52,-2184.98 1279.8,-2185.89 1265.57,-2186.72"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1265.28,-2183.23 1255.51,-2187.31 1265.69,-2190.22 1265.28,-2183.23"/>
</g>
<!-- sourcefile~cbl_init_radiation.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~cbl_init_radiation.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node39"><a xlink:href=".././sourcefile/cbl_init_radiation.f90.html" xlink:title="cbl_init_radiation.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1270.5,-2121.73 1155.5,-2121.73 1155.5,-2097.73 1270.5,-2097.73 1270.5,-2121.73"/>
<text text-anchor="middle" x="1213" y="-2107.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_init_radiation.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_init_radiation.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_init_radiation.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1356.02,-2167.7C1327.55,-2156.08 1284.27,-2138.41 1252.97,-2125.64"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1254.25,-2122.38 1243.67,-2121.84 1251.61,-2128.86 1254.25,-2122.38"/>
</g>
<!-- sourcefile~cbl_albedo.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~cbl_albedo.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node42"><a xlink:href=".././sourcefile/cbl_albedo.f90.html" xlink:title="cbl_albedo.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1256,-2058.73 1170,-2058.73 1170,-2034.73 1256,-2034.73 1256,-2058.73"/>
<text text-anchor="middle" x="1213" y="-2044.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_albedo.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_albedo.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_albedo.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1371.51,-2167.55C1350.84,-2149.71 1310.72,-2115.66 1275,-2088.73 1264.09,-2080.51 1251.73,-2071.87 1241,-2064.59"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1242.69,-2061.51 1232.44,-2058.82 1238.78,-2067.31 1242.69,-2061.51"/>
</g>
<!-- sourcefile~cable_other_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~cable_other_constants_mod.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node43"><a xlink:href=".././sourcefile/cable_other_constants_mod.f90.html" xlink:title="cable_other_constants_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="563,-2039.73 394,-2039.73 394,-2015.73 563,-2015.73 563,-2039.73"/>
<text text-anchor="middle" x="478.5" y="-2025.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_other_constants_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-1947.73C1006.68,-1938.87 1008.06,-1990.29 962,-2008.73 873.87,-2044.01 846.53,-2039.03 752,-2047.73 684.29,-2053.96 666.77,-2053.36 599,-2047.73 582.86,-2046.39 565.61,-2044.04 549.39,-2041.42"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="549.88,-2037.95 539.44,-2039.76 548.72,-2044.86 549.88,-2037.95"/>
</g>
<!-- sourcefile~cable_maths_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~cable_maths_constants_mod.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node44"><a xlink:href=".././sourcefile/cable_maths_constants_mod.f90.html" xlink:title="cable_maths_constants_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="962,-1843.73 788,-1843.73 788,-1819.73 962,-1819.73 962,-1843.73"/>
<text text-anchor="middle" x="875" y="-1829.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_maths_constants_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-1947.73C1027.83,-1946.63 1018.57,-1942.27 998,-1923.73 973.18,-1901.36 987.93,-1878.8 962,-1857.73 957.35,-1853.95 952.15,-1850.72 946.69,-1847.95"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="947.83,-1844.63 937.27,-1843.73 944.96,-1851.02 947.83,-1844.63"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1379.91,-2167.41C1366.19,-2138.5 1328.06,-2065.76 1275,-2025.73 1193.02,-1963.88 1160.11,-1951.79 1057.5,-1947.73"/>
</g>
<!-- sourcefile~cable_sli_main.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~cable_sli_main.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node46"><a xlink:href=".././sourcefile/cable_sli_main.f90.html" xlink:title="cable_sli_main.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="927.5,-1999.73 822.5,-1999.73 822.5,-1975.73 927.5,-1975.73 927.5,-1999.73"/>
<text text-anchor="middle" x="875" y="-1985.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_main.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_sli_main.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_sli_main.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.5,-1947.73C1031.11,-1946.76 971.8,-1961.23 928,-1973.03"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="927.08,-1969.65 918.34,-1975.65 928.91,-1976.41 927.08,-1969.65"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M845.96,-218.8C826.6,-228.61 801.93,-244.33 788,-265.73 740.4,-338.86 787.81,-379.16 752,-458.73 738.44,-488.87 713.65,-518.04 696.19,-536.39"/>
<polygon fill="#d7ff00" stroke="#d7ff00" points="693.67,-533.95 689.2,-543.56 698.69,-538.84 693.67,-533.95"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M835.94,-211.73C773.49,-222.22 651.02,-252.94 599,-336.73 501.86,-493.2 648.07,-1001.38 563,-1164.73 552.51,-1184.87 532.52,-1200.54 514.72,-1211.34"/>
<polygon fill="#d7ff00" stroke="#d7ff00" points="512.6,-1208.52 505.68,-1216.54 516.09,-1214.59 512.6,-1208.52"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M835.74,-197.92C794.52,-190.38 727.93,-183.99 676.5,-206.73"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M847.55,-218.92C828.47,-228.97 803.44,-244.95 788,-265.73 756.57,-308.04 782.11,-335.46 752,-378.73 740.32,-395.51 722.46,-409.77 707.04,-420.07"/>
<polygon fill="#d7ff00" stroke="#d7ff00" points="704.84,-417.32 698.31,-425.67 708.62,-423.22 704.84,-417.32"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M674.5,-168.73C588.89,-139.23 543.5,-45.68 479.5,-109.73"/>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M835.68,-202.62C795.26,-197.54 730.14,-187.21 676.5,-168.73"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~landuse_constant.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~landuse_constant.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M857.33,-194.7C839.86,-182.02 811.73,-161.33 788,-142.73 756.47,-118.02 720.92,-88.36 698.61,-69.53"/>
<polygon fill="#d7ff00" stroke="#d7ff00" points="700.64,-66.66 690.75,-62.87 696.12,-72 700.64,-66.66"/>
</g>
<!-- sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~landuse3.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#d7ff00" stroke-dasharray="5,2" d="M835.99,-211.87C819.88,-215.56 801.7,-221.89 788,-232.73 763.01,-252.5 772.55,-270.37 752,-294.73 737.51,-311.91 717.96,-328.07 702.39,-339.73"/>
<polygon fill="#d7ff00" stroke="#d7ff00" points="700.2,-336.99 694.2,-345.72 704.34,-342.64 700.2,-336.99"/>
</g>
<!-- sourcefile~casa_parm.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~casa_parm.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#62ff00" stroke-dasharray="5,2" d="M654.24,-543.58C632.12,-530.47 595.5,-509.27 563,-492.73 548.1,-485.15 531.37,-477.39 516.82,-470.88"/>
<polygon fill="#62ff00" stroke="#62ff00" points="518.18,-467.65 507.62,-466.8 515.34,-474.05 518.18,-467.65"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M674.5,-477.73C647.51,-499.21 624.11,-472.08 599,-495.73 558.78,-533.62 603.99,-577.68 563,-614.73 506.22,-666.05 444.14,-589.91 394,-647.73 342.47,-707.15 367.59,-1276.66 358,-1354.73 339.07,-1508.85 296.26,-1691.16 281.02,-1753.53"/>
<polygon fill="#27ff00" stroke="#27ff00" points="277.57,-1752.89 278.58,-1763.43 284.37,-1754.56 277.57,-1752.89"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M874,-440.73C862.9,-441.89 685.24,-470.78 676.5,-477.73"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M874,-516.73C826.45,-532.69 770.15,-543.01 729.85,-549"/>
<polygon fill="#27ff00" stroke="#27ff00" points="729.1,-545.57 719.7,-550.47 730.1,-552.5 729.1,-545.57"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M674.5,-477.73C646.95,-499.65 620.55,-473.88 599,-501.73 508.69,-618.42 631.86,-1034.23 563,-1164.73 552.33,-1184.95 532.13,-1200.7 514.27,-1211.51"/>
<polygon fill="#27ff00" stroke="#27ff00" points="512.14,-1208.7 505.21,-1216.72 515.62,-1214.77 512.14,-1208.7"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1013.44,-415.83C977.3,-424.73 923.64,-436.41 876,-440.73"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M874,-440.73C818.96,-445.72 807,-422.09 752,-416.73 684.32,-410.14 666.2,-406.3 599,-416.73 571.33,-421.02 541.3,-430.59 518.26,-439.06"/>
<polygon fill="#27ff00" stroke="#27ff00" points="516.97,-435.8 508.84,-442.6 519.44,-442.35 516.97,-435.8"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M874,-440.73C827.76,-444.92 775.18,-443.84 735.91,-441.89"/>
<polygon fill="#27ff00" stroke="#27ff00" points="735.88,-438.38 725.71,-441.35 735.51,-445.37 735.88,-438.38"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M477.5,-109.73C388.21,-199.09 292.92,-1152.74 277.62,-1311.41"/>
<polygon fill="#27ff00" stroke="#27ff00" points="274.13,-1311.15 276.66,-1321.44 281.1,-1311.82 274.13,-1311.15"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1015.16,-392.58C1008.63,-389.04 1002.53,-384.5 998,-378.73 944.14,-310.08 1015.48,-254.67 962,-185.73 909.72,-118.33 848.67,-164.69 788,-104.73 761.7,-78.74 783.29,-49.42 752,-29.73 645.17,37.49 568.72,-20.44 479.5,-109.73"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1026.01,-416.78C1016.85,-420.86 1006.85,-425.67 998,-430.73 940.41,-463.65 938.89,-495.61 876,-516.73"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M874,-516.73C757.89,-555.71 684.47,-446.99 599,-534.73 527.69,-607.93 599.48,-1358.27 563,-1453.73 550.31,-1486.94 522,-1517.24 501.87,-1535.8"/>
<polygon fill="#27ff00" stroke="#27ff00" points="499.45,-1533.27 494.34,-1542.56 504.12,-1538.49 499.45,-1533.27"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1013.49,-399.52C946.08,-391.16 813.48,-374.72 736.24,-365.14"/>
<polygon fill="#27ff00" stroke="#27ff00" points="736.53,-361.65 726.18,-363.89 735.67,-368.59 736.53,-361.65"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_cnp.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_cnp.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1025.27,-392.67C1016.27,-388.65 1006.54,-383.88 998,-378.73 980.64,-368.26 978.13,-363 962,-350.73 941.57,-335.18 918.18,-317.81 900.96,-305.09"/>
<polygon fill="#27ff00" stroke="#27ff00" points="902.69,-302.01 892.56,-298.89 898.53,-307.65 902.69,-302.01"/>
</g>
<!-- sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff13" stroke-dasharray="5,2" d="M830.99,-1398.81C790.28,-1393.29 727.92,-1382.52 676.5,-1363.73"/>
</g>
<!-- sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff13" stroke-dasharray="5,2" d="M843.19,-1415.75C774.89,-1440.48 606.74,-1490.61 479.5,-1439.73"/>
<path fill="none" stroke="#00ff13" stroke-dasharray="5,2" d="M477.5,-1439.73C413.85,-1413.07 343.27,-1373.6 304.68,-1351.1"/>
<polygon fill="#00ff13" stroke="#00ff13" points="305.98,-1347.81 295.58,-1345.77 302.44,-1353.85 305.98,-1347.81"/>
</g>
<!-- sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~cable_abort.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node47"><a xlink:href=".././sourcefile/cable_abort.f90.html" xlink:title="cable_abort.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="721,-1027.73 630,-1027.73 630,-1003.73 721,-1003.73 721,-1027.73"/>
<text text-anchor="middle" x="675.5" y="-1013.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_abort.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00ff13" stroke-dasharray="5,2" d="M858.67,-1391.6C838.82,-1374.97 804.81,-1343.1 788,-1307.73 743.97,-1215.07 802.27,-1169.16 752,-1079.73 741.27,-1060.65 722.52,-1044.7 706.39,-1033.51"/>
<polygon fill="#00ff13" stroke="#00ff13" points="708.04,-1030.4 697.77,-1027.78 704.16,-1036.23 708.04,-1030.4"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1210.06,-1017.05C1200.16,-1079.08 1154.25,-1357.24 1115,-1434.73 1014.93,-1632.3 887.25,-1612.75 788,-1810.73 754.17,-1878.22 792.66,-1913.12 752,-1976.73 729.35,-2012.15 716.4,-2020.48 676.5,-2033.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M874,-592.73C825.5,-581.67 769.76,-571.45 729.89,-564.57"/>
<polygon fill="#00ff89" stroke="#00ff89" points="730.3,-561.09 719.85,-562.85 729.12,-567.99 730.3,-561.09"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_inout.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1211.47,-992.51C1207.99,-917.85 1186.43,-523.38 1115,-430.73 1112.55,-427.55 1109.62,-424.75 1106.4,-422.28"/>
<polygon fill="#00ff89" stroke="#00ff89" points="1108.22,-419.29 1097.92,-416.81 1104.43,-425.17 1108.22,-419.29"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M874,-1245.73C819.35,-1240.7 806.71,-1230.96 752,-1226.73 684.2,-1221.48 667,-1226.16 599,-1226.73 578.42,-1226.9 555.84,-1227.24 535.91,-1227.59"/>
<polygon fill="#00ff89" stroke="#00ff89" points="535.68,-1224.09 525.75,-1227.78 535.81,-1231.09 535.68,-1224.09"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1204,-1016.88C1170.39,-1066.28 1034.97,-1249.31 876,-1245.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1055.5,-984.73C1030.21,-975.52 1015.16,-986.47 998,-965.73 919.71,-871.09 1045.11,-782.16 962,-691.73 908.44,-633.45 865.22,-671.15 788,-653.73 703.87,-634.75 662.08,-668.55 599,-609.73 559.21,-572.62 598.92,-533.59 563,-492.73 554.95,-483.57 544.25,-476.49 533.2,-471.07"/>
<polygon fill="#00ff89" stroke="#00ff89" points="534.44,-467.79 523.88,-466.89 531.57,-474.18 534.44,-467.79"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1168.17,-1004.15C1136.56,-1002.52 1093.33,-997.78 1057.5,-984.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~popluc.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~popluc.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1055.5,-1321.73C1005.81,-1335.32 947.01,-1317.63 910.6,-1302.84"/>
<polygon fill="#00ff89" stroke="#00ff89" points="911.52,-1299.43 900.95,-1298.78 908.81,-1305.89 911.52,-1299.43"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1211.54,-1017.01C1208.77,-1070.94 1189.49,-1285.63 1057.5,-1321.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M874,-592.73C792.17,-574.07 721.7,-495.78 691.8,-458.13"/>
<polygon fill="#00ff89" stroke="#00ff89" points="694.31,-455.65 685.4,-449.91 688.78,-459.95 694.31,-455.65"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1055.5,-592.73C997.46,-538 953.78,-610.47 876,-592.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M874,-1245.73C831.24,-1241.8 783.06,-1242.19 744.98,-1243.62"/>
<polygon fill="#00ff89" stroke="#00ff89" points="744.38,-1240.14 734.53,-1244.05 744.66,-1247.13 744.38,-1240.14"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M477.5,-823.73C443.48,-841.99 420.74,-819.88 394,-847.73 327.88,-916.6 287.93,-1225.65 277.96,-1311.53"/>
<polygon fill="#00ff89" stroke="#00ff89" points="274.48,-1311.16 276.83,-1321.5 281.44,-1311.96 274.48,-1311.16"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1200.54,-992.65C1183.42,-975.22 1149.47,-943.01 1115,-923.73 1096.43,-913.34 773,-805.16 752,-801.73 684.89,-790.75 666.72,-795.55 599,-801.73 572.11,-804.18 503.29,-810.96 479.5,-823.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M674.5,-1591.73C625.84,-1579.88 569.57,-1569.56 530.03,-1562.85"/>
<polygon fill="#00ff89" stroke="#00ff89" points="530.54,-1559.39 520.09,-1561.18 529.38,-1566.29 530.54,-1559.39"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1212.09,-1016.93C1211.86,-1067.37 1204.95,-1262.6 1115,-1382.73 1082.65,-1425.93 728.94,-1604.5 676.5,-1591.73"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1055.5,-592.73C958.17,-500.95 894.95,-535.09 788,-454.73 769.4,-440.75 769.21,-432.38 752,-416.73 736.05,-402.23 716.91,-387.29 701.89,-376.08"/>
<polygon fill="#00ff89" stroke="#00ff89" points="703.7,-373.06 693.57,-369.93 699.54,-378.69 703.7,-373.06"/>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1211.3,-992.42C1207.47,-936.92 1184.21,-707.73 1057.5,-592.73"/>
</g>
<!-- sourcefile~cable_initialise.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~cable_initialise.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node30"><a xlink:href=".././sourcefile/cable_initialise.f90.html" xlink:title="cable_initialise.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1108,-1036.73 1005,-1036.73 1005,-1012.73 1108,-1012.73 1108,-1036.73"/>
<text text-anchor="middle" x="1056.5" y="-1022.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_initialise.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_initialise.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_initialise.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1168.14,-1010.41C1152.63,-1012.42 1134.89,-1014.71 1118.22,-1016.87"/>
<polygon fill="#00ff89" stroke="#00ff89" points="1117.48,-1013.44 1108.02,-1018.19 1118.38,-1020.38 1117.48,-1013.44"/>
</g>
<!-- sourcefile~cbl_sinbet.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~cbl_sinbet.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node35"><a xlink:href=".././sourcefile/cbl_sinbet.f90.html" xlink:title="cbl_sinbet.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.5,-1803.73 1015.5,-1803.73 1015.5,-1779.73 1097.5,-1779.73 1097.5,-1803.73"/>
<text text-anchor="middle" x="1056.5" y="-1789.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_sinbet.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cbl_sinbet.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cbl_sinbet.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1209.63,-1016.78C1192.29,-1105.11 1084.81,-1652.6 1061.82,-1769.7"/>
<polygon fill="#00ff89" stroke="#00ff89" points="1058.36,-1769.17 1059.87,-1779.66 1065.23,-1770.52 1058.36,-1769.17"/>
</g>
<!-- sourcefile~cable_parameters.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~cable_parameters.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node37"><a xlink:href=".././sourcefile/cable_parameters.f90.html" xlink:title="cable_parameters.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="935.5,-724.73 814.5,-724.73 814.5,-700.73 935.5,-700.73 935.5,-724.73"/>
<text text-anchor="middle" x="875" y="-710.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_parameters.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_parameters.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_parameters.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1203.17,-992.64C1187.01,-970.94 1151.02,-924.5 1115,-890.73 1053.13,-832.74 1030.01,-827.38 962,-776.73 941.28,-761.3 917.75,-743.79 900.54,-730.99"/>
<polygon fill="#00ff89" stroke="#00ff89" points="902.28,-727.92 892.17,-724.76 898.1,-733.54 902.28,-727.92"/>
</g>
<!-- sourcefile~cable_read.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~cable_read.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node40"><a xlink:href=".././sourcefile/cable_read.f90.html" xlink:title="cable_read.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="919,-956.73 831,-956.73 831,-932.73 919,-932.73 919,-956.73"/>
<text text-anchor="middle" x="875" y="-942.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_read.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_read.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_read.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1055.5,-984.73C1014.25,-969.65 965.5,-959.22 929.22,-952.81"/>
<polygon fill="#00ff89" stroke="#00ff89" points="929.78,-949.35 919.34,-951.1 928.6,-956.25 929.78,-949.35"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1055.5,-984.73C997.44,-963.5 821.49,-989.92 731.21,-1005.64"/>
<polygon fill="#00ff89" stroke="#00ff89" points="730.41,-1002.23 721.17,-1007.4 731.62,-1009.12 730.41,-1002.23"/>
</g>
<!-- sourcefile~cable_metutils.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~cable_metutils.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node48"><a xlink:href=".././sourcefile/cable_metutils.f90.html" xlink:title="cable_metutils.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1108,-956.73 1005,-956.73 1005,-932.73 1108,-932.73 1108,-956.73"/>
<text text-anchor="middle" x="1056.5" y="-942.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_metutils.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_metutils.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_metutils.f90</title>
<path fill="none" stroke="#00ff89" stroke-dasharray="5,2" d="M1180.73,-992.59C1156.89,-983.33 1123.85,-970.5 1097.98,-960.45"/>
<polygon fill="#00ff89" stroke="#00ff89" points="1099.04,-957.11 1088.45,-956.75 1096.51,-963.63 1099.04,-957.11"/>
</g>
<!-- sourcefile~cable_site.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~cable_site.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M634.42,-1793.72C564.79,-1790.23 421.05,-1783.02 338.15,-1778.87"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="338.27,-1775.37 328.1,-1778.37 337.92,-1782.36 338.27,-1775.37"/>
</g>
<!-- sourcefile~cable_site.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~cable_site.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M634.34,-1793.42C621.22,-1790.6 607.78,-1785.13 599,-1774.73 548.7,-1715.15 582.43,-1501.24 563,-1425.73 545.82,-1358.98 509.68,-1285.49 491.09,-1250.11"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="494.12,-1248.36 486.34,-1241.17 487.94,-1251.65 494.12,-1248.36"/>
</g>
<!-- sourcefile~cable_site.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~cable_site.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M634.19,-1792.2C621.52,-1789.24 608.4,-1783.99 599,-1774.73 558.71,-1735.07 589.92,-1702.44 563,-1652.73 546.42,-1622.12 519.11,-1592.48 500.26,-1573.96"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="502.39,-1571.15 492.75,-1566.73 497.53,-1576.19 502.39,-1571.15"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M477.5,-1716.73C414.79,-1695.75 339.79,-1733.92 301.21,-1758.1"/>
<polygon fill="#00ffff" stroke="#00ffff" points="299.18,-1755.25 292.66,-1763.6 302.97,-1761.13 299.18,-1755.25"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M616.31,-1703.31C609.75,-1700.25 603.74,-1696.16 599,-1690.73 559.94,-1645.94 578.74,-1483.04 563,-1425.73 544.66,-1358.93 508.74,-1284.93 490.57,-1249.65"/>
<polygon fill="#00ffff" stroke="#00ffff" points="493.67,-1248.02 485.95,-1240.77 487.46,-1251.25 493.67,-1248.02"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M616.22,-1723.45C576.64,-1728.97 523.66,-1731.5 479.5,-1716.73"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M477.5,-1716.73C441.11,-1704.55 421.93,-1721.05 394,-1694.73 293.66,-1600.19 278.17,-1419.42 275.87,-1356.21"/>
<polygon fill="#00ffff" stroke="#00ffff" points="279.36,-1355.72 275.58,-1345.83 272.36,-1355.92 279.36,-1355.72"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M617.31,-1699.7C610.9,-1697.23 604.65,-1694.27 599,-1690.73 592.57,-1686.69 527.67,-1611.15 496.3,-1574.44"/>
<polygon fill="#00ffff" stroke="#00ffff" points="498.95,-1572.16 489.8,-1566.82 493.63,-1576.7 498.95,-1572.16"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_weathergenerator.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_weathergenerator.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M616.26,-1700.38C595.82,-1696.4 572.61,-1691.87 551.19,-1687.7"/>
<polygon fill="#00ffff" stroke="#00ffff" points="551.66,-1684.22 541.17,-1685.75 550.32,-1691.1 551.66,-1684.22"/>
</g>
<!-- sourcefile~cable_iovars.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~cable_iovars.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M454.33,-1240.77C418.27,-1259.51 348.65,-1295.71 307.72,-1316.98"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="305.97,-1313.95 298.71,-1321.66 309.2,-1320.16 305.97,-1313.95"/>
</g>
<!-- sourcefile~casa_dimension.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~casa_dimension.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#0089ff" stroke-dasharray="5,2" d="M429.84,-466.9C416.31,-472.61 402.87,-480.86 394,-492.73 343.23,-560.66 288.01,-1185.68 277.34,-1311.66"/>
<polygon fill="#0089ff" stroke="#0089ff" points="273.85,-1311.42 276.5,-1321.68 280.82,-1312 273.85,-1311.42"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M861.25,-1299.02C840.22,-1318.6 796.18,-1356.81 752,-1377.73 688.67,-1407.71 659.53,-1380.43 599,-1415.73 578.9,-1427.45 581.84,-1440.07 563,-1453.73 495.72,-1502.5 453.15,-1475.36 394,-1533.73 328.34,-1598.52 293.52,-1707.08 280.99,-1753.54"/>
<polygon fill="#004eff" stroke="#004eff" points="277.54,-1752.9 278.4,-1763.46 284.32,-1754.67 277.54,-1752.9"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M836.18,-1284.1C818.89,-1280.86 799.71,-1274.01 788,-1259.73 740.39,-1201.65 763.56,-997.93 752,-923.73 731.39,-791.45 695.29,-634.7 681.79,-577.77"/>
<polygon fill="#004eff" stroke="#004eff" points="685.2,-576.96 679.47,-568.04 678.39,-578.58 685.2,-576.96"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M836.24,-1287.31C782.87,-1287.45 682.56,-1285.16 599,-1268.73 571.2,-1263.26 540.95,-1253.09 517.84,-1244.37"/>
<polygon fill="#004eff" stroke="#004eff" points="518.99,-1241.07 508.4,-1240.74 516.47,-1247.6 518.99,-1241.07"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M836.26,-1284.47C818.77,-1281.33 799.39,-1274.46 788,-1259.73 738.67,-1195.92 780.07,-610.34 752,-534.73 740.56,-503.92 715.56,-475.08 697.46,-456.98"/>
<polygon fill="#004eff" stroke="#004eff" points="699.79,-454.37 690.18,-449.91 694.91,-459.39 699.79,-454.37"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M836.39,-1279.3C810.43,-1274.18 775.19,-1267.22 744.39,-1261.14"/>
<polygon fill="#004eff" stroke="#004eff" points="745.06,-1257.7 734.57,-1259.2 743.7,-1264.57 745.06,-1257.7"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M836.11,-1278.67C820.56,-1274.41 802.78,-1268.25 788,-1259.73 769.2,-1248.89 770.98,-1237.27 752,-1226.73 697.04,-1196.21 539.22,-1131.1 479.5,-1150.73"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M863.33,-1299.04C838.48,-1327.54 776.93,-1397.07 752,-1415.73 677.19,-1471.72 576.5,-1516.4 520.84,-1538.87"/>
<polygon fill="#004eff" stroke="#004eff" points="519.3,-1535.72 511.31,-1542.68 521.9,-1542.22 519.3,-1535.72"/>
</g>
<!-- sourcefile~casa_variable.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~casa_variable.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#0013ff" stroke-dasharray="5,2" d="M625.29,-442.02C600.89,-444.15 571.09,-446.74 544.8,-449.04"/>
<polygon fill="#0013ff" stroke="#0013ff" points="544.2,-445.58 534.54,-449.93 544.81,-452.55 544.2,-445.58"/>
</g>
<!-- sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M477.5,-2109.73C448.5,-2085.08 422.68,-2115.75 394,-2090.73 303.4,-2011.69 281.88,-1856.18 276.93,-1798.21"/>
<polygon fill="#2700ff" stroke="#2700ff" points="280.4,-1797.67 276.15,-1787.97 273.42,-1798.21 280.4,-1797.67"/>
</g>
<!-- sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M674.5,-2147.73C619.87,-2150.08 614.5,-2181.35 563,-2199.73 490,-2225.78 457.84,-2198.79 394,-2242.73 338.91,-2280.65 300.98,-2353.07 284.6,-2389.16"/>
<polygon fill="#2700ff" stroke="#2700ff" points="281.4,-2387.76 280.56,-2398.32 287.8,-2390.59 281.4,-2387.76"/>
</g>
<!-- sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M674.5,-2147.73C623.85,-2149.78 612.79,-2133.26 563,-2123.73 526.04,-2116.66 508.17,-2134.1 479.5,-2109.73"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M825.28,-2147.86C785.29,-2146.66 727.21,-2145.67 676.5,-2147.73"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M477.5,-2109.73C448.5,-2085.08 419.29,-2119.17 394,-2090.73 344.1,-2034.62 369.23,-1828.98 358,-1754.73 334.78,-1601.2 294.66,-1418.52 280.57,-1355.99"/>
<polygon fill="#2700ff" stroke="#2700ff" points="283.95,-1355.04 278.32,-1346.06 277.12,-1356.59 283.95,-1355.04"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#6200ff" stroke-dasharray="5,2" d="M477.5,-1188.73C442.24,-1203.05 420.67,-1180.58 394,-1207.73 384.06,-1217.85 299.84,-1650.06 279.78,-1753.61"/>
<polygon fill="#6200ff" stroke="#6200ff" points="276.31,-1753.1 277.85,-1763.58 283.18,-1754.43 276.31,-1753.1"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#6200ff" stroke-dasharray="5,2" d="M616.26,-1242.05C590.81,-1239.57 561.08,-1236.68 535.85,-1234.22"/>
<polygon fill="#6200ff" stroke="#6200ff" points="535.99,-1230.72 525.7,-1233.23 535.31,-1237.68 535.99,-1230.72"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#6200ff" stroke-dasharray="5,2" d="M477.5,-1188.73C442.24,-1203.05 427.03,-1188.82 394,-1207.73 347.67,-1234.25 308.55,-1284.69 288.96,-1313.05"/>
<polygon fill="#6200ff" stroke="#6200ff" points="286,-1311.17 283.3,-1321.42 291.8,-1315.09 286,-1311.17"/>
<path fill="none" stroke="#6200ff" stroke-dasharray="5,2" d="M638.68,-1235.72C626.1,-1231.41 611.89,-1226.45 599,-1221.73 547.27,-1202.77 530.55,-1168 479.5,-1188.73"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#6200ff" stroke-dasharray="5,2" d="M668.98,-1259.81C653.92,-1292.33 610.08,-1383.94 563,-1453.73 542.76,-1483.73 515.43,-1515.45 497.64,-1535.16"/>
<polygon fill="#6200ff" stroke="#6200ff" points="495.02,-1532.84 490.87,-1542.59 500.19,-1537.56 495.02,-1532.84"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M477.5,-1755.73C425.02,-1734.53 358.87,-1747.8 316.87,-1760.64"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="315.72,-1757.33 307.25,-1763.7 317.84,-1764 315.72,-1757.33"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M625.38,-1748.96C615.36,-1745.76 605.81,-1740.69 599,-1732.73 554.32,-1680.55 580.58,-1492.13 563,-1425.73 545.27,-1358.77 509.07,-1284.84 490.71,-1249.61"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="493.79,-1247.96 486.04,-1240.74 487.6,-1251.22 493.79,-1247.96"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M477.5,-1755.73C441.58,-1741.22 421.38,-1758.13 394,-1730.73 286.59,-1623.23 275.76,-1422.76 275.25,-1356"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="278.75,-1355.8 275.25,-1345.8 271.75,-1355.8 278.75,-1355.8"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M625.29,-1764.39C584.66,-1770.85 526.27,-1774.62 479.5,-1755.73"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M625.47,-1746.8C615.91,-1743.69 606.53,-1739.2 599,-1732.73 569.42,-1707.33 583.85,-1685.67 563,-1652.73 544.28,-1623.15 517.21,-1593.08 499.01,-1574.19"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="501.3,-1571.53 491.81,-1566.82 496.29,-1576.42 501.3,-1571.53"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M1045.36,-1374.08C997.51,-1432.41 796.19,-1678.37 788,-1697.73 739.27,-1812.87 814.8,-1868.62 752,-1976.73 730.88,-2013.09 716.69,-2021.39 676.5,-2033.73"/>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M674.5,-2033.73C672.6,-2034.38 395.63,-1964.91 394,-1963.73 334.32,-1920.54 297.75,-1837.19 283.01,-1797.62"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="286.27,-1796.33 279.58,-1788.12 279.68,-1798.71 286.27,-1796.33"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_write.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_write.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M1008.34,-1372.76C983.95,-1378.47 954.09,-1385.46 928.91,-1391.35"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="928.1,-1387.94 919.16,-1393.63 929.69,-1394.76 928.1,-1387.94"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M674.5,-1363.73C641.43,-1351.64 629.41,-1357.47 599,-1339.73 556.81,-1315.11 517.22,-1273.27 495.88,-1248.6"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="498.51,-1246.29 489.37,-1240.94 493.18,-1250.82 498.51,-1246.29"/>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M1008.43,-1366.02C920.79,-1373.35 736.06,-1385.49 676.5,-1363.73"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M1053.28,-1349.46C1041.12,-1282.56 982.39,-963.3 962,-923.73 909.54,-821.95 838.86,-836.32 788,-733.73 748.08,-653.2 788.66,-616.79 752,-534.73 738.52,-504.55 713.72,-475.39 696.22,-457.05"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="698.72,-454.6 689.23,-449.89 693.71,-459.49 698.72,-454.6"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M1023.31,-1373.74C1014.73,-1377.61 1005.71,-1382.32 998,-1387.73 979.22,-1400.91 982.13,-1413.72 962,-1424.73 773.77,-1527.69 677.39,-1522.62 479.5,-1439.73"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M1044.26,-1349.63C1026.97,-1331.15 992.64,-1294.95 962,-1265.73 871.78,-1179.68 846.23,-1161.38 752,-1079.73 734.25,-1064.35 713.93,-1047.15 698.85,-1034.45"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="700.96,-1031.66 691.05,-1027.91 696.46,-1037.02 700.96,-1031.66"/>
</g>
<!-- sourcefile~landuse_constant.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~landuse_constant.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff00b0" stroke-dasharray="5,2" d="M619.33,-62.82C611.8,-66.33 604.71,-70.87 599,-76.73 547.36,-129.7 498.18,-360.24 483.75,-432.79"/>
<polygon fill="#ff00b0" stroke="#ff00b0" points="480.3,-432.18 481.8,-442.67 487.17,-433.53 480.3,-432.18"/>
</g>
<!-- sourcefile~landuse_constant.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~landuse_constant.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00b0" stroke-dasharray="5,2" d="M616.31,-53.98C573.1,-59.44 515.62,-73.57 479.5,-109.73"/>
</g>
<!-- sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M466.35,-1566.93C433.1,-1603.3 334.42,-1711.27 293.54,-1755.99"/>
<polygon fill="#ff0075" stroke="#ff0075" points="290.78,-1753.83 286.61,-1763.57 295.94,-1758.55 290.78,-1753.83"/>
</g>
<!-- sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M466.35,-1542.53C433.1,-1506.16 334.42,-1398.19 293.54,-1353.47"/>
<polygon fill="#ff0075" stroke="#ff0075" points="295.94,-1350.91 286.61,-1345.89 290.78,-1355.63 295.94,-1350.91"/>
</g>
<!-- sourcefile~casa_phenvar.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~casa_phenvar.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff003a" stroke-dasharray="5,2" d="M634.71,-369.73C623.01,-373.71 610.32,-378.48 599,-383.73 565.41,-399.29 529.17,-421.7 505.51,-437.16"/>
<polygon fill="#ff003a" stroke="#ff003a" points="503.51,-434.28 497.09,-442.71 507.37,-440.13 503.51,-434.28"/>
</g>
<!-- sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.7,-2074.08C423.9,-2077.62 406.37,-2084.06 394,-2095.73 306.55,-2178.25 283.12,-2331.64 277.3,-2388.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.8,-2388.43 276.35,-2398.71 280.77,-2389.08 273.8,-2388.43"/>
</g>
<!-- sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.76,-2069.36C423.38,-2067.16 405.38,-2061.62 394,-2048.73 350.44,-1999.38 368.34,-1819.73 358,-1754.73 333.56,-1601.03 294.05,-1417.76 280.36,-1355.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.76,-1354.74 278.18,-1345.73 276.92,-1356.25 283.76,-1354.74"/>
</g>
<!-- sourcefile~cbl_snow_aging.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~cbl_snow_aging.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M874,-2951.73C786.34,-2956.3 763.87,-2943.27 676.5,-2951.73"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1157.17,-2918.35C1063.72,-2929.62 882.95,-2951.37 876,-2951.73"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M674.5,-1093.73C546.2,-1113.12 481.7,-1079.1 394,-1174.73 392.73,-1176.12 300.97,-1645.4 279.82,-1753.64"/>
<polygon fill="#ff9100" stroke="#ff9100" points="276.38,-1753 277.89,-1763.48 283.25,-1754.34 276.38,-1753"/>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M1004.81,-1033.32C932,-1045.81 793.68,-1070.07 676.5,-1093.73"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M674.5,-1093.73C654.57,-1096.74 551.04,-1174.13 503.46,-1210.35"/>
<polygon fill="#ff9100" stroke="#ff9100" points="501.09,-1207.76 495.26,-1216.61 505.34,-1213.32 501.09,-1207.76"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M874,-1023.73C867.29,-1023.91 399.44,-1075.8 394,-1079.73 314.77,-1136.92 286.92,-1260.68 278.6,-1311.38"/>
<polygon fill="#ff9100" stroke="#ff9100" points="275.09,-1311.15 277.03,-1321.57 282.01,-1312.22 275.09,-1311.15"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_read.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_read.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M1028.24,-1012.58C997.22,-998.75 946.43,-976.12 912.14,-960.83"/>
<polygon fill="#ff9100" stroke="#ff9100" points="913.49,-957.61 902.93,-956.73 910.64,-964 913.49,-957.61"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M874,-1023.73C825.72,-1025.05 770.83,-1022.5 731.19,-1019.93"/>
<polygon fill="#ff9100" stroke="#ff9100" points="731.41,-1016.44 721.2,-1019.27 730.94,-1023.43 731.41,-1016.44"/>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M1004.81,-1023.56C968.85,-1022.95 919.46,-1022.54 876,-1023.73"/>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2813.73C786.34,-2809.2 550.02,-2886 479.5,-2833.73"/>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1150.82,-2467.2C1083.35,-2464.13 971.66,-2461.47 876,-2470.73"/>
</g>
<!-- sourcefile~cbl_snowdensity.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~cbl_snowdensity.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node49"><a xlink:href=".././sourcefile/cbl_snowdensity.f90.html" xlink:title="cbl_snowDensity.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1112.5,-2442.73 1000.5,-2442.73 1000.5,-2418.73 1112.5,-2418.73 1112.5,-2442.73"/>
<text text-anchor="middle" x="1056.5" y="-2428.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowDensity.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowdensity.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowdensity.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1165.64,-2458.73C1149.37,-2454.52 1130.91,-2449.74 1113.91,-2445.33"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1114.65,-2441.91 1104.09,-2442.79 1112.89,-2448.69 1114.65,-2441.91"/>
</g>
<!-- sourcefile~cbl_stempv.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~cbl_stempv.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node50"><a xlink:href=".././sourcefile/cbl_stempv.f90.html" xlink:title="cbl_stempv.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="918.5,-2662.73 831.5,-2662.73 831.5,-2638.73 918.5,-2638.73 918.5,-2662.73"/>
<text text-anchor="middle" x="875" y="-2648.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_stempv.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_stempv.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_stempv.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1055.5,-2813.73C975.18,-2843.99 908.93,-2722.64 885.3,-2671.99"/>
<polygon fill="#ffda00" stroke="#ffda00" points="888.47,-2670.52 881.15,-2662.87 882.1,-2673.42 888.47,-2670.52"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1211.78,-2483.05C1210.01,-2538.22 1194.4,-2762.15 1057.5,-2813.73"/>
</g>
<!-- sourcefile~cbl_hyd_redistrib.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~cbl_hyd_redistrib.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node52"><a xlink:href=".././sourcefile/cbl_hyd_redistrib.f90.html" xlink:title="cbl_hyd_redistrib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="733,-2405.73 618,-2405.73 618,-2381.73 733,-2381.73 733,-2405.73"/>
<text text-anchor="middle" x="675.5" y="-2391.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_hyd_redistrib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_hyd_redistrib.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_hyd_redistrib.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2351.73C846.49,-2350.29 778.31,-2366.45 729.78,-2379.14"/>
<polygon fill="#ffda00" stroke="#ffda00" points="728.82,-2375.77 720.04,-2381.71 730.61,-2382.54 728.82,-2375.77"/>
</g>
<!-- sourcefile~cbl_snowaccum.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~cbl_snowaccum.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node53"><a xlink:href=".././sourcefile/cbl_snowaccum.f90.html" xlink:title="cbl_snowAccum.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="731,-2363.73 620,-2363.73 620,-2339.73 731,-2339.73 731,-2363.73"/>
<text text-anchor="middle" x="675.5" y="-2349.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowAccum.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowaccum.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowaccum.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2351.73C829.68,-2349.4 779.69,-2349.43 741.09,-2350.02"/>
<polygon fill="#ffda00" stroke="#ffda00" points="740.97,-2346.53 731.03,-2350.2 741.09,-2353.52 740.97,-2346.53"/>
</g>
<!-- sourcefile~cbl_snowl_adjust.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~cbl_snowl_adjust.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node55"><a xlink:href=".././sourcefile/cbl_snowl_adjust.f90.html" xlink:title="cbl_snowl_adjust.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1114,-2564.73 999,-2564.73 999,-2540.73 1114,-2540.73 1114,-2564.73"/>
<text text-anchor="middle" x="1056.5" y="-2550.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowl_adjust.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowl_adjust.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowl_adjust.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1195.12,-2482.9C1176.25,-2496.12 1144.47,-2517.28 1115,-2531.73 1111.4,-2533.49 1107.61,-2535.2 1103.77,-2536.81"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1102.16,-2533.69 1094.18,-2540.65 1104.76,-2540.18 1102.16,-2533.69"/>
</g>
<!-- sourcefile~cbl_surfbv.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~cbl_surfbv.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node58"><a xlink:href=".././sourcefile/cbl_surfbv.f90.html" xlink:title="cbl_surfbv.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.5,-2522.73 1015.5,-2522.73 1015.5,-2498.73 1097.5,-2498.73 1097.5,-2522.73"/>
<text text-anchor="middle" x="1056.5" y="-2508.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_surfbv.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_surfbv.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_surfbv.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1165.64,-2482.73C1147.26,-2487.49 1126.08,-2492.97 1107.37,-2497.82"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1106.35,-2494.47 1097.55,-2500.36 1108.1,-2501.24 1106.35,-2494.47"/>
</g>
<!-- sourcefile~cbl_soilfreeze.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~cbl_soilfreeze.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node61"><a xlink:href=".././sourcefile/cbl_soilfreeze.f90.html" xlink:title="cbl_soilfreeze.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.5,-2321.73 625.5,-2321.73 625.5,-2297.73 725.5,-2297.73 725.5,-2321.73"/>
<text text-anchor="middle" x="675.5" y="-2307.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilfreeze.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilfreeze.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilfreeze.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2351.73C847.36,-2350.33 782.61,-2335.75 734.46,-2324.16"/>
<polygon fill="#ffda00" stroke="#ffda00" points="735,-2320.69 724.46,-2321.74 733.36,-2327.49 735,-2320.69"/>
</g>
<!-- sourcefile~cbl_snowcheck.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~cbl_snowcheck.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node63"><a xlink:href=".././sourcefile/cbl_snowcheck.f90.html" xlink:title="cbl_snowCheck.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="730,-2279.73 621,-2279.73 621,-2255.73 730,-2255.73 730,-2279.73"/>
<text text-anchor="middle" x="675.5" y="-2265.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowCheck.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowcheck.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowcheck.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1196.41,-2458.67C1177.94,-2444.94 1145.79,-2422.74 1115,-2409.73 1014.31,-2367.19 985.16,-2357.46 876,-2351.73"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2351.73C813.66,-2342.59 808.81,-2311.02 752,-2288.73 746.65,-2286.63 741,-2284.65 735.31,-2282.81"/>
<polygon fill="#ffda00" stroke="#ffda00" points="736.31,-2279.45 725.72,-2279.84 734.24,-2286.14 736.31,-2279.45"/>
</g>
<!-- sourcefile~cbl_snowmelt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~cbl_snowmelt.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node65"><a xlink:href=".././sourcefile/cbl_snowmelt.f90.html" xlink:title="cbl_snowMelt.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725,-2805.73 626,-2805.73 626,-2781.73 725,-2781.73 725,-2805.73"/>
<text text-anchor="middle" x="675.5" y="-2791.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowMelt.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowmelt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowmelt.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2813.73C827.24,-2811.31 774.49,-2805.83 735.27,-2801.21"/>
<polygon fill="#ffda00" stroke="#ffda00" points="735.44,-2797.71 725.1,-2800 734.61,-2804.66 735.44,-2797.71"/>
</g>
<!-- sourcefile~cbl_remove_trans.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~cbl_remove_trans.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node68"><a xlink:href=".././sourcefile/cbl_remove_trans.f90.html" xlink:title="cbl_remove_trans.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="735.5,-2763.73 615.5,-2763.73 615.5,-2739.73 735.5,-2739.73 735.5,-2763.73"/>
<text text-anchor="middle" x="675.5" y="-2749.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_remove_trans.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_remove_trans.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_remove_trans.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1055.5,-2813.73C980.85,-2841.86 955.67,-2817.84 876,-2813.73"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M874,-2813.73C816.87,-2810.78 806.69,-2789.51 752,-2772.73 745.36,-2770.69 738.36,-2768.63 731.42,-2766.64"/>
<polygon fill="#ffda00" stroke="#ffda00" points="731.9,-2763.14 721.33,-2763.78 729.99,-2769.87 731.9,-2763.14"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M617.38,-2225.63C575.83,-2222.96 520,-2213.74 479.5,-2185.73"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M617.27,-2234.52C610.48,-2237.52 604.14,-2241.48 599,-2246.73 554.02,-2292.6 612.09,-2345.28 563,-2386.73 500.79,-2439.25 401.67,-2434.75 337.59,-2424.47"/>
<polygon fill="#91ff00" stroke="#91ff00" points="338.06,-2421 327.62,-2422.77 336.89,-2427.9 338.06,-2421"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M652.37,-2213.59C630.23,-2201.78 594.96,-2183.9 563,-2171.73 490.03,-2143.94 444.04,-2183.67 394,-2123.73 341.2,-2060.48 369.94,-1836.25 358,-1754.73 335.5,-1601.09 294.93,-1418.48 280.65,-1355.98"/>
<polygon fill="#91ff00" stroke="#91ff00" points="284.02,-1355.02 278.37,-1346.05 277.19,-1356.58 284.02,-1355.02"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M654.75,-2213.61C637.7,-2202.19 613.58,-2183.6 599,-2161.73 569.76,-2117.87 601.41,-2084.83 563,-2048.73 561.73,-2047.53 560.4,-2046.4 559.02,-2045.33"/>
<polygon fill="#91ff00" stroke="#91ff00" points="560.91,-2042.39 550.62,-2039.86 557.09,-2048.25 560.91,-2042.39"/>
</g>
<!-- sourcefile~cbl_hgtabove_snow.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~cbl_hgtabove_snow.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node54"><a xlink:href=".././sourcefile/cbl_hgtabove_snow.f90.html" xlink:title="cbl_hgtAbove_snow.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="543.5,-2317.73 413.5,-2317.73 413.5,-2293.73 543.5,-2293.73 543.5,-2317.73"/>
<text text-anchor="middle" x="478.5" y="-2303.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_hgtAbove_snow.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_hgtabove_snow.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_hgtabove_snow.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M617.84,-2237.82C611.26,-2240.28 604.83,-2243.22 599,-2246.73 579.07,-2258.73 583.08,-2272.98 563,-2284.73 559.78,-2286.61 556.39,-2288.33 552.9,-2289.9"/>
<polygon fill="#91ff00" stroke="#91ff00" points="551.44,-2286.71 543.47,-2293.69 554.05,-2293.21 551.44,-2286.71"/>
</g>
<!-- sourcefile~cbl_lai_eff.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~cbl_lai_eff.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node62"><a xlink:href=".././sourcefile/cbl_lai_eff.f90.html" xlink:title="cbl_lai_eff.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="519.5,-2275.73 437.5,-2275.73 437.5,-2251.73 519.5,-2251.73 519.5,-2275.73"/>
<text text-anchor="middle" x="478.5" y="-2261.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_lai_eff.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_lai_eff.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_lai_eff.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M617.31,-2236.87C589.51,-2242.29 556.4,-2248.74 529.6,-2253.97"/>
<polygon fill="#91ff00" stroke="#91ff00" points="528.81,-2250.55 519.66,-2255.9 530.15,-2257.42 528.81,-2250.55"/>
</g>
<!-- sourcefile~cbl_sinbet.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~cbl_sinbet.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1015.22,-1800.71C993.04,-1805.65 965.01,-1811.89 939.92,-1817.49"/>
<polygon fill="#00ff00" stroke="#00ff00" points="939.11,-1814.08 930.11,-1819.67 940.63,-1820.91 939.11,-1814.08"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M417.82,-2502.15C408.8,-2498.34 400.39,-2493.05 394,-2485.73 347.25,-2432.12 289.93,-1912.32 277.82,-1797.92"/>
<polygon fill="#00ff48" stroke="#00ff48" points="281.29,-1797.45 276.76,-1787.88 274.32,-1798.19 281.29,-1797.45"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M431.18,-2499.67C418.85,-2495.83 405.71,-2491.15 394,-2485.73 359.51,-2469.78 323.03,-2445.41 299.81,-2428.8"/>
<polygon fill="#00ff48" stroke="#00ff48" points="301.74,-2425.88 291.59,-2422.86 297.64,-2431.55 301.74,-2425.88"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M470.21,-2499.73C453.23,-2471.06 411.16,-2395.81 394,-2326.73 332.61,-2079.51 390.56,-2007.36 358,-1754.73 338.15,-1600.72 295.92,-1418.34 280.92,-1355.94"/>
<polygon fill="#00ff48" stroke="#00ff48" points="284.28,-1354.93 278.52,-1346.03 277.47,-1356.57 284.28,-1354.93"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M674.5,-671.73C658.37,-667.49 414.67,-812.14 394,-847.73 337.26,-945.4 372.89,-1242.76 358,-1354.73 337.53,-1508.65 295.69,-1691.09 280.86,-1753.51"/>
<polygon fill="#00ff91" stroke="#00ff91" points="277.41,-1752.88 278.49,-1763.42 284.22,-1754.51 277.41,-1752.88"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M855.09,-700.69C837.35,-689.19 810.29,-671.07 788,-653.73 754.85,-627.94 718.71,-595.26 696.83,-574.93"/>
<polygon fill="#00ff91" stroke="#00ff91" points="699.14,-572.3 689.45,-568.03 694.37,-577.41 699.14,-572.3"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M870.12,-724.73C858.31,-759.43 819.38,-860.73 752,-913.73 724.33,-935.5 702.55,-914.04 676.5,-937.73"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M674.5,-937.73C648.45,-961.42 622.2,-935.24 599,-961.73 538.63,-1030.66 610.59,-1086.43 563,-1164.73 550.96,-1184.53 530.35,-1200.43 512.61,-1211.42"/>
<polygon fill="#00ff91" stroke="#00ff91" points="510.48,-1208.62 503.66,-1216.72 514.05,-1214.64 510.48,-1208.62"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M674.5,-671.73C640.54,-662.44 622.89,-673.6 599,-647.73 551.02,-595.77 607.8,-547.46 563,-492.73 555.43,-483.49 545.13,-476.4 534.35,-470.99"/>
<polygon fill="#00ff91" stroke="#00ff91" points="535.78,-467.8 525.23,-466.84 532.88,-474.17 535.78,-467.8"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M814.34,-702.35C774.92,-695 722.27,-684.25 676.5,-671.73"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M847.46,-700.61C828.33,-690.59 803.29,-674.63 788,-653.73 755.37,-609.13 777.4,-583.8 752,-534.73 736.79,-505.34 712.31,-475.97 695.37,-457.37"/>
<polygon fill="#00ff91" stroke="#00ff91" points="697.76,-454.81 688.39,-449.86 692.63,-459.57 697.76,-454.81"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M868.11,-724.8C852.79,-756.6 811.31,-845.65 788,-923.73 764.16,-1003.58 780.09,-1029.28 752,-1107.73 735.93,-1152.61 707.19,-1200.63 690.19,-1227.14"/>
<polygon fill="#00ff91" stroke="#00ff91" points="687.22,-1225.29 684.7,-1235.58 693.09,-1229.11 687.22,-1225.29"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M674.5,-671.73C551.35,-638.03 483.26,-642.44 394,-733.73 311,-818.63 282.58,-1213.11 276.72,-1311.47"/>
<polygon fill="#00ff91" stroke="#00ff91" points="273.21,-1311.54 276.13,-1321.72 280.2,-1311.94 273.21,-1311.54"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M845.32,-700.59C825.93,-690.84 801.47,-675.2 788,-653.73 731.4,-563.47 805.78,-508.7 752,-416.73 741.89,-399.44 724.6,-385.37 709.11,-375.31"/>
<polygon fill="#00ff91" stroke="#00ff91" points="710.61,-372.12 700.27,-369.85 706.94,-378.08 710.61,-372.12"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M869.77,-724.88C856.54,-761.74 813.17,-874.49 752,-951.73 737.96,-969.46 718.4,-985.88 702.7,-997.64"/>
<polygon fill="#00ff91" stroke="#00ff91" points="700.45,-994.95 694.44,-1003.68 704.58,-1000.61 700.45,-994.95"/>
</g>
<!-- sourcefile~cable_pft_params.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~cable_pft_params.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node51"><a xlink:href=".././sourcefile/cable_pft_params.f90.html" xlink:title="cable_pft_params.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="538.5,-525.73 418.5,-525.73 418.5,-501.73 538.5,-501.73 538.5,-525.73"/>
<text text-anchor="middle" x="478.5" y="-511.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_pft_params.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_pft_params.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_pft_params.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M674.5,-671.73C640.54,-662.44 625.57,-670.83 599,-647.73 571.09,-623.47 586.86,-600.97 563,-572.73 548.79,-555.91 528.75,-541.54 511.86,-531.19"/>
<polygon fill="#00ff91" stroke="#00ff91" points="513.25,-527.95 502.86,-525.87 509.69,-533.97 513.25,-527.95"/>
</g>
<!-- sourcefile~cable_soil_params.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~cable_soil_params.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node66"><a xlink:href=".././sourcefile/cable_soil_params.f90.html" xlink:title="cable_soil_params.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="540.5,-605.73 416.5,-605.73 416.5,-581.73 540.5,-581.73 540.5,-605.73"/>
<text text-anchor="middle" x="478.5" y="-591.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_soil_params.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_soil_params.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_soil_params.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M674.5,-671.73C640.54,-662.44 631.88,-660.33 599,-647.73 569.48,-636.41 536.82,-621.48 513.12,-610.19"/>
<polygon fill="#00ff91" stroke="#00ff91" points="514.39,-606.92 503.86,-605.75 511.36,-613.23 514.39,-606.92"/>
</g>
<!-- sourcefile~cbl_rhoch.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~cbl_rhoch.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node59"><a xlink:href=".././sourcefile/cbl_rhoch.f90.html" xlink:title="cbl_rhoch.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097,-2121.73 1016,-2121.73 1016,-2097.73 1097,-2097.73 1097,-2121.73"/>
<text text-anchor="middle" x="1056.5" y="-2107.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_rhoch.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_rhoch.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_rhoch.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M1155.35,-2109.73C1139.67,-2109.73 1122.78,-2109.73 1107.51,-2109.73"/>
<polygon fill="#00daff" stroke="#00daff" points="1107.24,-2106.23 1097.24,-2109.73 1107.24,-2113.23 1107.24,-2106.23"/>
</g>
<!-- sourcefile~cbl_spitter.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~cbl_spitter.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node64"><a xlink:href=".././sourcefile/cbl_spitter.f90.html" xlink:title="cbl_spitter.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.5,-2079.73 1015.5,-2079.73 1015.5,-2055.73 1097.5,-2055.73 1097.5,-2079.73"/>
<text text-anchor="middle" x="1056.5" y="-2065.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_spitter.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_spitter.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_spitter.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M1167.73,-2097.69C1148.9,-2092.57 1126.85,-2086.58 1107.44,-2081.3"/>
<polygon fill="#00daff" stroke="#00daff" points="1108.13,-2077.86 1097.56,-2078.62 1106.29,-2084.62 1108.13,-2077.86"/>
</g>
<!-- sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M830.77,-936.48C779.51,-927.81 698.27,-917.94 676.5,-937.73"/>
</g>
<!-- sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M859.57,-932.59C806.3,-889.32 616.69,-749.1 479.5,-823.73"/>
</g>
<!-- sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M830.56,-956.1C816.76,-960.18 801.56,-965.16 788,-970.73 771.26,-977.6 768.6,-982.54 752,-989.73 743.4,-993.45 734.09,-997.02 725.03,-1000.26"/>
<polygon fill="#0091ff" stroke="#0091ff" points="723.64,-997.03 715.35,-1003.63 725.94,-1003.64 723.64,-997.03"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M865.6,-298.96C846.07,-327.32 795.9,-399.67 752,-458.73 731.93,-485.73 707.94,-516.27 692.48,-535.74"/>
<polygon fill="#0048ff" stroke="#0048ff" points="689.7,-533.61 686.21,-543.61 695.18,-537.97 689.7,-533.61"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M854.32,-274.58C811.34,-248.73 710.25,-191.8 676.5,-206.73"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M834.98,-291.89C819.06,-295.58 801.31,-301.91 788,-312.73 762.07,-333.8 773.61,-353.25 752,-378.73 738.51,-394.64 720.12,-409.12 704.87,-419.75"/>
<polygon fill="#0048ff" stroke="#0048ff" points="702.63,-417.04 696.31,-425.55 706.55,-422.84 702.63,-417.04"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M854.19,-274.51C836.31,-263.16 809.57,-245.4 788,-227.73 770.74,-213.59 771.15,-204.19 752,-192.73 721.79,-174.64 709.79,-180.2 676.5,-168.73"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M834.8,-297.77C820.04,-302.14 803.15,-307.39 788,-312.73 763.07,-321.51 735.53,-332.61 714.05,-341.59"/>
<polygon fill="#0048ff" stroke="#0048ff" points="712.5,-338.45 704.65,-345.55 715.22,-344.9 712.5,-338.45"/>
</g>
<!-- sourcefile~cbl_snow_albedo.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~cbl_snow_albedo.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node60"><a xlink:href=".././sourcefile/cbl_snow_albedo.f90.html" xlink:title="cbl_snow_albedo.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1115,-2037.73 998,-2037.73 998,-2013.73 1115,-2013.73 1115,-2037.73"/>
<text text-anchor="middle" x="1056.5" y="-2023.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snow_albedo.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_albedo.f90&#45;&gt;sourcefile~cbl_snow_albedo.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~cbl_albedo.f90&#45;&gt;sourcefile~cbl_snow_albedo.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1169.78,-2040.99C1155.93,-2039.11 1140.17,-2036.97 1124.93,-2034.89"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1125.4,-2031.43 1115.02,-2033.55 1124.45,-2038.36 1125.4,-2031.43"/>
</g>
<!-- sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~grid_constants_cbl.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node56"><a xlink:href=".././sourcefile/grid_constants_cbl.f90.html" xlink:title="grid_constants_cbl.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="336.5,-605.73 212.5,-605.73 212.5,-581.73 336.5,-581.73 336.5,-605.73"/>
<text text-anchor="middle" x="274.5" y="-591.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_constants_cbl.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_other_constants_mod.f90&#45;&gt;sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~cable_other_constants_mod.f90&#45;&gt;sourcefile~grid_constants_cbl.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M464.72,-2015.51C445.35,-1996.07 409.23,-1955.96 394,-1913.73 348.62,-1787.86 369.63,-1446.02 358,-1312.73 333.96,-1037.25 290.28,-704.02 278.5,-615.94"/>
<polygon fill="#4800ff" stroke="#4800ff" points="281.96,-615.46 277.16,-606.01 275.02,-616.39 281.96,-615.46"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M674.5,-595.73C674.5,-595.73 394,-726.73 394,-726.73 354.79,-784.59 366.74,-1285.39 358,-1354.73 338.58,-1508.79 296.08,-1691.14 280.96,-1753.52"/>
<polygon fill="#da00ff" stroke="#da00ff" points="277.52,-1752.89 278.55,-1763.43 284.32,-1754.54 277.52,-1752.89"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M824.33,-620.6C812.16,-616.85 799.37,-612.23 788,-606.73 770.46,-598.25 769.37,-590.54 752,-581.73 744.36,-577.85 736,-574.33 727.73,-571.22"/>
<polygon fill="#da00ff" stroke="#da00ff" points="728.69,-567.85 718.1,-567.76 726.32,-574.44 728.69,-567.85"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M852.1,-644.83C797.72,-676.23 656.75,-766.29 599,-885.73 544.58,-998.29 625.4,-1056.39 563,-1164.73 551.51,-1184.68 531.1,-1200.49 513.33,-1211.42"/>
<polygon fill="#da00ff" stroke="#da00ff" points="511.2,-1208.6 504.34,-1216.68 514.74,-1214.65 511.2,-1208.6"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M817.99,-621.14C778.55,-613.25 724.45,-602.97 676.5,-595.73"/>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M674.5,-595.73C640.29,-590.57 625.33,-599.18 599,-576.73 568.1,-550.37 591.4,-521.77 563,-492.73 554.04,-483.57 542.46,-476.41 530.79,-470.9"/>
<polygon fill="#da00ff" stroke="#da00ff" points="532.03,-467.62 521.46,-466.83 529.23,-474.04 532.03,-467.62"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M817.89,-622.96C807.15,-619.19 796.59,-613.97 788,-606.73 760.64,-583.67 771.08,-564.99 752,-534.73 734.25,-506.58 710.12,-476.74 693.96,-457.71"/>
<polygon fill="#da00ff" stroke="#da00ff" points="696.52,-455.32 687.35,-450.01 691.21,-459.88 696.52,-455.32"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M674.5,-595.73C612.66,-586.4 441.5,-532.05 394,-572.73 278.39,-671.73 274.69,-1196.52 275.28,-1311.47"/>
<polygon fill="#da00ff" stroke="#da00ff" points="271.79,-1311.58 275.35,-1321.56 278.79,-1311.53 271.79,-1311.58"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M847.41,-644.81C828.25,-654.81 803.19,-670.76 788,-691.73 754.58,-737.85 781.53,-766.02 752,-814.73 703.11,-895.36 639.1,-876.38 599,-961.73 505.77,-1160.17 644.72,-1250.28 563,-1453.73 549.75,-1486.72 521.57,-1517.06 501.61,-1535.7"/>
<polygon fill="#da00ff" stroke="#da00ff" points="499.2,-1533.17 494.16,-1542.49 503.91,-1538.35 499.2,-1533.17"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M817.99,-625.32C806.72,-621.42 795.93,-615.55 788,-606.73 730.54,-542.81 796.73,-490.12 752,-416.73 741.51,-399.51 724.02,-385.37 708.52,-375.25"/>
<polygon fill="#da00ff" stroke="#da00ff" points="710.03,-372.07 699.69,-369.77 706.34,-378.02 710.03,-372.07"/>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M822.33,-1997.72C782.18,-2005.98 725.3,-2018.75 676.5,-2033.73"/>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M859.65,-1975.55C839.95,-1957.92 805.02,-1923.28 788,-1885.73 744.01,-1788.69 805.88,-1740.64 752,-1648.73 708.43,-1574.41 649.16,-1599.77 599,-1529.73 570.52,-1489.96 580.55,-1471.38 563,-1425.73 538.25,-1361.35 505.48,-1286.73 489.34,-1250.59"/>
<polygon fill="#ff00da" stroke="#ff00da" points="492.35,-1248.75 485.07,-1241.06 485.96,-1251.61 492.35,-1248.75"/>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M822.32,-1988.46C766.87,-1988.59 676.33,-1986.93 599,-1976.73 572.01,-1973.17 500.48,-1967.08 479.5,-1949.73"/>
</g>
<!-- sourcefile~cable_sli_solve.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~cable_sli_solve.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node57"><a xlink:href=".././sourcefile/cable_sli_solve.f90.html" xlink:title="cable_sli_solve.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728.5,-1887.73 622.5,-1887.73 622.5,-1863.73 728.5,-1863.73 728.5,-1887.73"/>
<text text-anchor="middle" x="675.5" y="-1873.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_solve.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_solve.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_solve.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M822.35,-1978.78C810.23,-1974.95 797.97,-1969.5 788,-1961.73 763.47,-1942.61 776.16,-1921.31 752,-1901.73 747.38,-1897.98 742.18,-1894.76 736.74,-1892"/>
<polygon fill="#ff00da" stroke="#ff00da" points="737.95,-1888.7 727.39,-1887.76 735.05,-1895.08 737.95,-1888.7"/>
</g>
<!-- sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~cable_sli_numbers.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node67"><a xlink:href=".././sourcefile/cable_sli_numbers.f90.html" xlink:title="cable_sli_numbers.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="540.5,-1904.73 416.5,-1904.73 416.5,-1880.73 540.5,-1880.73 540.5,-1904.73"/>
<text text-anchor="middle" x="478.5" y="-1890.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_numbers.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_numbers.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M823.28,-1975.61C811.39,-1971.9 798.99,-1967.29 788,-1961.73 770.16,-1952.7 770.44,-1942.48 752,-1934.73 687.31,-1907.51 607.33,-1897.7 550.8,-1894.27"/>
<polygon fill="#ff00da" stroke="#ff00da" points="550.7,-1890.76 540.52,-1893.71 550.31,-1897.75 550.7,-1890.76"/>
</g>
<!-- sourcefile~cable_sli_roots.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~cable_sli_roots.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node69"><a xlink:href=".././sourcefile/cable_sli_roots.f90.html" xlink:title="cable_sli_roots.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728.5,-1967.73 622.5,-1967.73 622.5,-1943.73 728.5,-1943.73 728.5,-1967.73"/>
<text text-anchor="middle" x="675.5" y="-1953.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_roots.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_roots.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_roots.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M822.37,-1979.36C796.73,-1975.21 765.55,-1970.16 738.61,-1965.79"/>
<polygon fill="#ff00da" stroke="#ff00da" points="738.95,-1962.3 728.52,-1964.16 737.83,-1969.21 738.95,-1962.3"/>
</g>
<!-- sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M655.89,-1027.74C639.13,-1039.34 614.78,-1058.27 599,-1079.73 574.69,-1112.78 588.11,-1132.29 563,-1164.73 548.43,-1183.55 527.07,-1199.79 509.59,-1211.2"/>
<polygon fill="#ff0091" stroke="#ff0091" points="507.45,-1208.41 500.87,-1216.72 511.19,-1214.33 507.45,-1208.41"/>
</g>
<!-- sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M669.87,-1003.47C650.4,-953.91 571.94,-773.44 479.5,-823.73"/>
</g>
<!-- sourcefile~cbl_snowdensity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~cbl_snowdensity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-2470.73C784.94,-2479.35 765.97,-2508.68 676.5,-2509.73"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M674.5,-2509.73C633.03,-2510.22 586.61,-2510.7 549.46,-2511.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="549.21,-2507.56 539.24,-2511.16 549.28,-2514.56 549.21,-2507.56"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1014.97,-2442.76C978.88,-2452.74 924.46,-2466.04 876,-2470.73"/>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M841.63,-2662.75C817.19,-2671.61 782.72,-2683.65 752,-2692.73 684.81,-2712.6 661.23,-2698.54 599,-2730.73 536.72,-2762.95 535.83,-2875.48 479.5,-2833.73"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M477.5,-2833.73C389.93,-2768.81 294.3,-1944.4 277.94,-1797.91"/>
<polygon fill="#ff4800" stroke="#ff4800" points="281.41,-1797.42 276.83,-1787.87 274.45,-1798.19 281.41,-1797.42"/>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M841.63,-2638.71C817.19,-2629.85 782.72,-2617.81 752,-2608.73 684.81,-2588.86 664.79,-2594.82 599,-2570.73 567.35,-2559.14 533.03,-2541.64 509.32,-2528.7"/>
<polygon fill="#ff4800" stroke="#ff4800" points="510.92,-2525.59 500.48,-2523.82 507.54,-2531.72 510.92,-2525.59"/>
</g>
<!-- sourcefile~cbl_trimb.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~cbl_trimb.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node70"><a xlink:href=".././sourcefile/cbl_trimb.f90.html" xlink:title="cbl_trimb.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="714.5,-2561.73 636.5,-2561.73 636.5,-2537.73 714.5,-2537.73 714.5,-2561.73"/>
<text text-anchor="middle" x="675.5" y="-2547.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_trimb.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_trimb.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_trimb.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M856.9,-2638.54C833.9,-2622.54 791.34,-2594.32 752,-2575.73 743.26,-2571.6 733.67,-2567.79 724.35,-2564.43"/>
<polygon fill="#ff4800" stroke="#ff4800" points="725.38,-2561.08 714.78,-2561.1 723.08,-2567.69 725.38,-2561.08"/>
</g>
<!-- sourcefile~cbl_conductivity.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node72" class="node">
<title>sourcefile~cbl_conductivity.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node72"><a xlink:href=".././sourcefile/cbl_conductivity.f90.html" xlink:title="cbl_conductivity.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="729.5,-2683.73 621.5,-2683.73 621.5,-2659.73 729.5,-2659.73 729.5,-2683.73"/>
<text text-anchor="middle" x="675.5" y="-2669.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_conductivity.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_conductivity.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_conductivity.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M831.15,-2655.29C804.56,-2658.11 769.91,-2661.8 740.15,-2664.96"/>
<polygon fill="#ff4800" stroke="#ff4800" points="739.42,-2661.52 729.84,-2666.06 740.16,-2668.48 739.42,-2661.52"/>
</g>
<!-- sourcefile~cbl_oldconductivity.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node73" class="node">
<title>sourcefile~cbl_oldconductivity.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node73"><a xlink:href=".././sourcefile/cbl_oldconductivity.f90.html" xlink:title="cbl_Oldconductivity.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="737.5,-2641.73 613.5,-2641.73 613.5,-2617.73 737.5,-2617.73 737.5,-2641.73"/>
<text text-anchor="middle" x="675.5" y="-2627.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_Oldconductivity.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_oldconductivity.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_oldconductivity.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M831.15,-2646.17C806.79,-2643.58 775.68,-2640.28 747.76,-2637.31"/>
<polygon fill="#ff4800" stroke="#ff4800" points="747.95,-2633.81 737.63,-2636.23 747.21,-2640.77 747.95,-2633.81"/>
</g>
<!-- sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M418.14,-523.04C408.97,-526.87 400.42,-532.24 394,-539.73 342,-600.41 288.07,-1189.6 277.4,-1311.66"/>
<polygon fill="#ff9100" stroke="#ff9100" points="273.9,-1311.43 276.52,-1321.7 280.88,-1312.04 273.9,-1311.43"/>
</g>
<!-- sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M435.1,-525.8C421.82,-529.88 407.19,-534.69 394,-539.73 364.67,-550.93 332.29,-565.87 308.8,-577.19"/>
<polygon fill="#ff9100" stroke="#ff9100" points="307.09,-574.13 299.63,-581.65 310.15,-580.43 307.09,-574.13"/>
</g>
<!-- sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M617.64,-2400.37C576.22,-2402.33 520.44,-2398.78 479.5,-2372.73"/>
</g>
<!-- sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M654.37,-2405.91C619.61,-2426.95 548.25,-2470.13 508.26,-2494.32"/>
<polygon fill="#ffda00" stroke="#ffda00" points="506.27,-2491.44 499.52,-2499.61 509.89,-2497.43 506.27,-2491.44"/>
</g>
<!-- sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M625.72,-2363.83C576.01,-2374.96 502.99,-2387.67 479.5,-2372.73"/>
</g>
<!-- sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M619.63,-2362.07C612.31,-2364.82 605.21,-2368.31 599,-2372.73 576.09,-2389.02 580.79,-2402.96 563,-2424.73 542.89,-2449.33 517.28,-2475.34 499.76,-2492.44"/>
<polygon fill="#daff00" stroke="#daff00" points="497.08,-2490.16 492.32,-2499.63 501.95,-2495.19 497.08,-2490.16"/>
</g>
<!-- sourcefile~cbl_snowl_adjust.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~cbl_snowl_adjust.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M998.93,-2550.2C944.65,-2547.33 860.46,-2541.69 788,-2531.73 737.96,-2524.85 727.01,-2509.6 676.5,-2509.73"/>
</g>
<!-- sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M650.02,-1863.6C632.62,-1853.57 610.4,-1837.61 599,-1816.73 557.19,-1740.14 584.28,-1510.35 563,-1425.73 546.19,-1358.88 509.88,-1285.44 491.17,-1250.09"/>
<polygon fill="#00ff48" stroke="#00ff48" points="494.2,-1248.32 486.39,-1241.16 488.03,-1251.63 494.2,-1248.32"/>
</g>
<!-- sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M622.38,-1876.79C580.01,-1875.09 520.71,-1866.6 479.5,-1835.73"/>
</g>
<!-- sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_sli_numbers.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M622.5,-1880.26C600.48,-1882.18 574.48,-1884.45 550.73,-1886.52"/>
<polygon fill="#00ff48" stroke="#00ff48" points="550.36,-1883.04 540.7,-1887.39 550.97,-1890.01 550.36,-1883.04"/>
</g>
<!-- sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1039.26,-2498.56C1021.35,-2485.83 991.19,-2466.38 962,-2456.73 807.81,-2405.72 749.33,-2476.19 599,-2414.73 580.24,-2407.06 581.56,-2394.88 563,-2386.73 528.54,-2371.61 511.25,-2392.93 479.5,-2372.73"/>
</g>
<!-- sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1027.25,-2498.69C992.18,-2485.08 930.34,-2465.47 876,-2470.73"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~cbl_smoisturev.f90</title>
<g id="a_sourcefile~~cable_driver.f90~~EfferentGraph_node71"><a xlink:href=".././sourcefile/cbl_smoisturev.f90.html" xlink:title="cbl_smoisturev.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="927,-2522.73 823,-2522.73 823,-2498.73 927,-2498.73 927,-2522.73"/>
<text text-anchor="middle" x="875" y="-2508.33" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_smoisturev.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_smoisturev.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_smoisturev.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1015.22,-2510.73C992.22,-2510.73 962.93,-2510.73 937.15,-2510.73"/>
<polygon fill="#00ff91" stroke="#00ff91" points="937.09,-2507.23 927.09,-2510.73 937.09,-2514.23 937.09,-2507.23"/>
</g>
<!-- sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M629.24,-2321.79C619.24,-2324.6 608.73,-2327.67 599,-2330.73 545.3,-2347.61 527,-2402.95 479.5,-2372.73"/>
</g>
<!-- sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M625.18,-2316.33C615.64,-2319.47 606.35,-2324.05 599,-2330.73 565.91,-2360.83 586.96,-2386.95 563,-2424.73 546.2,-2451.22 520.46,-2476.5 502,-2492.92"/>
<polygon fill="#0091ff" stroke="#0091ff" points="499.58,-2490.39 494.34,-2499.6 504.18,-2495.66 499.58,-2490.39"/>
</g>
<!-- sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M620.61,-2278.82C613.07,-2281.47 605.64,-2284.73 599,-2288.73 579.07,-2300.73 581.41,-2312.5 563,-2326.73 529.48,-2352.64 515.25,-2395.47 479.5,-2372.73"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M477.5,-2372.73C441.75,-2349.98 419.29,-2360.73 394,-2326.73 329.25,-2239.68 287.76,-1890.01 277.82,-1798"/>
<polygon fill="#0000ff" stroke="#0000ff" points="281.28,-1797.45 276.74,-1787.87 274.32,-1798.19 281.28,-1797.45"/>
</g>
<!-- sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M620.74,-2275.14C612.65,-2278.26 605.02,-2282.63 599,-2288.73 555.06,-2333.22 593.62,-2370.22 563,-2424.73 547.73,-2451.92 521.96,-2476.92 503.08,-2493.08"/>
<polygon fill="#0000ff" stroke="#0000ff" points="500.64,-2490.55 495.2,-2499.65 505.12,-2495.93 500.64,-2490.55"/>
</g>
<!-- sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#9100ff" stroke-dasharray="5,2" d="M632.39,-2805.79C578.81,-2820.61 491.68,-2842.76 479.5,-2833.73"/>
</g>
<!-- sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#9100ff" stroke-dasharray="5,2" d="M625.89,-2786.89C616.2,-2783.78 606.66,-2779.26 599,-2772.73 522.87,-2707.77 492.64,-2584.12 483.15,-2533.83"/>
<polygon fill="#9100ff" stroke="#9100ff" points="486.55,-2532.96 481.34,-2523.74 479.66,-2534.2 486.55,-2532.96"/>
</g>
<!-- sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M416.13,-604.04C407.75,-607.78 399.98,-612.86 394,-619.73 300.63,-726.9 279.74,-1202.3 276.15,-1311.38"/>
<polygon fill="#da00ff" stroke="#da00ff" points="272.64,-1311.44 275.83,-1321.55 279.64,-1311.66 272.64,-1311.44"/>
</g>
<!-- sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M416.35,-593.73C394.49,-593.73 369.68,-593.73 347.03,-593.73"/>
<polygon fill="#da00ff" stroke="#da00ff" points="346.8,-590.23 336.8,-593.73 346.8,-597.23 346.8,-590.23"/>
</g>
<!-- sourcefile~cable_sli_numbers.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~cable_sli_numbers.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M438.17,-1880.73C422.28,-1874 405.1,-1864.02 394,-1849.73 362.64,-1809.36 296.3,-1449.51 279.45,-1355.91"/>
<polygon fill="#ff00da" stroke="#ff00da" points="282.86,-1355.07 277.65,-1345.85 275.97,-1356.31 282.86,-1355.07"/>
</g>
<!-- sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M625.7,-2763.75C616.71,-2766.4 607.49,-2769.42 599,-2772.73 543.44,-2794.38 527.4,-2869.24 479.5,-2833.73"/>
</g>
<!-- sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M655.74,-2739.63C639.55,-2728.62 616.15,-2711.31 599,-2692.73 551.37,-2641.14 509.73,-2568.67 490.62,-2533.12"/>
<polygon fill="#ff0091" stroke="#ff0091" points="493.62,-2531.31 485.84,-2524.11 487.44,-2534.59 493.62,-2531.31"/>
</g>
<!-- sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M622.08,-1961.08C571.77,-1965.01 500.44,-1967.05 479.5,-1949.73"/>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M477.5,-1949.73C446.36,-1923.97 419.49,-1945.09 394,-1913.73 384.86,-1902.49 299.85,-1460.9 279.75,-1355.94"/>
<polygon fill="#ff0048" stroke="#ff0048" points="283.13,-1355.01 277.82,-1345.85 276.26,-1356.33 283.13,-1355.01"/>
</g>
<!-- sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_sli_numbers.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M636.9,-1943.58C605.37,-1933.4 560.2,-1918.8 526.33,-1907.86"/>
<polygon fill="#ff0048" stroke="#ff0048" points="527.24,-1904.48 516.65,-1904.73 525.09,-1911.14 527.24,-1904.48"/>
</g>
<!-- sourcefile~cbl_trimb.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~cbl_trimb.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M636.44,-2542.31C611.75,-2537.5 578.84,-2531.09 549.54,-2525.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="549.83,-2521.87 539.34,-2523.39 548.49,-2528.74 549.83,-2521.87"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M822.61,-2504.57C710.96,-2490.11 451.67,-2450.33 394,-2386.73 312.75,-2297.13 282.98,-1896.98 276.79,-1797.95"/>
<polygon fill="#7fff00" stroke="#7fff00" points="280.28,-1797.65 276.18,-1787.88 273.29,-1798.07 280.28,-1797.65"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M822.85,-2510.26C782.98,-2509.94 726.22,-2509.6 676.5,-2509.73"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_trimb.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_trimb.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M822.88,-2520.82C792.62,-2526.8 754.51,-2534.33 724.76,-2540.2"/>
<polygon fill="#7fff00" stroke="#7fff00" points="723.75,-2536.83 714.61,-2542.2 725.1,-2543.7 723.75,-2536.83"/>
</g>
<!-- sourcefile~cbl_conductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~cbl_conductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M621.22,-2661.21C613.44,-2658.47 605.78,-2655.03 599,-2650.73 550.31,-2619.8 510.67,-2562.99 491.66,-2532.45"/>
<polygon fill="#00ffff" stroke="#00ffff" points="494.63,-2530.59 486.44,-2523.87 488.65,-2534.24 494.63,-2530.59"/>
</g>
<!-- sourcefile~cbl_oldconductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_driver.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~cbl_oldconductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M631.54,-2617.63C620.63,-2613.83 609.13,-2609.18 599,-2603.73 561.02,-2583.28 522.42,-2551.04 499.74,-2530.66"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="501.89,-2527.88 492.14,-2523.74 497.17,-2533.06 501.89,-2527.88"/>
</g>
</g>
</svg>
</div><script>var pansourcefilecable_driverf90EfferentGraph = svgPanZoom('#sourcefilecable_driverf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 6.0.2 (20221011.1828)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-1">Programs</a></h3></div>
  <div id="progs-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../program/cable_offline_driver.html">cable_offline_driver</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      <a class="list-group-item" href="../proc/preparefiles.html">prepareFiles</a>
      <a class="list-group-item" href="../proc/renamefiles.html">renameFiles</a>
      <a class="list-group-item" href="../proc/lucdriver.html">LUCdriver</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/cable_driver.f90.html#src">cable_driver.F90</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!==============================================================================</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">! This source code is part of the</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="c">! Australian Community Atmosphere Biosphere Land Exchange (CABLE) model.</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">! This work is licensed under the CSIRO Open Source Software License</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="c">! Agreement (variation of the BSD / MIT License).</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="c">!</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">! You may not use this file except in compliance with this License.</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">! A copy of the License (CSIRO_BSD_MIT_License_v2.0_CABLE.txt) is located</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">! in each directory containing CABLE code.</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="c">!</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="c">! ==============================================================================</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="c">! Purpose: Offline driver for CABLE</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">! Contact: Bernard.Pak@csiro.au</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="c">!</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="c">! History: Since 1.4b, capability to run global offline (ncciy = YEAR),</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="c">!	   inclusion of call to CASA-CNP (icycle&gt;0)</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">!	   exclusion of call to cbm (icycle&gt;10)</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="c">!	   soil_snow_type now ssnow (instead of ssoil)</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="c">!</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="c">!</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="c">! ========================================untitled======================================</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="c">! Uses:		  cable_def_types_mod</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="c">!		  cable_IO_vars_module</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="c">!		  cable_common_module</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="c">!		  cable_input_module</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="c">!		  cable_output_module</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="c">!		  cable_cbm_module</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="c">!		  casadimension</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="c">!		  casavariable</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="c">!</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="c">! CALLs:       open_met_file</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="c">!	       load_parameters</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="c">!	       open_output_file</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="c">!	       get_met_data</span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="c">!	       casa_feedback</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="c">!	       cbm</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="c">!	       bgcdriver</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="c">!	       sumcflux</span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="c">!	       write_output</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="c">!	       casa_poolout</span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="c">!	       casa_fluxout</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="c">!	       create_restart</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="c">!	       close_met_file</span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="c">!	       close_output_file</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="c">!	       prepareFiles</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="c">!</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="c">!</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="c">! input	 file: [SiteName].nc</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="c">!	       poolcnpIn[SiteName].csv -- for CASA-CNP only</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="c">!	       gridinfo_CSIRO_1x1.nc</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="c">!	       def_veg_params.txt</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="c">!	       def_soil_params.txt -- nearly redundant, can be switched on</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="c">!	       restart_in.nc -- not strictly required</span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="c">!</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="c">! output file: log_cable.txt</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="c">!	       out_cable.nc</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="c">!	       restart_out.nc</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="c">!	       poolcnpOut.csv -- from CASA-CNP</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="c">!==============================================================================</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="k">PROGRAM </span><span class="n">cable_offline_driver</span><span class="w"></span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="n">leaps</span><span class="p">,</span><span class="w">		      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="w">       </span><span class="n">verbose</span><span class="p">,</span><span class="w"> </span><span class="n">fixedCO2</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">check</span><span class="p">,</span><span class="n">patchout</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">       </span><span class="n">patch_type</span><span class="p">,</span><span class="n">landpt</span><span class="p">,</span><span class="n">soilparmnew</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="w">       </span><span class="n">defaultLAI</span><span class="p">,</span><span class="w"> </span><span class="n">sdoy</span><span class="p">,</span><span class="w"> </span><span class="n">smoy</span><span class="p">,</span><span class="w"> </span><span class="n">syear</span><span class="p">,</span><span class="w"> </span><span class="n">timeunits</span><span class="p">,</span><span class="w"> </span><span class="n">exists</span><span class="p">,</span><span class="w"> </span><span class="n">calendar</span><span class="w"></span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_ncdf_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">is_casa_time</span><span class="w"></span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">kend_gl</span><span class="p">,</span><span class="w"> </span><span class="n">knode_gl</span><span class="p">,</span><span class="w"> </span><span class="n">cable_user</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">       </span><span class="n">cable_runtime</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">myhome</span><span class="p">,</span><span class="w">		   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">       </span><span class="n">redistrb</span><span class="p">,</span><span class="w"> </span><span class="n">wiltParam</span><span class="p">,</span><span class="w"> </span><span class="n">satuParam</span><span class="p">,</span><span class="w"> </span><span class="n">CurYear</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">       </span><span class="n">IS_LEAPYEAR</span><span class="p">,</span><span class="w"> </span><span class="n">calcsoilalbedo</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">       </span><span class="n">kwidth_gl</span><span class="p">,</span><span class="w"> </span><span class="n">gw_params</span><span class="w"></span>
<a id="ln-73" name="ln-73" href="#ln-73"></a>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_namelist_util</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">get_namelist_file_name</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">       </span><span class="n">CABLE_NAMELIST</span><span class="p">,</span><span class="n">arg_not_namelist</span><span class="w"></span>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="c">! physical constants</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="k">USE </span><span class="n">cable_phys_constants_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CTFRZ</span><span class="w">   </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">TFRZ</span><span class="w"></span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="k">USE </span><span class="n">cable_phys_constants_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CEMLEAF</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">EMLEAF</span><span class="w"></span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="k">USE </span><span class="n">cable_phys_constants_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CEMSOIL</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">EMSOIL</span><span class="w"></span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="k">USE </span><span class="n">cable_phys_constants_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CSBOLTZ</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SBOLTZ</span><span class="w"></span>
<a id="ln-81" name="ln-81" href="#ln-81"></a>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_input_module</span><span class="p">,</span><span class="w">   </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">open_met_file</span><span class="p">,</span><span class="n">load_parameters</span><span class="p">,</span><span class="w">	      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">       </span><span class="n">get_met_data</span><span class="p">,</span><span class="n">close_met_file</span><span class="p">,</span><span class="w">		   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">       </span><span class="n">ncid_rain</span><span class="p">,</span><span class="w">	</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">       </span><span class="n">ncid_snow</span><span class="p">,</span><span class="w">	</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">       </span><span class="n">ncid_lw</span><span class="p">,</span><span class="w">		</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">       </span><span class="n">ncid_sw</span><span class="p">,</span><span class="w">		</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">       </span><span class="n">ncid_ps</span><span class="p">,</span><span class="w">		</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">       </span><span class="n">ncid_qa</span><span class="p">,</span><span class="w">		</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">       </span><span class="n">ncid_ta</span><span class="p">,</span><span class="w">		</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">       </span><span class="n">ncid_wd</span><span class="p">,</span><span class="n">ncid_mask</span><span class="w"></span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_output_module</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">create_restart</span><span class="p">,</span><span class="n">open_output_file</span><span class="p">,</span><span class="w">	      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">       </span><span class="n">write_output</span><span class="p">,</span><span class="n">close_output_file</span><span class="w"></span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_write_module</span><span class="p">,</span><span class="w">   </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">nullify_write</span><span class="w"></span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">timeunits</span><span class="p">,</span><span class="n">calendar</span><span class="w"></span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">   </span><span class="k">USE </span><span class="n">cable_cbm_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">cbm</span><span class="w"></span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">  </span><span class="c">!mpidiff</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_climate_mod</span><span class="w"></span>
<a id="ln-99" name="ln-99" href="#ln-99"></a><span class="w">    </span>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">  </span><span class="c">! modules related to CASA-CNP</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="w">  </span><span class="k">USE </span><span class="n">casadimension</span><span class="p">,</span><span class="w">	    </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">icycle</span><span class="w"></span>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="w">  </span><span class="k">USE </span><span class="n">casavariable</span><span class="p">,</span><span class="w">	    </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">casafile</span><span class="p">,</span><span class="w"> </span><span class="n">casa_biome</span><span class="p">,</span><span class="w"> </span><span class="n">casa_pool</span><span class="p">,</span><span class="w"> </span><span class="n">casa_flux</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">                                </span><span class="c">!mpidiff</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">       </span><span class="n">casa_met</span><span class="p">,</span><span class="w"> </span><span class="n">casa_balance</span><span class="p">,</span><span class="w"> </span><span class="n">zero_sum_casa</span><span class="p">,</span><span class="w"> </span><span class="n">update_sum_casa</span><span class="w"></span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="w">  </span><span class="k">USE </span><span class="n">phenvariable</span><span class="p">,</span><span class="w">	    </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">phen_variable</span><span class="w"></span>
<a id="ln-106" name="ln-106" href="#ln-106"></a>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">  </span><span class="c">!! vh_js !!</span>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="w">  </span><span class="c">! modules related to POP</span>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">  </span><span class="k">USE </span><span class="n">POP_Types</span><span class="p">,</span><span class="w">	    </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POP_TYPE</span><span class="w"></span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">  </span><span class="k">USE </span><span class="n">POPLUC_Types</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">POPLUC_Type</span><span class="w"></span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">  </span><span class="k">USE </span><span class="n">POPLUC_Module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w">  </span><span class="n">WRITE_LUC_OUTPUT_NC</span><span class="p">,</span><span class="w"> </span><span class="n">WRITE_LUC_OUTPUT_GRID_NC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">       </span><span class="n">POP_LUC_CASA_transfer</span><span class="p">,</span><span class="w">  </span><span class="n">WRITE_LUC_RESTART_NC</span><span class="p">,</span><span class="w"> </span><span class="n">POPLUC_set_patchfrac</span><span class="w"></span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">  </span><span class="k">USE </span><span class="n">POP_Constants</span><span class="p">,</span><span class="w">	    </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">HEIGHT_BINS</span><span class="p">,</span><span class="w"> </span><span class="n">NCOHORT_MAX</span><span class="w"></span>
<a id="ln-114" name="ln-114" href="#ln-114"></a>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">  </span><span class="c">! PLUME-MIP only</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">  </span><span class="k">USE </span><span class="n">CABLE_PLUME_MIP</span><span class="p">,</span><span class="w">	    </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">PLUME_MIP_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">PLUME_MIP_GET_MET</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">       </span><span class="n">PLUME_MIP_INIT</span><span class="w"></span>
<a id="ln-118" name="ln-118" href="#ln-118"></a>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">  </span><span class="k">USE </span><span class="n">CABLE_CRU</span><span class="p">,</span><span class="w">            </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">CRU_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">CRU_GET_SUBDIURNAL_MET</span><span class="p">,</span><span class="w"> </span><span class="n">CRU_INIT</span><span class="w"></span>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">  </span><span class="k">USE </span><span class="n">CABLE_site</span><span class="p">,</span><span class="w">           </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">site_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">site_INIT</span><span class="p">,</span><span class="w"> </span><span class="n">site_GET_CO2_Ndep</span><span class="w"></span>
<a id="ln-121" name="ln-121" href="#ln-121"></a>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">  </span><span class="c">! LUC_EXPT only</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">  </span><span class="k">USE </span><span class="n">CABLE_LUC_EXPT</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">LUC_EXPT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">LUC_EXPT_INIT</span><span class="w"></span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="cp">#ifdef NAG</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">  </span><span class="k">USE </span><span class="n">F90_UNIX</span><span class="w"></span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="cp">#endif</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_inout_module</span><span class="w"></span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_cable</span><span class="w"></span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="k">USE </span><span class="n">cbl_soil_snow_init_special_module</span><span class="w"></span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="k">USE </span><span class="n">landuse_constant</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">mstate</span><span class="p">,</span><span class="n">mvmax</span><span class="p">,</span><span class="n">mharvw</span><span class="w"></span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="k">USE </span><span class="n">landuse_variable</span><span class="w"></span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">  </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-133" name="ln-133" href="#ln-133"></a>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">  </span><span class="c">! CABLE namelist: model configuration, runtime/user switches</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">  </span><span class="c">!CHARACTER(LEN=200), PARAMETER :: CABLE_NAMELIST=&#39;cable.nml&#39;</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">  </span><span class="c">! try to read in namelist from command line argument</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">  </span><span class="c">! allows simple way of not hard coding cable.nml</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">  </span><span class="c">! defaults to using cable.nml if no file specified</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">  </span><span class="c">! timing variables</span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">PARAMETER</span><span class="w"> </span><span class="kd">::</span><span class="w">	 </span><span class="n">kstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="c">! start of simulation</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">PARAMETER</span><span class="w"> </span><span class="kd">::</span><span class="w">	 </span><span class="n">mloop</span><span class="w">	</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="w">   </span><span class="c">! CASA-CNP PreSpinup loops</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">LALLOC</span><span class="w"> </span><span class="c">! allocation coefficient for passing to spincasa</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w">	 </span><span class="kd">::</span><span class="w">							      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">       </span><span class="n">ktau</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! increment equates to timestep, resets if spinning up</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">       </span><span class="n">ktau_tot</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! NO reset when spinning up, total timesteps by model</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">       </span><span class="n">kend</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! no. of time steps in run</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">                                </span><span class="c">!CLN	  kstart = 1, &amp;	 ! timestep to start at</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">       </span><span class="n">koffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! timestep to start at</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">       </span><span class="n">koffset_met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!offfset for site met data (&#39;site&#39; only)</span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">       </span><span class="n">ktauday</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! day counter for CASA-CNP</span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">       </span><span class="n">idoy</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! day of year (1:365) counter for CASA-CNP</span>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="w">       </span><span class="n">nyear</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! year counter for CASA-CNP</span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">       </span><span class="n">casa_it</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! number of calls to CASA-CNP</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">       </span><span class="n">YYYY</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="w">       </span><span class="n">RYEAR</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">       </span><span class="n">RRRR</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">       </span><span class="n">NRRRR</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">       </span><span class="nb">ctime</span><span class="p">,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! day count for casacnp</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">       </span><span class="n">LOY</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w">	      </span><span class="c">! days in year</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">       </span><span class="n">count_sum_casa</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! number of time steps over which casa pools &amp;</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">                                </span><span class="c">!and fluxes are aggregated (for output)</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">       </span><span class="n">wlogn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10001</span><span class="w"></span>
<a id="ln-165" name="ln-165" href="#ln-165"></a>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">  </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dels</span><span class="w">			      </span><span class="c">! time step size in seconds</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:),</span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="w"></span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">  </span><span class="kt">CHARACTER</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">dum</span><span class="o">*</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">str1</span><span class="o">*</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="o">*</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">str3</span><span class="o">*</span><span class="mi">9</span><span class="w"></span>
<a id="ln-170" name="ln-170" href="#ln-170"></a>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">  </span><span class="c">! CABLE variables</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">met_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">met</span><span class="w">	   </span><span class="c">! met input variables</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">air_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">air</span><span class="w">	   </span><span class="c">! air property variables</span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">canopy_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">canopy</span><span class="w">  </span><span class="c">! vegetation variables</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">radiation_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rad</span><span class="w">	   </span><span class="c">! radiation variables</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">roughness_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rough</span><span class="w">   </span><span class="c">! roughness varibles</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">balances_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">bal</span><span class="w">	   </span><span class="c">! energy and water balance variables</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_snow_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ssnow</span><span class="w">   </span><span class="c">! soil and snow variables</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">  </span><span class="c">!mpidiff</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">climate_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">climate</span><span class="w">     </span><span class="c">! climate variables</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">  </span><span class="c">! CABLE parameters</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_parameter_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">soil</span><span class="w"> </span><span class="c">! soil parameters</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w">  </span><span class="c">! vegetation parameters</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">sum_flux</span><span class="w"> </span><span class="c">! cumulative flux variables</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">bgc_pool_type</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">bgc</span><span class="w">	</span><span class="c">! carbon pool variables</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">  </span><span class="c">! CASA-CNP variables</span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_biome</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">casabiome</span><span class="w"></span>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">sum_casapool</span><span class="w"></span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="w"></span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">  </span><span class="c">!! vh_js !!</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">POP_TYPE</span><span class="p">)</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">POP</span><span class="w"></span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">  </span><span class="k">TYPE</span><span class="p">(</span><span class="n">POPLUC_TYPE</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">POPLUC</span><span class="w"></span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">PLUME_MIP_TYPE</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">PLUME</span><span class="w"></span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">CRU_TYPE</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">CRU</span><span class="w"></span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">site_TYPE</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">site</span><span class="w"></span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">LUC_EXPT_TYPE</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="w"></span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">landuse_mp</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">lucmp</span><span class="w"></span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">  </span><span class="kt">CHARACTER</span><span class="w">		</span><span class="kd">::</span><span class="w"> </span><span class="n">cyear</span><span class="o">*</span><span class="mi">4</span><span class="w"></span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="w">  </span><span class="kt">CHARACTER</span><span class="w">		</span><span class="kd">::</span><span class="w"> </span><span class="n">ncfile</span><span class="o">*</span><span class="mi">99</span><span class="w"></span>
<a id="ln-208" name="ln-208" href="#ln-208"></a>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">  </span><span class="c">! declare vars for switches (default .FALSE.) etc declared thru namelist</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">  </span><span class="kt">LOGICAL</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">		  </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">       </span><span class="n">vegparmnew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using new format input file (BP dec 2007)</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">       </span><span class="n">spinup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! model spinup to soil state equilibrium?</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">       </span><span class="n">spinConv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! has spinup converged?</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="w">       </span><span class="n">spincasa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! TRUE: CASA-CNP Will spin mloop times,</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">                                </span><span class="c">! FALSE: no spin up</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">       </span><span class="n">l_casacnp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using CASA-CNP with CABLE</span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">       </span><span class="n">l_landuse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using CASA-CNP with CABLE</span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">       </span><span class="n">l_laiFeedbk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using prognostic LAI</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">       </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using prognostic Vcmax</span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">       </span><span class="n">CASAONLY</span><span class="w">	     </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w">	   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! ONLY Run CASA-CNP</span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">       </span><span class="n">CALL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w">		   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">       </span><span class="n">SPINon</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-223" name="ln-223" href="#ln-223"></a>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">  </span><span class="kt">REAL</span><span class="w">		    </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">       </span><span class="n">delsoilM</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! allowed variation in soil moisture for spin up</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">       </span><span class="n">delsoilT</span><span class="w">		   </span><span class="c">! allowed variation in soil temperature for spin up</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Metyear</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">LOYtmp</span><span class="w"></span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="w">  </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delgwM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-4</span><span class="w"></span>
<a id="ln-230" name="ln-230" href="#ln-230"></a>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">  </span><span class="c">! temporary storage for soil moisture/temp. in spin up mode</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:,:)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">       </span><span class="n">soilMtemp</span><span class="p">,</span><span class="w">			  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="w">       </span><span class="n">soilTtemp</span><span class="w"></span>
<a id="ln-235" name="ln-235" href="#ln-235"></a>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">GWtemp</span><span class="w"></span>
<a id="ln-237" name="ln-237" href="#ln-237"></a>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">  </span><span class="c">! timing</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">  </span><span class="kt">REAL</span><span class="kd">::</span><span class="w"> </span><span class="nb">etime</span><span class="w"> </span><span class="c">! Declare the type of etime(), For receiving user and system time, total time</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">heat_cap_lower_limit</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">  </span><span class="c">! switches etc defined thru namelist (by default cable.nml)</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">  </span><span class="k">NAMELIST</span><span class="o">/</span><span class="n">CABLE</span><span class="o">/</span><span class="w">		   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">       </span><span class="n">filename</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! TYPE, containing input filenames</span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">       </span><span class="n">vegparmnew</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! use new soil param. method</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="w">       </span><span class="n">soilparmnew</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! use new soil param. method</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">       </span><span class="n">calcsoilalbedo</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! albedo considers soil color Ticket #27</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">       </span><span class="n">spinup</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! spinup model (soil) to steady state</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">       </span><span class="n">delsoilM</span><span class="p">,</span><span class="n">delsoilT</span><span class="p">,&amp;</span><span class="w"> </span><span class="c">!</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="w">       </span><span class="n">delgwM</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">       </span><span class="n">output</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">       </span><span class="n">patchout</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">       </span><span class="n">check</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="w">       </span><span class="n">verbose</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="w">       </span><span class="n">leaps</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">       </span><span class="n">logn</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">       </span><span class="n">fixedCO2</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">       </span><span class="n">spincasa</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">       </span><span class="n">l_casacnp</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">       </span><span class="n">l_landuse</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">       </span><span class="n">l_laiFeedbk</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">       </span><span class="n">l_vcmaxFeedbk</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">       </span><span class="n">icycle</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">       </span><span class="n">casafile</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">       </span><span class="n">ncciy</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">       </span><span class="n">gswpfile</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">       </span><span class="n">redistrb</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">       </span><span class="n">wiltParam</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">       </span><span class="n">satuParam</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="w">       </span><span class="n">cable_user</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">   </span><span class="c">! additional USER switches</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">       </span><span class="n">gw_params</span><span class="w"></span>
<a id="ln-271" name="ln-271" href="#ln-271"></a>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="w">  </span><span class="c">!mpidiff</span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">np</span><span class="p">,</span><span class="n">ivt</span><span class="w"></span>
<a id="ln-274" name="ln-274" href="#ln-274"></a>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="w">  </span><span class="c">! Vars for standard for quasi-bitwise reproducability b/n runs</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">  </span><span class="c">! Check triggered by cable_user%consistency_check = .TRUE. in cable.nml</span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">  </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span><span class="w"> </span><span class="k">PARAMETER</span><span class="w"> </span><span class="kd">::</span><span class="w">					      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">       </span><span class="n">Ftrunk_sumbal</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.trunk_sumbal&quot;</span><span class="p">,</span><span class="w">					</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">       </span><span class="n">Fnew_sumbal</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;new_sumbal&quot;</span><span class="w"></span>
<a id="ln-280" name="ln-280" href="#ln-280"></a>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">  </span><span class="kt">DOUBLE PRECISION</span><span class="w"> </span><span class="kd">::</span><span class="w">									  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">       </span><span class="n">trunk_sumbal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">!</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">       </span><span class="n">new_sumbal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="w">       </span><span class="n">new_sumfpn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">       </span><span class="n">new_sumfe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="c">!For consistency w JAC</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c1</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rhoch</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xk</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-290" name="ln-290" href="#ln-290"></a>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nkend</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ioerror</span><span class="w"></span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">count_bal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-294" name="ln-294" href="#ln-294"></a>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="c">! for landuse</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="kt">integer     </span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="p">,</span><span class="w"> </span><span class="n">mpx</span><span class="w"></span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="kt">real</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:,:),</span><span class="w">   </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">luc_atransit</span><span class="w"></span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="kt">real</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:),</span><span class="w">     </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">luc_fharvw</span><span class="w"></span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="kt">real</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:,:),</span><span class="w">   </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">luc_xluh2cable</span><span class="w"></span>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="kt">real</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w">       </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">arealand</span><span class="w">        </span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="kt">integer</span><span class="p">,</span><span class="w">   </span><span class="k">dimension</span><span class="p">(:,:),</span><span class="w">     </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">landmask</span><span class="w"></span>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="kt">integer</span><span class="p">,</span><span class="w">   </span><span class="k">dimension</span><span class="p">(:),</span><span class="w">       </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">cstart</span><span class="p">,</span><span class="n">cend</span><span class="p">,</span><span class="n">nap</span><span class="w"></span>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="kt">real</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:,:),</span><span class="w">   </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">save</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">patchfrac_new</span><span class="w"></span>
<a id="ln-304" name="ln-304" href="#ln-304"></a>
<a id="ln-305" name="ln-305" href="#ln-305"></a><span class="c">! END header</span>
<a id="ln-306" name="ln-306" href="#ln-306"></a>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="w">  </span><span class="n">cable_runtime</span><span class="p">%</span><span class="n">offline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">  </span><span class="c">!check to see if first argument passed to cable is</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">  </span><span class="c">!the name of the namelist file</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">  </span><span class="c">!if not use cable.nml</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">  </span><span class="k">CALL </span><span class="n">get_namelist_file_name</span><span class="p">()</span><span class="w"></span>
<a id="ln-312" name="ln-312" href="#ln-312"></a>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">  </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;THE NAME LIST IS &quot;</span><span class="p">,</span><span class="n">CABLE_NAMELIST</span><span class="w"></span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">  </span><span class="c">! Open, read and close the namelist file.</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">  </span><span class="k">OPEN</span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_NAMELIST</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="w">  </span><span class="k">READ</span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">NML</span><span class="o">=</span><span class="n">CABLE</span><span class="w"> </span><span class="p">)</span><span class="w">	  </span><span class="c">!where NML=CABLE defined above</span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">  </span><span class="k">CLOSE</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"></span>
<a id="ln-318" name="ln-318" href="#ln-318"></a>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">  </span><span class="c">! Open, read and close the consistency check file.</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">  </span><span class="c">! Check triggered by cable_user%consistency_check = .TRUE. in cable.nml</span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">consistency_check</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="k">     OPEN</span><span class="p">(</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ftrunk_sumbal</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;READ&#39;</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ioerror</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">ioerror</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="k">        READ</span><span class="p">(</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">trunk_sumbal</span><span class="w">  </span><span class="c">! written by previous trunk version</span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">     </span><span class="k">ENDIF</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="k">     CLOSE</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">  </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-328" name="ln-328" href="#ln-328"></a>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">  </span><span class="c">! Open log file:</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="w">  </span><span class="k">OPEN</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="n">filename</span><span class="p">%</span><span class="nb">log</span><span class="p">)</span><span class="w"></span>
<a id="ln-331" name="ln-331" href="#ln-331"></a>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="nb">IARGC</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">arg_not_namelist</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="k">     CALL </span><span class="nb">GETARG</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">%</span><span class="n">met</span><span class="p">)</span><span class="w"></span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">     </span><span class="k">CALL </span><span class="nb">GETARG</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">casafile</span><span class="p">%</span><span class="n">cnpipool</span><span class="p">)</span><span class="w"></span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">  </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-336" name="ln-336" href="#ln-336"></a>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="w">  </span><span class="c">! INITIALISATION depending on nml settings</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;gswp&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;gswp3&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="k">     IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ncciy</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="k">        </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">        </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">     </span><span class="n">ELSEIF</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ncciy</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="k">        PRINT</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;undefined start year for gswp met: &#39;</span><span class="w"></span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">        </span><span class="k">PRINT</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;enter value for ncciy or&#39;</span><span class="w"></span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">        </span><span class="k">PRINT</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(CABLE_USER%YearStart and  CABLE_USER%YearEnd) &amp;</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="s1">             in cable.nml&#39;</span><span class="w"></span>
<a id="ln-347" name="ln-347" href="#ln-347"></a>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">        </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;undefined start year for gswp met: &#39;</span><span class="w"></span>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="w">        </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;enter value for ncciy or&#39;</span><span class="w"></span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">        </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;(CABLE_USER%YearStart and  CABLE_USER%YearEnd) &amp;</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="s1">             in cable.nml&#39;</span><span class="w"></span>
<a id="ln-352" name="ln-352" href="#ln-352"></a>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">        </span><span class="k">STOP</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="k">     ENDIF</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="k">  ENDIF</span>
<a id="ln-356" name="ln-356" href="#ln-356"></a>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="k">  </span><span class="n">CurYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="w"></span>
<a id="ln-358" name="ln-358" href="#ln-358"></a>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="k">     </span><span class="n">icycle</span><span class="w">			</span><span class="o">=</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">     </span><span class="n">CASAONLY</span><span class="w">			</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">     </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_READ</span><span class="w">	</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">     </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_WRITE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">  </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="k">     </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_READ</span><span class="w">	</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="w">     </span><span class="n">spincasa</span><span class="w">			</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-367" name="ln-367" href="#ln-367"></a>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">     </span><span class="c">!! vh_js !!</span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">     </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w">	</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="w">  </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-371" name="ln-371" href="#ln-371"></a>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">  </span><span class="c">!! vh_js !!</span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="k">     </span><span class="n">l_casacnp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">  </span><span class="k">ELSE</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="k">     </span><span class="n">l_casacnp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="w">  </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-378" name="ln-378" href="#ln-378"></a>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="w">  </span><span class="c">!! vh_js !! suggest LALLOC should ulitmately be a switch in the .nml file</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a><span class="k">     </span><span class="n">LALLOC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="c">! for use with POP: makes use of pipe model to partition between stem and leaf</span>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">  </span><span class="k">ELSE</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a><span class="k">     </span><span class="n">LALLOC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">! default</span>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">  </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-385" name="ln-385" href="#ln-385"></a>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="c">!!$   IF ( .NOT. spinup ) THEN</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="c">!!$	 IF ( spincasa ) THEN</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="c">!!$	    spincasa = .FALSE.</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="c">!!$	    WRITE(*,*)	 &quot;spinup == .FALSE. -&gt; spincasa set to .F.&quot;</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="c">!!$	    WRITE(logn,*)&quot;spinup == .FALSE. -&gt; spincasa set to .F.&quot;</span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="c">!!$	 ENDIF</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="c">!!$   ENDIF</span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="c">!!$</span>
<a id="ln-394" name="ln-394" href="#ln-394"></a>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;gpgs&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="k">     </span><span class="n">leaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">     </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;standard&quot;</span><span class="w"></span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">     </span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;gswp&#39;</span><span class="w"></span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">  </span><span class="k">ENDIF</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="k">  IF</span><span class="p">(</span><span class="w"> </span><span class="n">l_casacnp</span><span class="w">	 </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">		   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-402" name="ln-402" href="#ln-402"></a><span class="w">       </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;icycle must be 1 to 3 when using casaCNP&#39;</span><span class="w"></span>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">  </span><span class="c">!IF( ( l_laiFeedbk .OR. l_vcmaxFeedbk ) )	  &amp;</span>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="w">  </span><span class="c">!   STOP &#39;casaCNP required to get prognostic LAI or Vcmax&#39;</span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">					   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">       </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;icycle must be 2 to 3 to get prognostic Vcmax&#39;</span><span class="w"></span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">soilparmnew</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">				   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-408" name="ln-408" href="#ln-408"></a><span class="w">       </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;casaCNP must use new soil parameters&#39;</span><span class="w"></span>
<a id="ln-409" name="ln-409" href="#ln-409"></a>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">  </span><span class="n">NRRRR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MERGE</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_NREP</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">CASAONLY</span><span class="p">)</span><span class="w"></span>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="w">  </span><span class="c">! casa time count</span>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="w">  </span><span class="nb">ctime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-413" name="ln-413" href="#ln-413"></a>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="c">!!!! INISTUFF</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">  </span><span class="c">! Open met data and get site information from netcdf file. (NON-GSWP ONLY!)</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="w">  </span><span class="c">! This retrieves time step size, number of timesteps, starting date,</span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">  </span><span class="c">! latitudes, longitudes, number of sites.</span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;site&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="k">     IF</span><span class="w"> </span><span class="p">(</span><span class="n">l_casacnp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-422" name="ln-422" href="#ln-422"></a>
<a id="ln-423" name="ln-423" href="#ln-423"></a><span class="k">        CALL </span><span class="n">open_met_file</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">CTFRZ</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">koffset</span><span class="w"> </span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="k">           WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;When using POP, episode must start at Jan 1st!&quot;</span><span class="w"></span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="w">           </span><span class="k">STOP </span><span class="mi">991</span><span class="w"></span>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="w">        </span><span class="k">ENDIF</span>
<a id="ln-428" name="ln-428" href="#ln-428"></a>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="k">     ELSE</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="k">        WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;MetType=site only works with CASA-CNP turned on&quot;</span><span class="w"></span>
<a id="ln-432" name="ln-432" href="#ln-432"></a><span class="w">        </span><span class="k">STOP </span><span class="mi">991</span><span class="w"></span>
<a id="ln-433" name="ln-433" href="#ln-433"></a>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">     </span><span class="k">ENDIF</span><span class="w"> </span><span class="c">!l_casacnp</span>
<a id="ln-435" name="ln-435" href="#ln-435"></a>
<a id="ln-436" name="ln-436" href="#ln-436"></a><span class="w">  </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-437" name="ln-437" href="#ln-437"></a>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="k">     CALL </span><span class="n">open_met_file</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">CTFRZ</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">koffset</span><span class="w"> </span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a><span class="k">        WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;When using POP, episode must start at Jan 1st!&quot;</span><span class="w"></span>
<a id="ln-441" name="ln-441" href="#ln-441"></a><span class="w">        </span><span class="k">STOP </span><span class="mi">991</span><span class="w"></span>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="w">     </span><span class="k">ENDIF</span>
<a id="ln-443" name="ln-443" href="#ln-443"></a>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="k">  ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NRRRR</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-445" name="ln-445" href="#ln-445"></a>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="k">     IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">GSWP_MID</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-447" name="ln-447" href="#ln-447"></a><span class="w">          </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="p">:</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-448" name="ln-448" href="#ln-448"></a>
<a id="ln-449" name="ln-449" href="#ln-449"></a><span class="w">  </span><span class="k">ENDIF</span><span class="w"> </span><span class="c">!cable_user%MetType</span>
<a id="ln-450" name="ln-450" href="#ln-450"></a>
<a id="ln-451" name="ln-451" href="#ln-451"></a><span class="w">  </span><span class="c">! outer loop - spinup loop no. ktau_tot :</span>
<a id="ln-452" name="ln-452" href="#ln-452"></a><span class="w">  </span><span class="n">RYEAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-453" name="ln-453" href="#ln-453"></a><span class="w">  </span><span class="n">ktau_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-454" name="ln-454" href="#ln-454"></a><span class="w">  </span><span class="n">SPINon</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-455" name="ln-455" href="#ln-455"></a><span class="c">!!$  YearStart = CABLE_USER%YearStart</span>
<a id="ln-456" name="ln-456" href="#ln-456"></a><span class="c">!!$  YearEnd = CABLE_USER%YearEnd</span>
<a id="ln-457" name="ln-457" href="#ln-457"></a><span class="c">!!$  cable_user%CASA_SPIN_ENDYEAR</span>
<a id="ln-458" name="ln-458" href="#ln-458"></a>
<a id="ln-459" name="ln-459" href="#ln-459"></a><span class="w">  </span><span class="n">SPINLOOP</span><span class="p">:</span><span class="k">DO WHILE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">SPINon</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-460" name="ln-460" href="#ln-460"></a>
<a id="ln-461" name="ln-461" href="#ln-461"></a><span class="w">     </span><span class="n">NREP</span><span class="p">:</span><span class="w"> </span><span class="k">DO </span><span class="n">RRRR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NRRRR</span><span class="w"></span>
<a id="ln-462" name="ln-462" href="#ln-462"></a>
<a id="ln-463" name="ln-463" href="#ln-463"></a><span class="w">        </span><span class="n">YEAR</span><span class="p">:</span><span class="w"> </span><span class="k">DO </span><span class="n">YYYY</span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="p">,</span><span class="w">  </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"></span>
<a id="ln-464" name="ln-464" href="#ln-464"></a><span class="w">           </span><span class="n">CurYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">YYYY</span><span class="w"></span>
<a id="ln-465" name="ln-465" href="#ln-465"></a><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">leaps</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">IS_LEAPYEAR</span><span class="p">(</span><span class="w"> </span><span class="n">YYYY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-466" name="ln-466" href="#ln-466"></a><span class="k">              </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">366</span><span class="w"></span>
<a id="ln-467" name="ln-467" href="#ln-467"></a><span class="w">              </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;standard&quot;</span><span class="w"></span>
<a id="ln-468" name="ln-468" href="#ln-468"></a><span class="w">           </span><span class="k">ELSE</span>
<a id="ln-469" name="ln-469" href="#ln-469"></a><span class="k">              </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-470" name="ln-470" href="#ln-470"></a><span class="w">              </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;noleap&quot;</span><span class="w"></span>
<a id="ln-471" name="ln-471" href="#ln-471"></a><span class="w">           </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-472" name="ln-472" href="#ln-472"></a><span class="w">           </span><span class="c">! Check for gswp run</span>
<a id="ln-473" name="ln-473" href="#ln-473"></a><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;gswp&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-474" name="ln-474" href="#ln-474"></a><span class="k">              </span><span class="n">ncciy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-475" name="ln-475" href="#ln-475"></a>
<a id="ln-476" name="ln-476" href="#ln-476"></a><span class="w">              </span><span class="k">CALL </span><span class="n">prepareFiles</span><span class="p">(</span><span class="n">ncciy</span><span class="p">)</span><span class="w"></span>
<a id="ln-477" name="ln-477" href="#ln-477"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RRRR</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-478" name="ln-478" href="#ln-478"></a><span class="k">                 CALL </span><span class="n">open_met_file</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">CTFRZ</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-479" name="ln-479" href="#ln-479"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">leaps</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">is_leapyear</span><span class="p">(</span><span class="n">YYYY</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span><span class="n">kend</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2920</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-480" name="ln-480" href="#ln-480"></a><span class="k">                    STOP</span><span class="w"> </span><span class="s1">&#39;LEAP YEAR INCOMPATIBILITY WITH INPUT MET !!!&#39;</span><span class="w"></span>
<a id="ln-481" name="ln-481" href="#ln-481"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-482" name="ln-482" href="#ln-482"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NRRRR</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-483" name="ln-483" href="#ln-483"></a><span class="k">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_rain</span><span class="w"></span>
<a id="ln-484" name="ln-484" href="#ln-484"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_snow</span><span class="w"></span>
<a id="ln-485" name="ln-485" href="#ln-485"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_lw</span><span class="w"></span>
<a id="ln-486" name="ln-486" href="#ln-486"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_sw</span><span class="w"></span>
<a id="ln-487" name="ln-487" href="#ln-487"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_ps</span><span class="w"></span>
<a id="ln-488" name="ln-488" href="#ln-488"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_qa</span><span class="w"></span>
<a id="ln-489" name="ln-489" href="#ln-489"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_ta</span><span class="w"></span>
<a id="ln-490" name="ln-490" href="#ln-490"></a><span class="w">                    </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncid_wd</span><span class="w"></span>
<a id="ln-491" name="ln-491" href="#ln-491"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-492" name="ln-492" href="#ln-492"></a><span class="k">              ELSE</span>
<a id="ln-493" name="ln-493" href="#ln-493"></a><span class="k">                 </span><span class="n">ncid_rain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-494" name="ln-494" href="#ln-494"></a><span class="w">                 </span><span class="n">ncid_snow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-495" name="ln-495" href="#ln-495"></a><span class="w">                 </span><span class="n">ncid_lw</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-496" name="ln-496" href="#ln-496"></a><span class="w">                 </span><span class="n">ncid_sw</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-497" name="ln-497" href="#ln-497"></a><span class="w">                 </span><span class="n">ncid_ps</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-498" name="ln-498" href="#ln-498"></a><span class="w">                 </span><span class="n">ncid_qa</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-499" name="ln-499" href="#ln-499"></a><span class="w">                 </span><span class="n">ncid_ta</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-500" name="ln-500" href="#ln-500"></a><span class="w">                 </span><span class="n">ncid_wd</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">YYYY</span><span class="p">)</span><span class="w"></span>
<a id="ln-501" name="ln-501" href="#ln-501"></a><span class="w">                 </span><span class="n">kend</span><span class="w">	   </span><span class="o">=</span><span class="w"> </span><span class="n">ktauday</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-502" name="ln-502" href="#ln-502"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-503" name="ln-503" href="#ln-503"></a>
<a id="ln-504" name="ln-504" href="#ln-504"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-505" name="ln-505" href="#ln-505"></a><span class="k">                 </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;standard&quot;</span><span class="w"></span>
<a id="ln-506" name="ln-506" href="#ln-506"></a><span class="w">              </span><span class="k">ELSE</span>
<a id="ln-507" name="ln-507" href="#ln-507"></a><span class="k">                 </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;noleap&quot;</span><span class="w"></span>
<a id="ln-508" name="ln-508" href="#ln-508"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-509" name="ln-509" href="#ln-509"></a>
<a id="ln-510" name="ln-510" href="#ln-510"></a><span class="k">           ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;plum&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-511" name="ln-511" href="#ln-511"></a><span class="w">              </span><span class="c">! PLUME experiment setup using WATCH</span>
<a id="ln-512" name="ln-512" href="#ln-512"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CALL1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-513" name="ln-513" href="#ln-513"></a>
<a id="ln-514" name="ln-514" href="#ln-514"></a><span class="k">                 CALL </span><span class="nb">CPU_TIME</span><span class="p">(</span><span class="nb">etime</span><span class="p">)</span><span class="w"></span>
<a id="ln-515" name="ln-515" href="#ln-515"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">PLUME_MIP_INIT</span><span class="p">(</span><span class="w"> </span><span class="n">PLUME</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-516" name="ln-516" href="#ln-516"></a>
<a id="ln-517" name="ln-517" href="#ln-517"></a>
<a id="ln-518" name="ln-518" href="#ln-518"></a>
<a id="ln-519" name="ln-519" href="#ln-519"></a><span class="w">                 </span><span class="n">dels</span><span class="w">	   </span><span class="o">=</span><span class="w"> </span><span class="n">PLUME</span><span class="p">%</span><span class="n">dt</span><span class="w"></span>
<a id="ln-520" name="ln-520" href="#ln-520"></a><span class="w">                 </span><span class="n">koffset</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-521" name="ln-521" href="#ln-521"></a><span class="w">                 </span><span class="n">leaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PLUME</span><span class="p">%</span><span class="n">LeapYears</span><span class="w"></span>
<a id="ln-522" name="ln-522" href="#ln-522"></a>
<a id="ln-523" name="ln-523" href="#ln-523"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="s1">&#39;(i4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-524" name="ln-524" href="#ln-524"></a><span class="w">                 </span><span class="n">str1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="w"></span>
<a id="ln-525" name="ln-525" href="#ln-525"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="s1">&#39;(i2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-526" name="ln-526" href="#ln-526"></a><span class="w">                 </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span><span class="w"></span>
<a id="ln-527" name="ln-527" href="#ln-527"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str3</span><span class="p">,</span><span class="s1">&#39;(i2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-528" name="ln-528" href="#ln-528"></a><span class="w">                 </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str3</span><span class="p">)</span><span class="w"></span>
<a id="ln-529" name="ln-529" href="#ln-529"></a><span class="w">                 </span><span class="n">timeunits</span><span class="o">=</span><span class="s2">&quot;seconds since &quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;-&quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;-&quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str3</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; &amp;</span>
<a id="ln-530" name="ln-530" href="#ln-530"></a><span class="s2">                      00:00&quot;</span><span class="w"></span>
<a id="ln-531" name="ln-531" href="#ln-531"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-532" name="ln-532" href="#ln-532"></a><span class="k">                    </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;standard&quot;</span><span class="w"></span>
<a id="ln-533" name="ln-533" href="#ln-533"></a><span class="w">                 </span><span class="k">ELSE</span>
<a id="ln-534" name="ln-534" href="#ln-534"></a><span class="k">                    </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;noleap&quot;</span><span class="w"></span>
<a id="ln-535" name="ln-535" href="#ln-535"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-536" name="ln-536" href="#ln-536"></a>
<a id="ln-537" name="ln-537" href="#ln-537"></a><span class="k">              ENDIF</span>
<a id="ln-538" name="ln-538" href="#ln-538"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">PLUME</span><span class="p">%</span><span class="n">LeapYears</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-539" name="ln-539" href="#ln-539"></a><span class="w">              </span><span class="n">kend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-540" name="ln-540" href="#ln-540"></a><span class="w">           </span><span class="k">ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;cru&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-541" name="ln-541" href="#ln-541"></a><span class="w">              </span><span class="c">! TRENDY experiment using CRU-NCEP</span>
<a id="ln-542" name="ln-542" href="#ln-542"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CALL1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-543" name="ln-543" href="#ln-543"></a>
<a id="ln-544" name="ln-544" href="#ln-544"></a><span class="k">                 CALL </span><span class="nb">CPU_TIME</span><span class="p">(</span><span class="nb">etime</span><span class="p">)</span><span class="w"></span>
<a id="ln-545" name="ln-545" href="#ln-545"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">CRU_INIT</span><span class="p">(</span><span class="w"> </span><span class="n">CRU</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-546" name="ln-546" href="#ln-546"></a>
<a id="ln-547" name="ln-547" href="#ln-547"></a><span class="w">                 </span><span class="n">dels</span><span class="w">	   </span><span class="o">=</span><span class="w"> </span><span class="n">CRU</span><span class="p">%</span><span class="n">dtsecs</span><span class="w"></span>
<a id="ln-548" name="ln-548" href="#ln-548"></a><span class="w">                 </span><span class="n">koffset</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-549" name="ln-549" href="#ln-549"></a><span class="w">                 </span><span class="n">leaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w">         </span><span class="c">! No leap years in CRU-NCEP</span>
<a id="ln-550" name="ln-550" href="#ln-550"></a><span class="w">                 </span><span class="n">exists</span><span class="p">%</span><span class="n">Snowf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w">  </span><span class="c">! No snow in CRU-NCEP, so ensure it will</span>
<a id="ln-551" name="ln-551" href="#ln-551"></a><span class="w">                 </span><span class="c">! be determined from temperature in CABLE</span>
<a id="ln-552" name="ln-552" href="#ln-552"></a>
<a id="ln-553" name="ln-553" href="#ln-553"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="s1">&#39;(i4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-554" name="ln-554" href="#ln-554"></a><span class="w">                 </span><span class="n">str1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="w"></span>
<a id="ln-555" name="ln-555" href="#ln-555"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="s1">&#39;(i2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-556" name="ln-556" href="#ln-556"></a><span class="w">                 </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span><span class="w"></span>
<a id="ln-557" name="ln-557" href="#ln-557"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str3</span><span class="p">,</span><span class="s1">&#39;(i2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-558" name="ln-558" href="#ln-558"></a><span class="w">                 </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str3</span><span class="p">)</span><span class="w"></span>
<a id="ln-559" name="ln-559" href="#ln-559"></a><span class="w">                 </span><span class="n">timeunits</span><span class="o">=</span><span class="s2">&quot;seconds since &quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;-&quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;-&quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str3</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; &amp;</span>
<a id="ln-560" name="ln-560" href="#ln-560"></a><span class="s2">                      00:00&quot;</span><span class="w"></span>
<a id="ln-561" name="ln-561" href="#ln-561"></a><span class="w">                 </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;noleap&quot;</span><span class="w"></span>
<a id="ln-562" name="ln-562" href="#ln-562"></a>
<a id="ln-563" name="ln-563" href="#ln-563"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-564" name="ln-564" href="#ln-564"></a><span class="k">              </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-565" name="ln-565" href="#ln-565"></a><span class="w">              </span><span class="n">kend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-566" name="ln-566" href="#ln-566"></a><span class="w">           </span><span class="k">ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;site&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-567" name="ln-567" href="#ln-567"></a><span class="w">              </span><span class="c">! site experiment eg AmazonFace (spinup or  transient run type)</span>
<a id="ln-568" name="ln-568" href="#ln-568"></a>
<a id="ln-569" name="ln-569" href="#ln-569"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CALL1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-570" name="ln-570" href="#ln-570"></a><span class="k">                 CALL </span><span class="nb">CPU_TIME</span><span class="p">(</span><span class="nb">etime</span><span class="p">)</span><span class="w"></span>
<a id="ln-571" name="ln-571" href="#ln-571"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">site_INIT</span><span class="p">(</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-572" name="ln-572" href="#ln-572"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="s1">&#39;(i4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-573" name="ln-573" href="#ln-573"></a><span class="w">                 </span><span class="n">str1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="w"></span>
<a id="ln-574" name="ln-574" href="#ln-574"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="s1">&#39;(i2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-575" name="ln-575" href="#ln-575"></a><span class="w">                 </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span><span class="w"></span>
<a id="ln-576" name="ln-576" href="#ln-576"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">str3</span><span class="p">,</span><span class="s1">&#39;(i2)&#39;</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-577" name="ln-577" href="#ln-577"></a><span class="w">                 </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">str3</span><span class="p">)</span><span class="w"></span>
<a id="ln-578" name="ln-578" href="#ln-578"></a><span class="w">                 </span><span class="n">timeunits</span><span class="o">=</span><span class="s2">&quot;seconds since &quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;-&quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;-&quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">str3</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; &amp;</span>
<a id="ln-579" name="ln-579" href="#ln-579"></a><span class="s2">                      00:00&quot;</span><span class="w"></span>
<a id="ln-580" name="ln-580" href="#ln-580"></a><span class="w">                 </span><span class="n">calendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;standard&#39;</span><span class="w"></span>
<a id="ln-581" name="ln-581" href="#ln-581"></a>
<a id="ln-582" name="ln-582" href="#ln-582"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-583" name="ln-583" href="#ln-583"></a><span class="k">              </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-584" name="ln-584" href="#ln-584"></a>
<a id="ln-585" name="ln-585" href="#ln-585"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">IS_LEAPYEAR</span><span class="p">(</span><span class="n">CurYear</span><span class="p">))</span><span class="w"> </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">366</span><span class="w"></span>
<a id="ln-586" name="ln-586" href="#ln-586"></a><span class="w">              </span><span class="n">kend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-587" name="ln-587" href="#ln-587"></a><span class="w">              </span><span class="c">! get koffset to add to time-step of sitemet</span>
<a id="ln-588" name="ln-588" href="#ln-588"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">site</span><span class="p">%</span><span class="n">RunType</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;historical&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-589" name="ln-589" href="#ln-589"></a><span class="k">                 </span><span class="n">MetYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-590" name="ln-590" href="#ln-590"></a><span class="w">              </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">site</span><span class="p">%</span><span class="n">RunType</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;spinup&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">site</span><span class="p">%</span><span class="n">RunType</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;transient&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-591" name="ln-591" href="#ln-591"></a><span class="w">                 </span><span class="c">! setting met year so we end the spin-up at the end of the site data-years.</span>
<a id="ln-592" name="ln-592" href="#ln-592"></a><span class="w">                 </span><span class="n">MetYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">%</span><span class="n">spinstartyear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-593" name="ln-593" href="#ln-593"></a><span class="w">                      </span><span class="nb">MOD</span><span class="p">(</span><span class="n">CurYear</span><span class="o">-</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-594" name="ln-594" href="#ln-594"></a><span class="w">                      </span><span class="p">(</span><span class="n">site</span><span class="p">%</span><span class="n">spinstartyear</span><span class="o">-</span><span class="p">(</span><span class="n">site</span><span class="p">%</span><span class="n">spinendyear</span><span class="o">-</span><span class="n">site</span><span class="p">%</span><span class="n">spinstartyear</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-595" name="ln-595" href="#ln-595"></a><span class="w">                      </span><span class="p">(</span><span class="n">site</span><span class="p">%</span><span class="n">spinendyear</span><span class="o">-</span><span class="n">site</span><span class="p">%</span><span class="n">spinstartyear</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<a id="ln-596" name="ln-596" href="#ln-596"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-597" name="ln-597" href="#ln-597"></a><span class="k">              WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;MetYear: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">MetYear</span><span class="w"></span>
<a id="ln-598" name="ln-598" href="#ln-598"></a><span class="w">              </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Simulation Year: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-599" name="ln-599" href="#ln-599"></a><span class="w">              </span><span class="n">koffset_met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-600" name="ln-600" href="#ln-600"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">MetYear</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="n">site</span><span class="p">%</span><span class="n">spinstartyear</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-601" name="ln-601" href="#ln-601"></a><span class="k">                 DO </span><span class="n">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">%</span><span class="n">spinstartyear</span><span class="p">,</span><span class="w"> </span><span class="n">MetYear</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<a id="ln-602" name="ln-602" href="#ln-602"></a><span class="w">                    </span><span class="n">LOYtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-603" name="ln-603" href="#ln-603"></a><span class="w">                    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">IS_LEAPYEAR</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span><span class="w"> </span><span class="n">LOYtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">366</span><span class="w"></span>
<a id="ln-604" name="ln-604" href="#ln-604"></a><span class="w">                    </span><span class="n">koffset_met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">koffset_met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOYtmp</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8640</span><span class="mf">0.</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">dels</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-605" name="ln-605" href="#ln-605"></a><span class="w">                 </span><span class="k">ENDDO</span>
<a id="ln-606" name="ln-606" href="#ln-606"></a><span class="k">              ENDIF</span>
<a id="ln-607" name="ln-607" href="#ln-607"></a>
<a id="ln-608" name="ln-608" href="#ln-608"></a><span class="k">           ENDIF</span><span class="w"></span>
<a id="ln-609" name="ln-609" href="#ln-609"></a>
<a id="ln-610" name="ln-610" href="#ln-610"></a><span class="w">           </span><span class="c">! somethings (e.g. CASA-CNP) only need to be done once per day</span>
<a id="ln-611" name="ln-611" href="#ln-611"></a><span class="w">           </span><span class="n">ktauday</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-612" name="ln-612" href="#ln-612"></a>
<a id="ln-613" name="ln-613" href="#ln-613"></a><span class="w">           </span><span class="c">!! Checks where parameters and initialisations should be loaded from.</span>
<a id="ln-614" name="ln-614" href="#ln-614"></a><span class="w">           </span><span class="c">! If they can be found in either the met file or restart file, they will</span>
<a id="ln-615" name="ln-615" href="#ln-615"></a><span class="w">           </span><span class="c">! load from there, with the met file taking precedence. Otherwise, they&#39;ll</span>
<a id="ln-616" name="ln-616" href="#ln-616"></a><span class="w">           </span><span class="c">! be chosen from a coarse global grid of veg and soil types, based on</span>
<a id="ln-617" name="ln-617" href="#ln-617"></a><span class="w">           </span><span class="c">! the lat/lon coordinates. Allocation of CABLE&#39;s main variables also here.</span>
<a id="ln-618" name="ln-618" href="#ln-618"></a><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CALL1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-619" name="ln-619" href="#ln-619"></a>
<a id="ln-620" name="ln-620" href="#ln-620"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">POPLUC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-621" name="ln-621" href="#ln-621"></a><span class="k">                 CALL </span><span class="n">LUC_EXPT_INIT</span><span class="w"> </span><span class="p">(</span><span class="n">LUC_EXPT</span><span class="p">)</span><span class="w"></span>
<a id="ln-622" name="ln-622" href="#ln-622"></a><span class="w">              </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-623" name="ln-623" href="#ln-623"></a><span class="w">              </span><span class="c">!! vh_js !!</span>
<a id="ln-624" name="ln-624" href="#ln-624"></a><span class="w">              </span><span class="k">CALL </span><span class="n">load_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">bgc</span><span class="p">,</span><span class="w">		</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-625" name="ln-625" href="#ln-625"></a><span class="w">                   </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">sum_flux</span><span class="p">,</span><span class="w">			 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-626" name="ln-626" href="#ln-626"></a><span class="w">                   </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="w"> </span><span class="n">vegparmnew</span><span class="p">,</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-627" name="ln-627" href="#ln-627"></a><span class="w">                   </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-628" name="ln-628" href="#ln-628"></a><span class="w">                   </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">,</span><span class="w"> </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">,</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w">	       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-629" name="ln-629" href="#ln-629"></a><span class="w">                   </span><span class="n">CEMSOIL</span><span class="p">,</span><span class="w"> </span><span class="n">CTFRZ</span><span class="p">,</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">,</span><span class="w"> </span><span class="n">POPLUC</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-630" name="ln-630" href="#ln-630"></a>
<a id="ln-631" name="ln-631" href="#ln-631"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC_RunType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;static&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-632" name="ln-632" href="#ln-632"></a><span class="w">                   </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-633" name="ln-633" href="#ln-633"></a><span class="w">              </span><span class="c">! Open output file:</span>
<a id="ln-634" name="ln-634" href="#ln-634"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CASAONLY</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-635" name="ln-635" href="#ln-635"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filename</span><span class="p">%</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-636" name="ln-636" href="#ln-636"></a><span class="k">                    IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YEARSTART</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-637" name="ln-637" href="#ln-637"></a><span class="k">                       WRITE</span><span class="p">(</span><span class="w"> </span><span class="n">dum</span><span class="p">,</span><span class="w"> </span><span class="n">FMT</span><span class="o">=</span><span class="s2">&quot;(I4,&#39;_&#39;,I4)&quot;</span><span class="p">)</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YEARSTART</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-638" name="ln-638" href="#ln-638"></a><span class="w">                            </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YEAREND</span><span class="w"></span>
<a id="ln-639" name="ln-639" href="#ln-639"></a><span class="w">                       </span><span class="n">filename</span><span class="p">%</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filename</span><span class="p">%</span><span class="n">path</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-640" name="ln-640" href="#ln-640"></a><span class="w">                            </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">RunIden</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-641" name="ln-641" href="#ln-641"></a><span class="w">                            </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">dum</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_cable_out.nc&#39;</span><span class="w"></span>
<a id="ln-642" name="ln-642" href="#ln-642"></a><span class="w">                    </span><span class="k">ELSE</span>
<a id="ln-643" name="ln-643" href="#ln-643"></a><span class="k">                       </span><span class="n">filename</span><span class="p">%</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filename</span><span class="p">%</span><span class="n">path</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-644" name="ln-644" href="#ln-644"></a><span class="w">                            </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">RunIden</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_cable_out.nc&#39;</span><span class="w"></span>
<a id="ln-645" name="ln-645" href="#ln-645"></a><span class="w">                    </span><span class="k">ENDIF</span>
<a id="ln-646" name="ln-646" href="#ln-646"></a><span class="k">                 ENDIF</span>
<a id="ln-647" name="ln-647" href="#ln-647"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="n">RRRR</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-648" name="ln-648" href="#ln-648"></a><span class="k">                    CALL </span><span class="n">nullify_write</span><span class="p">()</span><span class="w"> </span><span class="c">! nullify pointers</span>
<a id="ln-649" name="ln-649" href="#ln-649"></a><span class="w">                    </span><span class="k">CALL </span><span class="n">open_output_file</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w"> </span><span class="n">rough</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-650" name="ln-650" href="#ln-650"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-651" name="ln-651" href="#ln-651"></a><span class="k">              ENDIF</span>
<a id="ln-652" name="ln-652" href="#ln-652"></a>
<a id="ln-653" name="ln-653" href="#ln-653"></a><span class="k">              </span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-654" name="ln-654" href="#ln-654"></a><span class="w">              </span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-655" name="ln-655" href="#ln-655"></a><span class="w">              </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-656" name="ln-656" href="#ln-656"></a><span class="w">              </span><span class="n">canopy</span><span class="p">%</span><span class="n">fes_cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-657" name="ln-657" href="#ln-657"></a><span class="w">              </span><span class="n">canopy</span><span class="p">%</span><span class="n">fhs_cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-658" name="ln-658" href="#ln-658"></a><span class="w">              </span><span class="n">met</span><span class="p">%</span><span class="n">ofsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w"></span>
<a id="ln-659" name="ln-659" href="#ln-659"></a>
<a id="ln-660" name="ln-660" href="#ln-660"></a>
<a id="ln-661" name="ln-661" href="#ln-661"></a><span class="w">              </span><span class="k">CALL </span><span class="n">zero_sum_casa</span><span class="p">(</span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">)</span><span class="w"></span>
<a id="ln-662" name="ln-662" href="#ln-662"></a><span class="w">              </span><span class="n">count_sum_casa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-663" name="ln-663" href="#ln-663"></a>
<a id="ln-664" name="ln-664" href="#ln-664"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">call_climate</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">climate_init</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-665" name="ln-665" href="#ln-665"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">call_climate</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">cable_user</span><span class="p">%</span><span class="n">climate_fromzero</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-666" name="ln-666" href="#ln-666"></a><span class="w">                   </span><span class="k">CALL </span><span class="n">READ_CLIMATE_RESTART_NC</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">)</span><span class="w"></span>
<a id="ln-667" name="ln-667" href="#ln-667"></a>
<a id="ln-668" name="ln-668" href="#ln-668"></a><span class="w">              </span><span class="n">spinConv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="c">! initialise spinup convergence variable</span>
<a id="ln-669" name="ln-669" href="#ln-669"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spinup</span><span class="p">)</span><span class="w">	</span><span class="n">spinConv</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-670" name="ln-670" href="#ln-670"></a><span class="w">              </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">spincasa</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-671" name="ln-671" href="#ln-671"></a><span class="k">                 PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;EXT spincasacnp enabled with mloop= &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mloop</span><span class="w"></span>
<a id="ln-672" name="ln-672" href="#ln-672"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">spincasacnp</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">mloop</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-673" name="ln-673" href="#ln-673"></a><span class="w">                      </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">)</span><span class="w"></span>
<a id="ln-674" name="ln-674" href="#ln-674"></a><span class="w">                 </span><span class="n">SPINon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-675" name="ln-675" href="#ln-675"></a><span class="w">                 </span><span class="n">SPINconv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-676" name="ln-676" href="#ln-676"></a>
<a id="ln-677" name="ln-677" href="#ln-677"></a><span class="w">              </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">casaonly</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">spincasa</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">!.AND. cable_user%popluc) THEN</span>
<a id="ln-678" name="ln-678" href="#ln-678"></a>
<a id="ln-679" name="ln-679" href="#ln-679"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">CASAONLY_LUC</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-680" name="ln-680" href="#ln-680"></a><span class="w">                      </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">,</span><span class="w"> </span><span class="n">POPLUC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-681" name="ln-681" href="#ln-681"></a><span class="w">                      </span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">)</span><span class="w"></span>
<a id="ln-682" name="ln-682" href="#ln-682"></a><span class="w">                 </span><span class="n">SPINon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-683" name="ln-683" href="#ln-683"></a><span class="w">                 </span><span class="n">SPINconv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-684" name="ln-684" href="#ln-684"></a><span class="w">                 </span><span class="n">ktau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-685" name="ln-685" href="#ln-685"></a>
<a id="ln-686" name="ln-686" href="#ln-686"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-687" name="ln-687" href="#ln-687"></a>
<a id="ln-688" name="ln-688" href="#ln-688"></a>
<a id="ln-689" name="ln-689" href="#ln-689"></a>
<a id="ln-690" name="ln-690" href="#ln-690"></a><span class="k">           ENDIF</span><span class="w"> </span><span class="c">! CALL 1</span>
<a id="ln-691" name="ln-691" href="#ln-691"></a>
<a id="ln-692" name="ln-692" href="#ln-692"></a><span class="w">           </span><span class="c">! globally (WRT code) accessible kend through USE cable_common_module</span>
<a id="ln-693" name="ln-693" href="#ln-693"></a><span class="w">           </span><span class="n">kwidth_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-694" name="ln-694" href="#ln-694"></a><span class="w">           </span><span class="n">kend_gl</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-695" name="ln-695" href="#ln-695"></a><span class="w">           </span><span class="n">knode_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-696" name="ln-696" href="#ln-696"></a>
<a id="ln-697" name="ln-697" href="#ln-697"></a><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">casaonly</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-698" name="ln-698" href="#ln-698"></a><span class="k">              EXIT</span>
<a id="ln-699" name="ln-699" href="#ln-699"></a><span class="k">           ENDIF</span>
<a id="ln-700" name="ln-700" href="#ln-700"></a>
<a id="ln-701" name="ln-701" href="#ln-701"></a><span class="k">  if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">heat_cap_lower_limit</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-702" name="ln-702" href="#ln-702"></a><span class="k">    allocate</span><span class="p">(</span><span class="w"> </span><span class="n">heat_cap_lower_limit</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<a id="ln-703" name="ln-703" href="#ln-703"></a><span class="w">    </span><span class="n">heat_cap_lower_limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<a id="ln-704" name="ln-704" href="#ln-704"></a><span class="w">  </span><span class="k">end if</span>
<a id="ln-705" name="ln-705" href="#ln-705"></a>
<a id="ln-706" name="ln-706" href="#ln-706"></a><span class="k">  call </span><span class="n">spec_init_soil_snow</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">heat_cap_lower_limit</span><span class="p">)</span><span class="w"></span>
<a id="ln-707" name="ln-707" href="#ln-707"></a>
<a id="ln-708" name="ln-708" href="#ln-708"></a><span class="w">           </span><span class="c">! time step loop over ktau</span>
<a id="ln-709" name="ln-709" href="#ln-709"></a><span class="w">           </span><span class="k">DO </span><span class="n">ktau</span><span class="o">=</span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-710" name="ln-710" href="#ln-710"></a>
<a id="ln-711" name="ln-711" href="#ln-711"></a><span class="w">              </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Progress -&#39;</span><span class="p">,</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ktau</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">kend</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-712" name="ln-712" href="#ln-712"></a>
<a id="ln-713" name="ln-713" href="#ln-713"></a><span class="w">              </span><span class="c">! increment total timstep counter</span>
<a id="ln-714" name="ln-714" href="#ln-714"></a><span class="w">              </span><span class="n">ktau_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktau_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-715" name="ln-715" href="#ln-715"></a>
<a id="ln-716" name="ln-716" href="#ln-716"></a><span class="w">              </span><span class="c">! globally (WRT code) accessible kend through USE cable_common_module</span>
<a id="ln-717" name="ln-717" href="#ln-717"></a><span class="w">              </span><span class="n">ktau_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktau_tot</span><span class="w"></span>
<a id="ln-718" name="ln-718" href="#ln-718"></a>
<a id="ln-719" name="ln-719" href="#ln-719"></a><span class="w">              </span><span class="n">idoy</span><span class="w"> </span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="w"> </span><span class="nb">MOD</span><span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="nb">CEILING</span><span class="p">(</span><span class="kt">REAL</span><span class="p">((</span><span class="n">ktau</span><span class="o">+</span><span class="n">koffset</span><span class="p">)</span><span class="o">/</span><span class="n">ktauday</span><span class="p">))),</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)))</span><span class="w"></span>
<a id="ln-720" name="ln-720" href="#ln-720"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idoy</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">idoy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-721" name="ln-721" href="#ln-721"></a>
<a id="ln-722" name="ln-722" href="#ln-722"></a><span class="w">              </span><span class="c">! needed for CASA-CNP</span>
<a id="ln-723" name="ln-723" href="#ln-723"></a><span class="w">              </span><span class="n">nyear</span><span class="w">	</span><span class="o">=</span><span class="nb">INT</span><span class="p">((</span><span class="n">kend</span><span class="o">+</span><span class="n">koffset</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">LOY</span><span class="o">*</span><span class="n">ktauday</span><span class="p">))</span><span class="w"></span>
<a id="ln-724" name="ln-724" href="#ln-724"></a>
<a id="ln-725" name="ln-725" href="#ln-725"></a><span class="w">              </span><span class="c">! Get met data and LAI, set time variables.</span>
<a id="ln-726" name="ln-726" href="#ln-726"></a><span class="w">              </span><span class="c">! Rainfall input may be augmented for spinup purposes:</span>
<a id="ln-727" name="ln-727" href="#ln-727"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;plum&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-728" name="ln-728" href="#ln-728"></a>
<a id="ln-729" name="ln-729" href="#ln-729"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">((</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">CASAONLY</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">CALL1</span><span class="p">))</span><span class="w">  </span><span class="k">THEN</span>
<a id="ln-730" name="ln-730" href="#ln-730"></a><span class="k">                    CALL </span><span class="n">PLUME_MIP_GET_MET</span><span class="p">(</span><span class="n">PLUME</span><span class="p">,</span><span class="w"> </span><span class="n">MET</span><span class="p">,</span><span class="w"> </span><span class="n">YYYY</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-731" name="ln-731" href="#ln-731"></a><span class="w">                         </span><span class="p">(</span><span class="n">YYYY</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ktau</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">kend</span><span class="p">))</span><span class="w"></span>
<a id="ln-732" name="ln-732" href="#ln-732"></a>
<a id="ln-733" name="ln-733" href="#ln-733"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-734" name="ln-734" href="#ln-734"></a>
<a id="ln-735" name="ln-735" href="#ln-735"></a><span class="k">              ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;cru&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-736" name="ln-736" href="#ln-736"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">((</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">CASAONLY</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">CALL1</span><span class="p">))</span><span class="w">  </span><span class="k">THEN</span>
<a id="ln-737" name="ln-737" href="#ln-737"></a><span class="k">                    CALL </span><span class="n">CRU_GET_SUBDIURNAL_MET</span><span class="p">(</span><span class="n">CRU</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-738" name="ln-738" href="#ln-738"></a><span class="w">                         </span><span class="n">YYYY</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-739" name="ln-739" href="#ln-739"></a><span class="w">                         </span><span class="n">YYYY</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="p">)</span><span class="w"></span>
<a id="ln-740" name="ln-740" href="#ln-740"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-741" name="ln-741" href="#ln-741"></a><span class="k">              ELSE</span>
<a id="ln-742" name="ln-742" href="#ln-742"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;site&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-743" name="ln-743" href="#ln-743"></a><span class="w">                      </span><span class="k">CALL </span><span class="n">get_met_data</span><span class="p">(</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">spinConv</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-744" name="ln-744" href="#ln-744"></a><span class="w">                      </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">CTFRZ</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="o">+</span><span class="n">koffset_met</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-745" name="ln-745" href="#ln-745"></a><span class="w">                      </span><span class="n">kstart</span><span class="o">+</span><span class="n">koffset_met</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-746" name="ln-746" href="#ln-746"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-747" name="ln-747" href="#ln-747"></a><span class="w">                      </span><span class="k">CALL </span><span class="n">get_met_data</span><span class="p">(</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">spinConv</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-748" name="ln-748" href="#ln-748"></a><span class="w">                      </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">CTFRZ</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="o">+</span><span class="n">koffset</span><span class="p">,</span><span class="w">		 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-749" name="ln-749" href="#ln-749"></a><span class="w">                      </span><span class="n">kstart</span><span class="o">+</span><span class="n">koffset</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-750" name="ln-750" href="#ln-750"></a>
<a id="ln-751" name="ln-751" href="#ln-751"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;site&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-752" name="ln-752" href="#ln-752"></a><span class="k">                    CALL </span><span class="n">site_get_CO2_Ndep</span><span class="p">(</span><span class="n">site</span><span class="p">)</span><span class="w"></span>
<a id="ln-753" name="ln-753" href="#ln-753"></a>
<a id="ln-754" name="ln-754" href="#ln-754"></a><span class="w">                    </span><span class="c">! Two options: (i) if we have sub-annual varying CO2, then</span>
<a id="ln-755" name="ln-755" href="#ln-755"></a><span class="w">                    </span><span class="c">! these data should be put into the met file and in site.nml</span>
<a id="ln-756" name="ln-756" href="#ln-756"></a><span class="w">                    </span><span class="c">! CO2 should be set to -9999; or (ii) if we only have annual</span>
<a id="ln-757" name="ln-757" href="#ln-757"></a><span class="w">                    </span><span class="c">! CO2 numbers then these should be read from the site csv file</span>
<a id="ln-758" name="ln-758" href="#ln-758"></a><span class="w">                    </span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ca</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="n">fixedCO2</span><span class="o">/</span><span class="mi">100000</span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<a id="ln-759" name="ln-759" href="#ln-759"></a><span class="w">                       </span><span class="n">met</span><span class="p">%</span><span class="n">ca</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">%</span><span class="n">CO2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1.e+6</span><span class="w"></span>
<a id="ln-760" name="ln-760" href="#ln-760"></a><span class="w">                    </span><span class="k">END WHERE</span>
<a id="ln-761" name="ln-761" href="#ln-761"></a>
<a id="ln-762" name="ln-762" href="#ln-762"></a><span class="k">                    </span><span class="n">met</span><span class="p">%</span><span class="n">Ndep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">%</span><span class="n">Ndep</span><span class="w">  </span><span class="o">*</span><span class="mi">100</span><span class="mf">0.</span><span class="o">/</span><span class="mi">1000</span><span class="mf">0.</span><span class="o">/</span><span class="mi">36</span><span class="mf">5.</span><span class="w"> </span><span class="c">! kg ha-1 y-1 &gt; g m-2 d-1</span>
<a id="ln-763" name="ln-763" href="#ln-763"></a><span class="w">                    </span><span class="n">met</span><span class="p">%</span><span class="n">Pdep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">%</span><span class="n">Pdep</span><span class="w">  </span><span class="o">*</span><span class="mi">100</span><span class="mf">0.</span><span class="o">/</span><span class="mi">1000</span><span class="mf">0.</span><span class="o">/</span><span class="mi">36</span><span class="mf">5.</span><span class="w"> </span><span class="c">! kg ha-1 y-1 &gt; g m-2 d-1</span>
<a id="ln-764" name="ln-764" href="#ln-764"></a><span class="w">                    </span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<a id="ln-765" name="ln-765" href="#ln-765"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-766" name="ln-766" href="#ln-766"></a>
<a id="ln-767" name="ln-767" href="#ln-767"></a>
<a id="ln-768" name="ln-768" href="#ln-768"></a><span class="k">              ENDIF</span>
<a id="ln-769" name="ln-769" href="#ln-769"></a>
<a id="ln-770" name="ln-770" href="#ln-770"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-771" name="ln-771" href="#ln-771"></a><span class="k">                 </span><span class="n">CurYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-772" name="ln-772" href="#ln-772"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">leaps</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">IS_LEAPYEAR</span><span class="p">(</span><span class="w"> </span><span class="n">CurYear</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-773" name="ln-773" href="#ln-773"></a><span class="k">                    </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">366</span><span class="w"></span>
<a id="ln-774" name="ln-774" href="#ln-774"></a><span class="w">                 </span><span class="k">ELSE</span>
<a id="ln-775" name="ln-775" href="#ln-775"></a><span class="k">                    </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-776" name="ln-776" href="#ln-776"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-777" name="ln-777" href="#ln-777"></a><span class="k">              ENDIF</span>
<a id="ln-778" name="ln-778" href="#ln-778"></a><span class="k">              </span><span class="n">met</span><span class="p">%</span><span class="n">ofsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-779" name="ln-779" href="#ln-779"></a><span class="w">              </span><span class="n">canopy</span><span class="p">%</span><span class="n">oldcansto</span><span class="o">=</span><span class="n">canopy</span><span class="p">%</span><span class="n">cansto</span><span class="w"></span>
<a id="ln-780" name="ln-780" href="#ln-780"></a><span class="w">              </span><span class="c">! Zero out lai where there is no vegetation acc. to veg. index</span>
<a id="ln-781" name="ln-781" href="#ln-781"></a><span class="w">              </span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(:)</span><span class="w"> </span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">veg</span><span class="p">%</span><span class="n">vlai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-782" name="ln-782" href="#ln-782"></a>
<a id="ln-783" name="ln-783" href="#ln-783"></a><span class="w">              </span><span class="c">! At first time step of year, set tile area according to updated LU areas</span>
<a id="ln-784" name="ln-784" href="#ln-784"></a><span class="w">              </span><span class="c">! and zero casa fluxes</span>
<a id="ln-785" name="ln-785" href="#ln-785"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-786" name="ln-786" href="#ln-786"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">casa_cnpflux</span><span class="p">(</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casabal</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.)</span><span class="w"></span>
<a id="ln-787" name="ln-787" href="#ln-787"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">POPLUC_set_patchfrac</span><span class="p">(</span><span class="n">POPLUC</span><span class="p">,</span><span class="n">LUC_EXPT</span><span class="p">)</span><span class="w"></span>
<a id="ln-788" name="ln-788" href="#ln-788"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-789" name="ln-789" href="#ln-789"></a>
<a id="ln-790" name="ln-790" href="#ln-790"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-791" name="ln-791" href="#ln-791"></a>
<a id="ln-792" name="ln-792" href="#ln-792"></a><span class="w">                 </span><span class="c">! Feedback prognostic vcmax and daily LAI from casaCNP to CABLE</span>
<a id="ln-793" name="ln-793" href="#ln-793"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">l_vcmaxFeedbk</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">casa_feedback</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="w">	 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-794" name="ln-794" href="#ln-794"></a><span class="w">                      </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-795" name="ln-795" href="#ln-795"></a>
<a id="ln-796" name="ln-796" href="#ln-796"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">l_laiFeedbk</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">veg</span><span class="p">%</span><span class="n">vlai</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">(:)</span><span class="w"></span>
<a id="ln-797" name="ln-797" href="#ln-797"></a>
<a id="ln-798" name="ln-798" href="#ln-798"></a><span class="w">   </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">c1</span><span class="p">))</span><span class="w"> </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w"> </span><span class="n">c1</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">nrb</span><span class="p">),</span><span class="w"> </span><span class="n">rhoch</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">nrb</span><span class="p">),</span><span class="w"> </span><span class="n">xk</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">nrb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-799" name="ln-799" href="#ln-799"></a><span class="w">                 </span><span class="c">! Call land surface scheme for this timestep, all grid points:</span>
<a id="ln-800" name="ln-800" href="#ln-800"></a><span class="w">   </span><span class="k">CALL </span><span class="n">cbm</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-801" name="ln-801" href="#ln-801"></a><span class="w">             </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">sum_flux</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">xk</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">rhoch</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-802" name="ln-802" href="#ln-802"></a>
<a id="ln-803" name="ln-803" href="#ln-803"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_climate</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-804" name="ln-804" href="#ln-804"></a><span class="w">                      </span><span class="k">CALL </span><span class="n">cable_climate</span><span class="p">(</span><span class="n">ktau_tot</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">ktauday</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">LOY</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-805" name="ln-805" href="#ln-805"></a><span class="w">                      </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-806" name="ln-806" href="#ln-806"></a>
<a id="ln-807" name="ln-807" href="#ln-807"></a>
<a id="ln-808" name="ln-808" href="#ln-808"></a><span class="w">                 </span><span class="n">ssnow</span><span class="p">%</span><span class="n">smelt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">smelt</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-809" name="ln-809" href="#ln-809"></a><span class="w">                 </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof1</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-810" name="ln-810" href="#ln-810"></a><span class="w">                 </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof2</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-811" name="ln-811" href="#ln-811"></a><span class="w">                 </span><span class="n">ssnow</span><span class="p">%</span><span class="n">runoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">runoff</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-812" name="ln-812" href="#ln-812"></a>
<a id="ln-813" name="ln-813" href="#ln-813"></a>
<a id="ln-814" name="ln-814" href="#ln-814"></a>
<a id="ln-815" name="ln-815" href="#ln-815"></a>
<a id="ln-816" name="ln-816" href="#ln-816"></a>
<a id="ln-817" name="ln-817" href="#ln-817"></a><span class="w">              </span><span class="k">ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IS_CASA_TIME</span><span class="p">(</span><span class="s2">&quot;dread&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-818" name="ln-818" href="#ln-818"></a><span class="w">                   </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">logn</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">		       </span><span class="c">! CLN READ FROM FILE INSTEAD !</span>
<a id="ln-819" name="ln-819" href="#ln-819"></a><span class="w">                 </span><span class="k">WRITE</span><span class="p">(</span><span class="n">CYEAR</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s2">&quot;(I4)&quot;</span><span class="p">)</span><span class="n">CurYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">INT</span><span class="p">((</span><span class="n">ktau</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="n">koffset</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">LOY</span><span class="o">*</span><span class="n">ktauday</span><span class="p">))</span><span class="w"></span>
<a id="ln-820" name="ln-820" href="#ln-820"></a><span class="w">                 </span><span class="n">ncfile</span><span class="w">	 </span><span class="o">=</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">casafile</span><span class="p">%</span><span class="n">c2cdumppath</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;c2c_&#39;</span><span class="o">//</span><span class="n">CYEAR</span><span class="o">//</span><span class="s1">&#39;_dump.nc&#39;</span><span class="w"></span>
<a id="ln-821" name="ln-821" href="#ln-821"></a><span class="w">                 </span><span class="n">casa_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">ktauday</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-822" name="ln-822" href="#ln-822"></a>
<a id="ln-823" name="ln-823" href="#ln-823"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">read_casa_dump</span><span class="p">(</span><span class="w"> </span><span class="n">ncfile</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">casa_it</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-824" name="ln-824" href="#ln-824"></a><span class="w">              </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-825" name="ln-825" href="#ln-825"></a>
<a id="ln-826" name="ln-826" href="#ln-826"></a><span class="w">              </span><span class="c">!jhan this is insufficient testing. condition for</span>
<a id="ln-827" name="ln-827" href="#ln-827"></a><span class="w">              </span><span class="c">!spinup=.false. &amp; we want CASA_dump.nc (spinConv=.true.)</span>
<a id="ln-828" name="ln-828" href="#ln-828"></a><span class="w">              </span><span class="k">IF</span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">	 </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_WRITE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-829" name="ln-829" href="#ln-829"></a><span class="w">                 </span><span class="c">!! vh_js !!</span>
<a id="ln-830" name="ln-830" href="#ln-830"></a>
<a id="ln-831" name="ln-831" href="#ln-831"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">bgcdriver</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w">		       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-832" name="ln-832" href="#ln-832"></a><span class="w">                      </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="w">			</span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-833" name="ln-833" href="#ln-833"></a><span class="w">                      </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">,</span><span class="w">		       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-834" name="ln-834" href="#ln-834"></a><span class="w">                      </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">spinConv</span><span class="p">,</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">idoy</span><span class="p">,</span><span class="w"> </span><span class="n">loy</span><span class="p">,</span><span class="w">	       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-835" name="ln-835" href="#ln-835"></a><span class="w">                      </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_READ</span><span class="p">,</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_WRITE</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-836" name="ln-836" href="#ln-836"></a><span class="w">                      </span><span class="n">LALLOC</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-837" name="ln-837" href="#ln-837"></a>
<a id="ln-838" name="ln-838" href="#ln-838"></a><span class="w">                 </span><span class="k">IF</span><span class="p">(</span><span class="nb">MOD</span><span class="p">((</span><span class="n">ktau</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ktauday</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-839" name="ln-839" href="#ln-839"></a>
<a id="ln-840" name="ln-840" href="#ln-840"></a><span class="w">                    </span><span class="c">!mpidiff</span>
<a id="ln-841" name="ln-841" href="#ln-841"></a><span class="w">                    </span><span class="c">! update time-aggregates of casa pools and fluxes</span>
<a id="ln-842" name="ln-842" href="#ln-842"></a><span class="w">                    </span><span class="k">CALL </span><span class="n">update_sum_casa</span><span class="p">(</span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-843" name="ln-843" href="#ln-843"></a><span class="w">                         </span><span class="p">&amp;</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-844" name="ln-844" href="#ln-844"></a><span class="w">                    </span><span class="n">count_sum_casa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_sum_casa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-845" name="ln-845" href="#ln-845"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-846" name="ln-846" href="#ln-846"></a>
<a id="ln-847" name="ln-847" href="#ln-847"></a>
<a id="ln-848" name="ln-848" href="#ln-848"></a><span class="k">                 IF</span><span class="p">(</span><span class="w"> </span><span class="p">((</span><span class="nb">MOD</span><span class="p">((</span><span class="n">ktau</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ktauday</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-849" name="ln-849" href="#ln-849"></a><span class="w">                      </span><span class="nb">MOD</span><span class="p">((</span><span class="n">ktau</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">ktauday</span><span class="p">,</span><span class="n">LOY</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="k">THEN</span><span class="w"> </span><span class="c">! end of year</span>
<a id="ln-850" name="ln-850" href="#ln-850"></a><span class="w">                    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-851" name="ln-851" href="#ln-851"></a><span class="w">                       </span><span class="c">! Dynamic LUC</span>
<a id="ln-852" name="ln-852" href="#ln-852"></a><span class="w">                       </span><span class="k">CALL </span><span class="n">LUCdriver</span><span class="p">(</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-853" name="ln-853" href="#ln-853"></a><span class="w">                            </span><span class="n">LUC_EXPT</span><span class="p">,</span><span class="w"> </span><span class="n">POPLUC</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-854" name="ln-854" href="#ln-854"></a><span class="w">                    </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-855" name="ln-855" href="#ln-855"></a>
<a id="ln-856" name="ln-856" href="#ln-856"></a><span class="w">                    </span><span class="c">! one annual time-step of POP</span>
<a id="ln-857" name="ln-857" href="#ln-857"></a><span class="w">                    </span><span class="k">CALL </span><span class="n">POPdriver</span><span class="p">(</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">)</span><span class="w"></span>
<a id="ln-858" name="ln-858" href="#ln-858"></a>
<a id="ln-859" name="ln-859" href="#ln-859"></a><span class="w">                    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-860" name="ln-860" href="#ln-860"></a><span class="w">                       </span><span class="c">! Dynamic LUC: update casa pools according to LUC transitions</span>
<a id="ln-861" name="ln-861" href="#ln-861"></a><span class="w">                       </span><span class="k">CALL </span><span class="n">POP_LUC_CASA_transfer</span><span class="p">(</span><span class="n">POPLUC</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">LUC_EXPT</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="n">ktauday</span><span class="p">)</span><span class="w"></span>
<a id="ln-862" name="ln-862" href="#ln-862"></a><span class="w">                       </span><span class="c">! Dynamic LUC: write output</span>
<a id="ln-863" name="ln-863" href="#ln-863"></a><span class="w">                       </span><span class="k">CALL </span><span class="n">WRITE_LUC_OUTPUT_NC</span><span class="p">(</span><span class="w"> </span><span class="n">POPLUC</span><span class="p">,</span><span class="w"> </span><span class="n">YYYY</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">YYYY</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">cable_user</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">))</span><span class="w"></span>
<a id="ln-864" name="ln-864" href="#ln-864"></a>
<a id="ln-865" name="ln-865" href="#ln-865"></a><span class="w">                    </span><span class="k">ENDIF</span>
<a id="ln-866" name="ln-866" href="#ln-866"></a><span class="k">                 ENDIF</span>
<a id="ln-867" name="ln-867" href="#ln-867"></a>
<a id="ln-868" name="ln-868" href="#ln-868"></a><span class="k">              ENDIF</span><span class="w"></span>
<a id="ln-869" name="ln-869" href="#ln-869"></a><span class="w">              </span><span class="c">! WRITE CASA OUTPUT</span>
<a id="ln-870" name="ln-870" href="#ln-870"></a><span class="w">              </span><span class="k">IF</span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-871" name="ln-871" href="#ln-871"></a>
<a id="ln-872" name="ln-872" href="#ln-872"></a>
<a id="ln-873" name="ln-873" href="#ln-873"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IS_CASA_TIME</span><span class="p">(</span><span class="s2">&quot;write&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-874" name="ln-874" href="#ln-874"></a><span class="w">                      </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">logn</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-875" name="ln-875" href="#ln-875"></a><span class="k">                    </span><span class="nb">ctime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ctime</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-876" name="ln-876" href="#ln-876"></a><span class="w">                    </span><span class="c">!mpidiff</span>
<a id="ln-877" name="ln-877" href="#ln-877"></a><span class="w">                    </span><span class="k">CALL </span><span class="n">update_sum_casa</span><span class="p">(</span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-878" name="ln-878" href="#ln-878"></a><span class="w">                         </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">count_sum_casa</span><span class="p">)</span><span class="w"></span>
<a id="ln-879" name="ln-879" href="#ln-879"></a><span class="w">                    </span><span class="k">CALL </span><span class="n">WRITE_CASA_OUTPUT_NC</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-880" name="ln-880" href="#ln-880"></a><span class="w">                         </span><span class="n">CASAONLY</span><span class="p">,</span><span class="w"> </span><span class="nb">ctime</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">kend</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">YYYY</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w">	       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-881" name="ln-881" href="#ln-881"></a><span class="w">                         </span><span class="n">cable_user</span><span class="p">%</span><span class="n">YearEnd</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">RRRR</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">NRRRR</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-882" name="ln-882" href="#ln-882"></a><span class="w">                    </span><span class="c">!mpidiff</span>
<a id="ln-883" name="ln-883" href="#ln-883"></a><span class="w">                    </span><span class="n">count_sum_casa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-884" name="ln-884" href="#ln-884"></a><span class="w">                    </span><span class="k">CALL </span><span class="n">zero_sum_casa</span><span class="p">(</span><span class="n">sum_casapool</span><span class="p">,</span><span class="w"> </span><span class="n">sum_casaflux</span><span class="p">)</span><span class="w"></span>
<a id="ln-885" name="ln-885" href="#ln-885"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-886" name="ln-886" href="#ln-886"></a>
<a id="ln-887" name="ln-887" href="#ln-887"></a>
<a id="ln-888" name="ln-888" href="#ln-888"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(((.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spinup</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">spinConv</span><span class="p">)).</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-889" name="ln-889" href="#ln-889"></a><span class="w">                      </span><span class="nb">MOD</span><span class="p">((</span><span class="n">ktau</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ktauday</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-890" name="ln-890" href="#ln-890"></a><span class="k">                    IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_WRITE</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">THEN</span>
<a id="ln-891" name="ln-891" href="#ln-891"></a>
<a id="ln-892" name="ln-892" href="#ln-892"></a><span class="k">                       IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-893" name="ln-893" href="#ln-893"></a><span class="w">                            </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;site&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-894" name="ln-894" href="#ln-894"></a>
<a id="ln-895" name="ln-895" href="#ln-895"></a><span class="k">                          WRITE</span><span class="p">(</span><span class="n">CYEAR</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s2">&quot;(I4)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-896" name="ln-896" href="#ln-896"></a><span class="w">                       </span><span class="k">ELSE</span><span class="w"></span>
<a id="ln-897" name="ln-897" href="#ln-897"></a><span class="w">                          </span><span class="c">!CLN CHECK FOR LEAP YEAR</span>
<a id="ln-898" name="ln-898" href="#ln-898"></a><span class="w">                          </span><span class="k">WRITE</span><span class="p">(</span><span class="n">CYEAR</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s2">&quot;(I4)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">CurYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">INT</span><span class="p">((</span><span class="n">ktau</span><span class="o">-</span><span class="n">kstart</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">LOY</span><span class="o">*</span><span class="n">ktauday</span><span class="p">))</span><span class="w"></span>
<a id="ln-899" name="ln-899" href="#ln-899"></a><span class="w">                       </span><span class="k">ENDIF</span>
<a id="ln-900" name="ln-900" href="#ln-900"></a><span class="k">                       </span><span class="n">ncfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">casafile</span><span class="p">%</span><span class="n">c2cdumppath</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;c2c_&#39;</span><span class="o">//</span><span class="n">CYEAR</span><span class="o">//</span><span class="s1">&#39;_dump.nc&#39;</span><span class="w"></span>
<a id="ln-901" name="ln-901" href="#ln-901"></a>
<a id="ln-902" name="ln-902" href="#ln-902"></a><span class="w">                       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-903" name="ln-903" href="#ln-903"></a><span class="w">                          </span><span class="c">!jhan:assuming doy for mp=1 is same as ....</span>
<a id="ln-904" name="ln-904" href="#ln-904"></a><span class="w">                          </span><span class="k">CALL </span><span class="n">write_casa_dump</span><span class="p">(</span><span class="w"> </span><span class="n">ncfile</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-905" name="ln-905" href="#ln-905"></a><span class="w">                               </span><span class="nb">INT</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="w"> </span><span class="n">LOY</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-906" name="ln-906" href="#ln-906"></a><span class="w">                       </span><span class="k">ELSE</span>
<a id="ln-907" name="ln-907" href="#ln-907"></a><span class="k">                          CALL </span><span class="n">write_casa_dump</span><span class="p">(</span><span class="w"> </span><span class="n">ncfile</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-908" name="ln-908" href="#ln-908"></a><span class="w">                               </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">idoy</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="o">/</span><span class="n">ktauday</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-909" name="ln-909" href="#ln-909"></a><span class="w">                       </span><span class="k">ENDIF</span>
<a id="ln-910" name="ln-910" href="#ln-910"></a>
<a id="ln-911" name="ln-911" href="#ln-911"></a><span class="k">                    ENDIF</span>
<a id="ln-912" name="ln-912" href="#ln-912"></a><span class="k">                 ENDIF</span>
<a id="ln-913" name="ln-913" href="#ln-913"></a>
<a id="ln-914" name="ln-914" href="#ln-914"></a><span class="k">              ENDIF</span>
<a id="ln-915" name="ln-915" href="#ln-915"></a>
<a id="ln-916" name="ln-916" href="#ln-916"></a>
<a id="ln-917" name="ln-917" href="#ln-917"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-918" name="ln-918" href="#ln-918"></a><span class="w">                 </span><span class="c">! sumcflux is pulled out of subroutine cbm</span>
<a id="ln-919" name="ln-919" href="#ln-919"></a><span class="w">                 </span><span class="c">! so that casaCNP can be called before adding the fluxes</span>
<a id="ln-920" name="ln-920" href="#ln-920"></a><span class="w">                 </span><span class="c">! (Feb 2008, YP)</span>
<a id="ln-921" name="ln-921" href="#ln-921"></a><span class="w">                 </span><span class="k">CALL </span><span class="n">sumcflux</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-922" name="ln-922" href="#ln-922"></a><span class="w">                      </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">sum_flux</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-923" name="ln-923" href="#ln-923"></a><span class="w">                      </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-924" name="ln-924" href="#ln-924"></a>
<a id="ln-925" name="ln-925" href="#ln-925"></a>
<a id="ln-926" name="ln-926" href="#ln-926"></a><span class="w">              </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-927" name="ln-927" href="#ln-927"></a>
<a id="ln-928" name="ln-928" href="#ln-928"></a><span class="w">              </span><span class="c">! Write timestep&#39;s output to file if either: we&#39;re not spinning up</span>
<a id="ln-929" name="ln-929" href="#ln-929"></a><span class="w">              </span><span class="c">! or we&#39;re spinning up and the spinup has converged:</span>
<a id="ln-930" name="ln-930" href="#ln-930"></a>
<a id="ln-931" name="ln-931" href="#ln-931"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">spinConv</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-932" name="ln-932" href="#ln-932"></a><span class="w">                 </span><span class="c">!mpidiff</span>
<a id="ln-933" name="ln-933" href="#ln-933"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;plum&#39;</span><span class="w">  </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-934" name="ln-934" href="#ln-934"></a><span class="w">                      </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;cru&#39;</span><span class="w">   </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-935" name="ln-935" href="#ln-935"></a><span class="w">                      </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;bios&#39;</span><span class="w">  </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-936" name="ln-936" href="#ln-936"></a><span class="w">                      </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;gswp&#39;</span><span class="w">  </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-937" name="ln-937" href="#ln-937"></a><span class="w">                      </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;site&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-938" name="ln-938" href="#ln-938"></a>
<a id="ln-939" name="ln-939" href="#ln-939"></a>
<a id="ln-940" name="ln-940" href="#ln-940"></a><span class="k">                    CALL </span><span class="n">write_output</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_tot</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-941" name="ln-941" href="#ln-941"></a><span class="w">                         </span><span class="n">ssnow</span><span class="p">,</span><span class="w">   </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">CSBOLTZ</span><span class="p">,</span><span class="w"> </span><span class="n">CEMLEAF</span><span class="p">,</span><span class="w"> </span><span class="n">CEMSOIL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-942" name="ln-942" href="#ln-942"></a><span class="w">                 </span><span class="k">ELSE</span>
<a id="ln-943" name="ln-943" href="#ln-943"></a><span class="k">                    CALL </span><span class="n">write_output</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-944" name="ln-944" href="#ln-944"></a><span class="w">                         </span><span class="n">ssnow</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">CSBOLTZ</span><span class="p">,</span><span class="w"> </span><span class="n">CEMLEAF</span><span class="p">,</span><span class="w"> </span><span class="n">CEMSOIL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-945" name="ln-945" href="#ln-945"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-946" name="ln-946" href="#ln-946"></a><span class="k">              ENDIF</span><span class="w"></span>
<a id="ln-947" name="ln-947" href="#ln-947"></a>
<a id="ln-948" name="ln-948" href="#ln-948"></a>
<a id="ln-949" name="ln-949" href="#ln-949"></a><span class="w">              </span><span class="c">! Check triggered by cable_user%consistency_check = .TRUE. in cable.nml</span>
<a id="ln-950" name="ln-950" href="#ln-950"></a><span class="w">              </span><span class="k">IF</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">consistency_check</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-951" name="ln-951" href="#ln-951"></a>
<a id="ln-952" name="ln-952" href="#ln-952"></a><span class="k">                 </span><span class="n">count_bal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_bal</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<a id="ln-953" name="ln-953" href="#ln-953"></a><span class="w">                 </span><span class="n">new_sumbal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_sumbal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">SUM</span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbal</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="nb">SUM</span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="w"></span>
<a id="ln-954" name="ln-954" href="#ln-954"></a><span class="w">                 </span><span class="n">new_sumfpn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_sumfpn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">SUM</span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fpn</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="w"></span>
<a id="ln-955" name="ln-955" href="#ln-955"></a><span class="w">                 </span><span class="n">new_sumfe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_sumfe</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">SUM</span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fe</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="w"></span>
<a id="ln-956" name="ln-956" href="#ln-956"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">PRINT</span><span class="o">*</span><span class="w"></span>
<a id="ln-957" name="ln-957" href="#ln-957"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">PRINT</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;time-space-averaged energy &amp; water balances&quot;</span><span class="w"></span>
<a id="ln-958" name="ln-958" href="#ln-958"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">PRINT</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;Ebal_tot[Wm-2], Wbal_tot[mm per timestep]&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-959" name="ln-959" href="#ln-959"></a><span class="w">                      </span><span class="nb">SUM</span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal_tot</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="o">/</span><span class="n">count_bal</span><span class="p">,</span><span class="w"> </span><span class="nb">SUM</span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbal_tot</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="o">/</span><span class="n">count_bal</span><span class="w"></span>
<a id="ln-960" name="ln-960" href="#ln-960"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">PRINT</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;time-space-averaged latent heat and &amp;</span>
<a id="ln-961" name="ln-961" href="#ln-961"></a><span class="s2">                      net photosynthesis&quot;</span><span class="w"></span>
<a id="ln-962" name="ln-962" href="#ln-962"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">PRINT</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sum_fe[Wm-2], sum_fpn[umol/m2/s]&quot;</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-963" name="ln-963" href="#ln-963"></a><span class="w">                      </span><span class="n">new_sumfe</span><span class="o">/</span><span class="n">count_bal</span><span class="p">,</span><span class="w"> </span><span class="n">new_sumfpn</span><span class="o">/</span><span class="n">count_bal</span><span class="w"></span>
<a id="ln-964" name="ln-964" href="#ln-964"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<a id="ln-965" name="ln-965" href="#ln-965"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;time-space-averaged energy &amp; water balances&quot;</span><span class="w"></span>
<a id="ln-966" name="ln-966" href="#ln-966"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s2">&quot;Ebal_tot[Wm-2], Wbal_tot[mm per timestep]&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-967" name="ln-967" href="#ln-967"></a><span class="w">                      </span><span class="nb">SUM</span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal_tot</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="o">/</span><span class="n">count_bal</span><span class="p">,</span><span class="w"> </span><span class="nb">SUM</span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbal_tot</span><span class="p">)</span><span class="o">/</span><span class="n">mp</span><span class="o">/</span><span class="n">count_bal</span><span class="w"></span>
<a id="ln-968" name="ln-968" href="#ln-968"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;time-space-averaged latent heat and &amp;</span>
<a id="ln-969" name="ln-969" href="#ln-969"></a><span class="s2">                      net photosynthesis&quot;</span><span class="w"></span>
<a id="ln-970" name="ln-970" href="#ln-970"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;sum_fe[Wm-2], sum_fpn[umol/m2/s]&quot;</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-971" name="ln-971" href="#ln-971"></a><span class="w">                      </span><span class="n">new_sumfe</span><span class="o">/</span><span class="n">count_bal</span><span class="p">,</span><span class="w"> </span><span class="n">new_sumfpn</span><span class="o">/</span><span class="n">count_bal</span><span class="w"></span>
<a id="ln-972" name="ln-972" href="#ln-972"></a>
<a id="ln-973" name="ln-973" href="#ln-973"></a>
<a id="ln-974" name="ln-974" href="#ln-974"></a><span class="w">                 </span><span class="c">! vh ! commented code below detects Nans in evaporation flux and stops if there are any.</span>
<a id="ln-975" name="ln-975" href="#ln-975"></a><span class="c">!!$	      do kk=1,mp</span>
<a id="ln-976" name="ln-976" href="#ln-976"></a><span class="c">!!$		 if( canopy%fe(kk).NE.( canopy%fe(kk))) THEN</span>
<a id="ln-977" name="ln-977" href="#ln-977"></a><span class="c">!!$		    write(*,*) &#39;fe nan&#39;, kk, ktau,met%qv(kk), met%precip(kk),met%precip_sn(kk), &amp;</span>
<a id="ln-978" name="ln-978" href="#ln-978"></a><span class="c">!!$			 met%fld(kk), met%fsd(kk,:), met%tk(kk), met%ua(kk), ssnow%potev(kk), met%pmb(kk), &amp;</span>
<a id="ln-979" name="ln-979" href="#ln-979"></a><span class="c">!!$			 canopy%ga(kk), ssnow%tgg(kk,:), canopy%fwsoil(kk)</span>
<a id="ln-980" name="ln-980" href="#ln-980"></a><span class="c">!!$</span>
<a id="ln-981" name="ln-981" href="#ln-981"></a><span class="c">!!$</span>
<a id="ln-982" name="ln-982" href="#ln-982"></a><span class="c">!!$		    stop</span>
<a id="ln-983" name="ln-983" href="#ln-983"></a><span class="c">!!$		 endif</span>
<a id="ln-984" name="ln-984" href="#ln-984"></a><span class="c">!!$		 if ( casaflux%cnpp(kk).NE. casaflux%cnpp(kk)) then</span>
<a id="ln-985" name="ln-985" href="#ln-985"></a><span class="c">!!$		    write(*,*) &#39;npp nan&#39;, kk, ktau,  casaflux%cnpp(kk)</span>
<a id="ln-986" name="ln-986" href="#ln-986"></a><span class="c">!!$		    stop</span>
<a id="ln-987" name="ln-987" href="#ln-987"></a><span class="c">!!$</span>
<a id="ln-988" name="ln-988" href="#ln-988"></a><span class="c">!!$		 endif</span>
<a id="ln-989" name="ln-989" href="#ln-989"></a><span class="c">!!$</span>
<a id="ln-990" name="ln-990" href="#ln-990"></a><span class="c">!!$</span>
<a id="ln-991" name="ln-991" href="#ln-991"></a><span class="c">!!$		 !if (canopy%fwsoil(kk).eq.0.0) then</span>
<a id="ln-992" name="ln-992" href="#ln-992"></a><span class="c">!!$		 !   write(*,*) &#39;zero fwsoil&#39;, ktau, canopy%fpn(kk)</span>
<a id="ln-993" name="ln-993" href="#ln-993"></a><span class="c">!!$		 !endif</span>
<a id="ln-994" name="ln-994" href="#ln-994"></a><span class="c">!!$</span>
<a id="ln-995" name="ln-995" href="#ln-995"></a><span class="c">!!$</span>
<a id="ln-996" name="ln-996" href="#ln-996"></a><span class="c">!!$	      enddo</span>
<a id="ln-997" name="ln-997" href="#ln-997"></a>
<a id="ln-998" name="ln-998" href="#ln-998"></a><span class="w">                 </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-999" name="ln-999" href="#ln-999"></a><span class="k">                    </span><span class="n">nkend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nkend</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-1000" name="ln-1000" href="#ln-1000"></a>
<a id="ln-1001" name="ln-1001" href="#ln-1001"></a><span class="w">                    </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">new_sumbal</span><span class="o">-</span><span class="n">trunk_sumbal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.e-7</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1002" name="ln-1002" href="#ln-1002"></a>
<a id="ln-1003" name="ln-1003" href="#ln-1003"></a><span class="k">                       PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"></span>
<a id="ln-1004" name="ln-1004" href="#ln-1004"></a><span class="w">                       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1005" name="ln-1005" href="#ln-1005"></a><span class="w">                            </span><span class="s2">&quot;NB. Offline-serial runs spinup cycles:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nkend</span><span class="w"></span>
<a id="ln-1006" name="ln-1006" href="#ln-1006"></a><span class="w">                       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1007" name="ln-1007" href="#ln-1007"></a><span class="w">                            </span><span class="s2">&quot;Internal check shows this version reproduces the trunk sumbal&quot;</span><span class="w"></span>
<a id="ln-1008" name="ln-1008" href="#ln-1008"></a>
<a id="ln-1009" name="ln-1009" href="#ln-1009"></a><span class="w">                    </span><span class="k">ELSE</span>
<a id="ln-1010" name="ln-1010" href="#ln-1010"></a>
<a id="ln-1011" name="ln-1011" href="#ln-1011"></a><span class="k">                       PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"></span>
<a id="ln-1012" name="ln-1012" href="#ln-1012"></a><span class="w">                       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1013" name="ln-1013" href="#ln-1013"></a><span class="w">                            </span><span class="s2">&quot;NB. Offline-serial runs spinup cycles:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nkend</span><span class="w"></span>
<a id="ln-1014" name="ln-1014" href="#ln-1014"></a><span class="w">                       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1015" name="ln-1015" href="#ln-1015"></a><span class="w">                            </span><span class="s2">&quot;Internal check shows in this version new_sumbal != trunk sumbal&quot;</span><span class="w"></span>
<a id="ln-1016" name="ln-1016" href="#ln-1016"></a><span class="w">                       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1017" name="ln-1017" href="#ln-1017"></a><span class="w">                            </span><span class="s2">&quot;Writing new_sumbal to the file:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Fnew_sumbal</span><span class="p">)</span><span class="w"></span>
<a id="ln-1018" name="ln-1018" href="#ln-1018"></a>
<a id="ln-1019" name="ln-1019" href="#ln-1019"></a><span class="w">                       </span><span class="k">OPEN</span><span class="p">(</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fnew_sumbal</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1020" name="ln-1020" href="#ln-1020"></a><span class="w">                       </span><span class="k">WRITE</span><span class="p">(</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(F20.7)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">new_sumbal</span><span class="w">  </span><span class="c">! written by previous trunk version</span>
<a id="ln-1021" name="ln-1021" href="#ln-1021"></a><span class="w">                       </span><span class="k">CLOSE</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<a id="ln-1022" name="ln-1022" href="#ln-1022"></a>
<a id="ln-1023" name="ln-1023" href="#ln-1023"></a><span class="w">                    </span><span class="k">ENDIF</span>
<a id="ln-1024" name="ln-1024" href="#ln-1024"></a><span class="k">                 ENDIF</span>
<a id="ln-1025" name="ln-1025" href="#ln-1025"></a>
<a id="ln-1026" name="ln-1026" href="#ln-1026"></a><span class="k">              ENDIF</span>
<a id="ln-1027" name="ln-1027" href="#ln-1027"></a>
<a id="ln-1028" name="ln-1028" href="#ln-1028"></a><span class="k">              </span><span class="n">CALL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-1029" name="ln-1029" href="#ln-1029"></a>
<a id="ln-1030" name="ln-1030" href="#ln-1030"></a><span class="w">           </span><span class="k">END DO</span><span class="w"> </span><span class="c">! END Do loop over timestep ktau</span>
<a id="ln-1031" name="ln-1031" href="#ln-1031"></a>
<a id="ln-1032" name="ln-1032" href="#ln-1032"></a><span class="w">           </span><span class="n">CALL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-1033" name="ln-1033" href="#ln-1033"></a>
<a id="ln-1034" name="ln-1034" href="#ln-1034"></a><span class="w">           </span><span class="c">!jhan this is insufficient testing. condition for</span>
<a id="ln-1035" name="ln-1035" href="#ln-1035"></a><span class="w">           </span><span class="c">!spinup=.false. &amp; we want CASA_dump.nc (spinConv=.true.)</span>
<a id="ln-1036" name="ln-1036" href="#ln-1036"></a><span class="w">           </span><span class="c">! see if spinup (if conducting one) has converged:</span>
<a id="ln-1037" name="ln-1037" href="#ln-1037"></a><span class="w">           </span><span class="c">!IF(spinup.AND..NOT.spinConv) THEN</span>
<a id="ln-1038" name="ln-1038" href="#ln-1038"></a><span class="w">           </span><span class="k">IF</span><span class="p">(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spinConv</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CASAONLY</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1039" name="ln-1039" href="#ln-1039"></a>
<a id="ln-1040" name="ln-1040" href="#ln-1040"></a><span class="w">              </span><span class="c">! Write to screen and log file:</span>
<a id="ln-1041" name="ln-1041" href="#ln-1041"></a><span class="w">              </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A18,I3,A24)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; Spinning up: run &#39;</span><span class="p">,</span><span class="nb">INT</span><span class="p">(</span><span class="n">ktau_tot</span><span class="o">/</span><span class="n">kend</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-1042" name="ln-1042" href="#ln-1042"></a><span class="w">                   </span><span class="s1">&#39; of data set complete...&#39;</span><span class="w"></span>
<a id="ln-1043" name="ln-1043" href="#ln-1043"></a><span class="w">              </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="s1">&#39;(A18,I3,A24)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; Spinning up: run &#39;</span><span class="p">,</span><span class="w">		      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1044" name="ln-1044" href="#ln-1044"></a><span class="w">                   </span><span class="nb">INT</span><span class="p">(</span><span class="n">ktau_tot</span><span class="o">/</span><span class="n">kend</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; of data set complete...&#39;</span><span class="w"></span>
<a id="ln-1045" name="ln-1045" href="#ln-1045"></a>
<a id="ln-1046" name="ln-1046" href="#ln-1046"></a>
<a id="ln-1047" name="ln-1047" href="#ln-1047"></a><span class="w">              </span><span class="c">! IF not 1st run through whole dataset:</span>
<a id="ln-1048" name="ln-1048" href="#ln-1048"></a><span class="c">!!$	      IF( MOD( ktau_tot, kend ) .EQ. 0 .AND. ktau_Tot .GT. kend .AND. &amp;</span>
<a id="ln-1049" name="ln-1049" href="#ln-1049"></a><span class="c">!!$		   YYYY.EQ. CABLE_USER%YearEnd .OR. ( NRRRR .GT. 1 .AND. &amp;</span>
<a id="ln-1050" name="ln-1050" href="#ln-1050"></a><span class="c">!!$		   RRRR.EQ. NRRRR) ) THEN</span>
<a id="ln-1051" name="ln-1051" href="#ln-1051"></a>
<a id="ln-1052" name="ln-1052" href="#ln-1052"></a><span class="w">              </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="nb">MOD</span><span class="p">(</span><span class="w"> </span><span class="n">ktau_tot</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ktau_Tot</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="n">kend</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1053" name="ln-1053" href="#ln-1053"></a><span class="w">                   </span><span class="n">YYYY</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1054" name="ln-1054" href="#ln-1054"></a>
<a id="ln-1055" name="ln-1055" href="#ln-1055"></a><span class="w">                 </span><span class="c">! evaluate spinup</span>
<a id="ln-1056" name="ln-1056" href="#ln-1056"></a><span class="w">                 </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="nb">ANY</span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="o">-</span><span class="n">soilMtemp</span><span class="p">)</span><span class="o">&gt;</span><span class="n">delsoilM</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span><span class="w">		      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1057" name="ln-1057" href="#ln-1057"></a><span class="w">                      </span><span class="nb">ANY</span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="o">-</span><span class="n">soilTtemp</span><span class="p">)</span><span class="o">&gt;</span><span class="n">delsoilT</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1058" name="ln-1058" href="#ln-1058"></a><span class="w">                      </span><span class="nb">MAXVAL</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">GWwb</span><span class="o">-</span><span class="n">GWtemp</span><span class="p">),</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">delgwM</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1059" name="ln-1059" href="#ln-1059"></a>
<a id="ln-1060" name="ln-1060" href="#ln-1060"></a><span class="w">                    </span><span class="c">! No complete convergence yet</span>
<a id="ln-1061" name="ln-1061" href="#ln-1061"></a><span class="w">                    </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ssnow%wb : &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="w"></span>
<a id="ln-1062" name="ln-1062" href="#ln-1062"></a><span class="w">                    </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;soilMtemp: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">soilMtemp</span><span class="w"></span>
<a id="ln-1063" name="ln-1063" href="#ln-1063"></a><span class="w">                    </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ssnow%tgg: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="w"></span>
<a id="ln-1064" name="ln-1064" href="#ln-1064"></a><span class="w">                    </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;soilTtemp: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">soilTtemp</span><span class="w"></span>
<a id="ln-1065" name="ln-1065" href="#ln-1065"></a><span class="w">                    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">gw_model</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1066" name="ln-1066" href="#ln-1066"></a><span class="k">                       PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ssnow%GWwb : &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">GWwb</span><span class="w"></span>
<a id="ln-1067" name="ln-1067" href="#ln-1067"></a><span class="w">                       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GWtemp: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">GWtemp</span><span class="w"></span>
<a id="ln-1068" name="ln-1068" href="#ln-1068"></a><span class="w">                    </span><span class="k">ENDIF</span>
<a id="ln-1069" name="ln-1069" href="#ln-1069"></a>
<a id="ln-1070" name="ln-1070" href="#ln-1070"></a><span class="k">                 ELSE</span><span class="w"> </span><span class="c">! spinup has converged</span>
<a id="ln-1071" name="ln-1071" href="#ln-1071"></a>
<a id="ln-1072" name="ln-1072" href="#ln-1072"></a><span class="w">                    </span><span class="n">spinConv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-1073" name="ln-1073" href="#ln-1073"></a><span class="w">                    </span><span class="c">! Write to screen and log file:</span>
<a id="ln-1074" name="ln-1074" href="#ln-1074"></a><span class="w">                    </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A33)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; Spinup has converged - final run&#39;</span><span class="w"></span>
<a id="ln-1075" name="ln-1075" href="#ln-1075"></a><span class="w">                    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="s1">&#39;(A52)&#39;</span><span class="p">)</span><span class="w">					      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1076" name="ln-1076" href="#ln-1076"></a><span class="w">                         </span><span class="s1">&#39; Spinup has converged - final run - writing all data&#39;</span><span class="w"></span>
<a id="ln-1077" name="ln-1077" href="#ln-1077"></a><span class="w">                    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="s1">&#39;(A37,F8.5,A28)&#39;</span><span class="p">)</span><span class="w">			      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1078" name="ln-1078" href="#ln-1078"></a><span class="w">                         </span><span class="s1">&#39; Criteria: Change in soil moisture &lt; &#39;</span><span class="p">,</span><span class="w">	      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1079" name="ln-1079" href="#ln-1079"></a><span class="w">                         </span><span class="n">delsoilM</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; in any layer over whole run&#39;</span><span class="w"></span>
<a id="ln-1080" name="ln-1080" href="#ln-1080"></a><span class="w">                    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="s1">&#39;(A40,F8.5,A28)&#39;</span><span class="w"> </span><span class="p">)</span><span class="w">			      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1081" name="ln-1081" href="#ln-1081"></a><span class="w">                         </span><span class="s1">&#39;	     Change in soil temperature &lt; &#39;</span><span class="p">,</span><span class="w">	       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1082" name="ln-1082" href="#ln-1082"></a><span class="w">                         </span><span class="n">delsoilT</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; in any layer over whole run&#39;</span><span class="w"></span>
<a id="ln-1083" name="ln-1083" href="#ln-1083"></a><span class="w">                 </span><span class="k">END IF</span>
<a id="ln-1084" name="ln-1084" href="#ln-1084"></a>
<a id="ln-1085" name="ln-1085" href="#ln-1085"></a><span class="k">              ELSE</span><span class="w"> </span><span class="c">! allocate variables for storage</span>
<a id="ln-1086" name="ln-1086" href="#ln-1086"></a>
<a id="ln-1087" name="ln-1087" href="#ln-1087"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">soilMtemp</span><span class="p">))</span><span class="w"> </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w">  </span><span class="n">soilMtemp</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1088" name="ln-1088" href="#ln-1088"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">soilTtemp</span><span class="p">))</span><span class="w"> </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w">  </span><span class="n">soilTtemp</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1089" name="ln-1089" href="#ln-1089"></a><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">GWtemp</span><span class="p">)</span><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w">  </span><span class="n">GWtemp</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<a id="ln-1090" name="ln-1090" href="#ln-1090"></a>
<a id="ln-1091" name="ln-1091" href="#ln-1091"></a><span class="w">              </span><span class="k">END IF</span>
<a id="ln-1092" name="ln-1092" href="#ln-1092"></a>
<a id="ln-1093" name="ln-1093" href="#ln-1093"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">max_spins</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1094" name="ln-1094" href="#ln-1094"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">((</span><span class="n">ktau_tot</span><span class="o">/</span><span class="n">kend</span><span class="w"> </span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="w"> </span><span class="n">cable_user</span><span class="p">%</span><span class="n">max_spins</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1095" name="ln-1095" href="#ln-1095"></a><span class="k">                    </span><span class="n">spinConv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-1096" name="ln-1096" href="#ln-1096"></a><span class="w">                    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Past &#39;</span><span class="p">,</span><span class="n">cable_user</span><span class="p">%</span><span class="n">max_spins</span><span class="p">,</span><span class="s1">&#39; spin cycles, running anyways&#39;</span><span class="w"></span>
<a id="ln-1097" name="ln-1097" href="#ln-1097"></a><span class="w">                 </span><span class="k">END IF</span>
<a id="ln-1098" name="ln-1098" href="#ln-1098"></a><span class="k">              END IF</span><span class="w"></span>
<a id="ln-1099" name="ln-1099" href="#ln-1099"></a>
<a id="ln-1100" name="ln-1100" href="#ln-1100"></a><span class="w">              </span><span class="c">! store soil moisture and temperature</span>
<a id="ln-1101" name="ln-1101" href="#ln-1101"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">YYYY</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1102" name="ln-1102" href="#ln-1102"></a><span class="k">                 </span><span class="n">soilTtemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="w"></span>
<a id="ln-1103" name="ln-1103" href="#ln-1103"></a><span class="w">                 </span><span class="n">soilMtemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="p">)</span><span class="w"></span>
<a id="ln-1104" name="ln-1104" href="#ln-1104"></a><span class="w">                 </span><span class="n">GWtemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">GWwb</span><span class="w"></span>
<a id="ln-1105" name="ln-1105" href="#ln-1105"></a><span class="w">              </span><span class="k">ENDIF</span>
<a id="ln-1106" name="ln-1106" href="#ln-1106"></a>
<a id="ln-1107" name="ln-1107" href="#ln-1107"></a><span class="k">           ELSE</span><span class="w"></span>
<a id="ln-1108" name="ln-1108" href="#ln-1108"></a>
<a id="ln-1109" name="ln-1109" href="#ln-1109"></a><span class="w">              </span><span class="c">! if not spinning up, or spin up has converged, exit:</span>
<a id="ln-1110" name="ln-1110" href="#ln-1110"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">SpinOn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1111" name="ln-1111" href="#ln-1111"></a><span class="k">                 PRINT</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;setting SPINON -&gt; FALSE&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">YYYY</span><span class="p">,</span><span class="w"> </span><span class="n">RRRR</span><span class="w"></span>
<a id="ln-1112" name="ln-1112" href="#ln-1112"></a><span class="w">                 </span><span class="n">SPINon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-1113" name="ln-1113" href="#ln-1113"></a><span class="w">              </span><span class="k">END IF</span>
<a id="ln-1114" name="ln-1114" href="#ln-1114"></a>
<a id="ln-1115" name="ln-1115" href="#ln-1115"></a><span class="k">           END IF</span>
<a id="ln-1116" name="ln-1116" href="#ln-1116"></a>
<a id="ln-1117" name="ln-1117" href="#ln-1117"></a>
<a id="ln-1118" name="ln-1118" href="#ln-1118"></a><span class="k">           IF</span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">casaonly</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">spinConv</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1119" name="ln-1119" href="#ln-1119"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1120" name="ln-1120" href="#ln-1120"></a><span class="k">                 CALL </span><span class="n">casa_fluxout</span><span class="p">(</span><span class="w"> </span><span class="n">nyear</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">)</span><span class="w"></span>
<a id="ln-1121" name="ln-1121" href="#ln-1121"></a><span class="w">              </span><span class="k">END IF</span>
<a id="ln-1122" name="ln-1122" href="#ln-1122"></a>
<a id="ln-1123" name="ln-1123" href="#ln-1123"></a><span class="k">           ENDIF</span>
<a id="ln-1124" name="ln-1124" href="#ln-1124"></a>
<a id="ln-1125" name="ln-1125" href="#ln-1125"></a><span class="k">           IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">casaonly</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">spinconv</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1126" name="ln-1126" href="#ln-1126"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NRRRR</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1127" name="ln-1127" href="#ln-1127"></a><span class="k">                 </span><span class="n">RYEAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">YYYY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1128" name="ln-1128" href="#ln-1128"></a><span class="w">                      </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RRRR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1129" name="ln-1129" href="#ln-1129"></a><span class="w">              </span><span class="k">ELSE</span>
<a id="ln-1130" name="ln-1130" href="#ln-1130"></a><span class="k">                 </span><span class="n">RYEAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">YYYY</span><span class="w"></span>
<a id="ln-1131" name="ln-1131" href="#ln-1131"></a><span class="w">              </span><span class="k">END IF</span>
<a id="ln-1132" name="ln-1132" href="#ln-1132"></a><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1133" name="ln-1133" href="#ln-1133"></a>
<a id="ln-1134" name="ln-1134" href="#ln-1134"></a><span class="k">                 IF</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">POP_out</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;epi&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1135" name="ln-1135" href="#ln-1135"></a><span class="k">                    CALL </span><span class="n">POP_IO</span><span class="p">(</span><span class="w"> </span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">RYEAR</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;WRITE_EPI&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1136" name="ln-1136" href="#ln-1136"></a><span class="w">                         </span><span class="p">(</span><span class="n">YYYY</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">RRRR</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">NRRRR</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1137" name="ln-1137" href="#ln-1137"></a>
<a id="ln-1138" name="ln-1138" href="#ln-1138"></a><span class="w">                 </span><span class="k">ENDIF</span>
<a id="ln-1139" name="ln-1139" href="#ln-1139"></a><span class="k">              ENDIF</span>
<a id="ln-1140" name="ln-1140" href="#ln-1140"></a>
<a id="ln-1141" name="ln-1141" href="#ln-1141"></a><span class="k">           ENDIF</span><span class="w"></span>
<a id="ln-1142" name="ln-1142" href="#ln-1142"></a><span class="w">           </span><span class="c">! Close met data input file:</span>
<a id="ln-1143" name="ln-1143" href="#ln-1143"></a>
<a id="ln-1144" name="ln-1144" href="#ln-1144"></a><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;gswp&quot;</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1145" name="ln-1145" href="#ln-1145"></a><span class="w">                </span><span class="n">RRRR</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="n">NRRRR</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1146" name="ln-1146" href="#ln-1146"></a><span class="k">              CALL </span><span class="n">close_met_file</span><span class="w"></span>
<a id="ln-1147" name="ln-1147" href="#ln-1147"></a><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">YYYY</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1148" name="ln-1148" href="#ln-1148"></a><span class="w">                   </span><span class="n">NRRRR</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">GSWP_MID</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1149" name="ln-1149" href="#ln-1149"></a><span class="w">           </span><span class="k">ENDIF</span>
<a id="ln-1150" name="ln-1150" href="#ln-1150"></a>
<a id="ln-1151" name="ln-1151" href="#ln-1151"></a><span class="k">           IF</span><span class="w"> </span><span class="p">((</span><span class="n">icycle</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">casaonly</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1152" name="ln-1152" href="#ln-1152"></a><span class="w">              </span><span class="c">! re-initalise annual flux sums</span>
<a id="ln-1153" name="ln-1153" href="#ln-1153"></a><span class="w">              </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCgppyear</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-1154" name="ln-1154" href="#ln-1154"></a><span class="w">              </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrpyear</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-1155" name="ln-1155" href="#ln-1155"></a><span class="w">              </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCnppyear</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<a id="ln-1156" name="ln-1156" href="#ln-1156"></a><span class="w">              </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrsyear</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-1157" name="ln-1157" href="#ln-1157"></a><span class="w">              </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCneeyear</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-1158" name="ln-1158" href="#ln-1158"></a><span class="w">           </span><span class="k">ENDIF</span>
<a id="ln-1159" name="ln-1159" href="#ln-1159"></a><span class="k">           CALL </span><span class="nb">CPU_TIME</span><span class="p">(</span><span class="nb">etime</span><span class="p">)</span><span class="w"></span>
<a id="ln-1160" name="ln-1160" href="#ln-1160"></a><span class="w">           </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Finished. &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">etime</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; seconds needed for year&#39;</span><span class="w"></span>
<a id="ln-1161" name="ln-1161" href="#ln-1161"></a>
<a id="ln-1162" name="ln-1162" href="#ln-1162"></a><span class="w">        </span><span class="k">END DO </span><span class="n">YEAR</span><span class="w"></span>
<a id="ln-1163" name="ln-1163" href="#ln-1163"></a>
<a id="ln-1164" name="ln-1164" href="#ln-1164"></a>
<a id="ln-1165" name="ln-1165" href="#ln-1165"></a><span class="w">     </span><span class="k">END DO </span><span class="n">NREP</span><span class="w"></span>
<a id="ln-1166" name="ln-1166" href="#ln-1166"></a>
<a id="ln-1167" name="ln-1167" href="#ln-1167"></a><span class="w">  </span><span class="k">END DO </span><span class="n">SPINLOOP</span><span class="w"></span>
<a id="ln-1168" name="ln-1168" href="#ln-1168"></a>
<a id="ln-1169" name="ln-1169" href="#ln-1169"></a><span class="w">  </span><span class="n">l_landuse</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<a id="ln-1170" name="ln-1170" href="#ln-1170"></a>
<a id="ln-1171" name="ln-1171" href="#ln-1171"></a><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">SpinConv</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1172" name="ln-1172" href="#ln-1172"></a><span class="w">     </span><span class="c">! Close output file and deallocate main variables:</span>
<a id="ln-1173" name="ln-1173" href="#ln-1173"></a><span class="w">     </span><span class="k">CALL </span><span class="n">close_output_file</span><span class="p">(</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w">		      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1174" name="ln-1174" href="#ln-1174"></a><span class="w">          </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w">					      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1175" name="ln-1175" href="#ln-1175"></a><span class="w">          </span><span class="n">sum_flux</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1176" name="ln-1176" href="#ln-1176"></a><span class="w">  </span><span class="k">ENDIF</span>
<a id="ln-1177" name="ln-1177" href="#ln-1177"></a>
<a id="ln-1178" name="ln-1178" href="#ln-1178"></a><span class="k">  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1179" name="ln-1179" href="#ln-1179"></a><span class="w">     </span><span class="c">!mpidiff</span>
<a id="ln-1180" name="ln-1180" href="#ln-1180"></a><span class="w">     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">cable_user</span><span class="p">%</span><span class="n">pop_fromzero</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1181" name="ln-1181" href="#ln-1181"></a><span class="w">          </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">POP_out</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="s1">&#39;ini&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1182" name="ln-1182" href="#ln-1182"></a><span class="k">        CALL </span><span class="n">POP_IO</span><span class="p">(</span><span class="w"> </span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">RYEAR</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;WRITE_INI&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span><span class="w"></span>
<a id="ln-1183" name="ln-1183" href="#ln-1183"></a><span class="w">     </span><span class="k">ELSE</span>
<a id="ln-1184" name="ln-1184" href="#ln-1184"></a><span class="k">        CALL </span><span class="n">POP_IO</span><span class="p">(</span><span class="w"> </span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">RYEAR</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;WRITE_RST&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span><span class="w"></span>
<a id="ln-1185" name="ln-1185" href="#ln-1185"></a><span class="w">     </span><span class="k">ENDIF</span>
<a id="ln-1186" name="ln-1186" href="#ln-1186"></a><span class="k">  ENDIF</span>
<a id="ln-1187" name="ln-1187" href="#ln-1187"></a>
<a id="ln-1188" name="ln-1188" href="#ln-1188"></a>
<a id="ln-1189" name="ln-1189" href="#ln-1189"></a>
<a id="ln-1190" name="ln-1190" href="#ln-1190"></a><span class="k">  IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">l_landuse</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1191" name="ln-1191" href="#ln-1191"></a>
<a id="ln-1192" name="ln-1192" href="#ln-1192"></a><span class="w">     </span><span class="c">!CALL casa_poolout( ktau, veg, soil, casabiome,		  &amp;</span>
<a id="ln-1193" name="ln-1193" href="#ln-1193"></a><span class="w">     </span><span class="c">! casapool, casaflux, casamet, casabal, phen )</span>
<a id="ln-1194" name="ln-1194" href="#ln-1194"></a><span class="w">     </span><span class="k">CALL </span><span class="n">write_casa_restart_nc</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1195" name="ln-1195" href="#ln-1195"></a>
<a id="ln-1196" name="ln-1196" href="#ln-1196"></a><span class="w">  </span><span class="k">END IF</span>
<a id="ln-1197" name="ln-1197" href="#ln-1197"></a>
<a id="ln-1198" name="ln-1198" href="#ln-1198"></a><span class="k">  IF</span><span class="w"> </span><span class="p">(</span><span class="n">l_landuse</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1199" name="ln-1199" href="#ln-1199"></a><span class="k">     </span><span class="n">mlon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mp</span><span class="p">)%</span><span class="n">ilon</span><span class="p">)</span><span class="w"></span>
<a id="ln-1200" name="ln-1200" href="#ln-1200"></a><span class="w">     </span><span class="n">mlat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mp</span><span class="p">)%</span><span class="n">ilat</span><span class="p">)</span><span class="w">     </span>
<a id="ln-1201" name="ln-1201" href="#ln-1201"></a><span class="w">     </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;before landuse: mlon mlat &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="w"></span>
<a id="ln-1202" name="ln-1202" href="#ln-1202"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">luc_atransit</span><span class="p">(</span><span class="n">mland</span><span class="p">,</span><span class="n">mvmax</span><span class="p">,</span><span class="n">mvmax</span><span class="p">))</span><span class="w"> </span>
<a id="ln-1203" name="ln-1203" href="#ln-1203"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">luc_fharvw</span><span class="p">(</span><span class="n">mland</span><span class="p">,</span><span class="n">mharvw</span><span class="p">))</span><span class="w"> </span>
<a id="ln-1204" name="ln-1204" href="#ln-1204"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">luc_xluh2cable</span><span class="p">(</span><span class="n">mland</span><span class="p">,</span><span class="n">mvmax</span><span class="p">,</span><span class="n">mstate</span><span class="p">))</span><span class="w">  </span>
<a id="ln-1205" name="ln-1205" href="#ln-1205"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">landmask</span><span class="p">(</span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="p">))</span><span class="w"></span>
<a id="ln-1206" name="ln-1206" href="#ln-1206"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">arealand</span><span class="p">(</span><span class="n">mland</span><span class="p">))</span><span class="w"></span>
<a id="ln-1207" name="ln-1207" href="#ln-1207"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">patchfrac_new</span><span class="p">(</span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="p">,</span><span class="n">mvmax</span><span class="p">))</span><span class="w"></span>
<a id="ln-1208" name="ln-1208" href="#ln-1208"></a><span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">cstart</span><span class="p">(</span><span class="n">mland</span><span class="p">),</span><span class="n">cend</span><span class="p">(</span><span class="n">mland</span><span class="p">),</span><span class="n">nap</span><span class="p">(</span><span class="n">mland</span><span class="p">))</span><span class="w"></span>
<a id="ln-1209" name="ln-1209" href="#ln-1209"></a>
<a id="ln-1210" name="ln-1210" href="#ln-1210"></a><span class="w">     </span><span class="k">do </span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mland</span><span class="w"></span>
<a id="ln-1211" name="ln-1211" href="#ln-1211"></a><span class="w">        </span><span class="n">cstart</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">landpt</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">cstart</span><span class="w"></span>
<a id="ln-1212" name="ln-1212" href="#ln-1212"></a><span class="w">        </span><span class="n">cend</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">landpt</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">cend</span><span class="w"></span>
<a id="ln-1213" name="ln-1213" href="#ln-1213"></a><span class="w">        </span><span class="n">nap</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">landpt</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">nap</span><span class="w"></span>
<a id="ln-1214" name="ln-1214" href="#ln-1214"></a><span class="w">     </span><span class="k">enddo</span>
<a id="ln-1215" name="ln-1215" href="#ln-1215"></a>
<a id="ln-1216" name="ln-1216" href="#ln-1216"></a><span class="k">     call </span><span class="n">landuse_data</span><span class="p">(</span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="p">,</span><span class="n">landmask</span><span class="p">,</span><span class="n">arealand</span><span class="p">,</span><span class="n">luc_atransit</span><span class="p">,</span><span class="n">luc_fharvw</span><span class="p">,</span><span class="n">luc_xluh2cable</span><span class="p">)</span><span class="w">      </span>
<a id="ln-1217" name="ln-1217" href="#ln-1217"></a><span class="w">     </span><span class="k">call  </span><span class="n">landuse_driver</span><span class="p">(</span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="p">,</span><span class="n">landmask</span><span class="p">,</span><span class="n">arealand</span><span class="p">,</span><span class="n">ssnow</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">bal</span><span class="p">,</span><span class="n">canopy</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1218" name="ln-1218" href="#ln-1218"></a><span class="w">                          </span><span class="n">phen</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="n">bgc</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1219" name="ln-1219" href="#ln-1219"></a><span class="w">                          </span><span class="n">cstart</span><span class="p">,</span><span class="n">cend</span><span class="p">,</span><span class="n">nap</span><span class="p">,</span><span class="n">lucmp</span><span class="p">)</span><span class="w"></span>
<a id="ln-1220" name="ln-1220" href="#ln-1220"></a>
<a id="ln-1221" name="ln-1221" href="#ln-1221"></a><span class="w">     </span><span class="k">do </span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mland</span><span class="w"></span>
<a id="ln-1222" name="ln-1222" href="#ln-1222"></a><span class="w">        </span><span class="k">do </span><span class="n">np</span><span class="o">=</span><span class="n">cstart</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">cend</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"></span>
<a id="ln-1223" name="ln-1223" href="#ln-1223"></a><span class="w">           </span><span class="n">ivt</span><span class="o">=</span><span class="n">lucmp</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="w"></span>
<a id="ln-1224" name="ln-1224" href="#ln-1224"></a><span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="n">ivt</span><span class="o">&lt;</span><span class="mf">1.</span><span class="nb">or</span><span class="p">.</span><span class="n">ivt</span><span class="o">&gt;</span><span class="n">mvmax</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-1225" name="ln-1225" href="#ln-1225"></a><span class="k">             print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;landuse: error in vegtype&#39;</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">np</span><span class="p">,</span><span class="n">ivt</span><span class="w"></span>
<a id="ln-1226" name="ln-1226" href="#ln-1226"></a><span class="w">             </span><span class="k">stop</span>
<a id="ln-1227" name="ln-1227" href="#ln-1227"></a><span class="k">           endif</span>
<a id="ln-1228" name="ln-1228" href="#ln-1228"></a><span class="k">           </span><span class="n">patchfrac_new</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">ilon</span><span class="p">,</span><span class="n">landpt</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">ilat</span><span class="p">,</span><span class="n">ivt</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lucmp</span><span class="p">%</span><span class="n">patchfrac</span><span class="p">(</span><span class="n">np</span><span class="p">)</span><span class="w"></span>
<a id="ln-1229" name="ln-1229" href="#ln-1229"></a><span class="w">        </span><span class="k">enddo</span>
<a id="ln-1230" name="ln-1230" href="#ln-1230"></a><span class="k">     enddo</span>
<a id="ln-1231" name="ln-1231" href="#ln-1231"></a>
<a id="ln-1232" name="ln-1232" href="#ln-1232"></a><span class="k">      call </span><span class="n">create_new_gridinfo</span><span class="p">(</span><span class="n">filename</span><span class="p">%</span><span class="k">type</span><span class="p">,</span><span class="n">filename</span><span class="p">%</span><span class="n">gridnew</span><span class="p">,</span><span class="n">mlon</span><span class="p">,</span><span class="n">mlat</span><span class="p">,</span><span class="n">landmask</span><span class="p">,</span><span class="n">patchfrac_new</span><span class="p">)</span><span class="w"></span>
<a id="ln-1233" name="ln-1233" href="#ln-1233"></a>
<a id="ln-1234" name="ln-1234" href="#ln-1234"></a><span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;writing casapools: land use&#39;</span><span class="w"></span>
<a id="ln-1235" name="ln-1235" href="#ln-1235"></a><span class="w">      </span><span class="k">call </span><span class="n">WRITE_LANDUSE_CASA_RESTART_NC</span><span class="p">(</span><span class="n">cend</span><span class="p">(</span><span class="n">mland</span><span class="p">),</span><span class="w"> </span><span class="n">lucmp</span><span class="p">,</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1236" name="ln-1236" href="#ln-1236"></a>
<a id="ln-1237" name="ln-1237" href="#ln-1237"></a><span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;writing cable restart: land use&#39;</span><span class="w"></span>
<a id="ln-1238" name="ln-1238" href="#ln-1238"></a><span class="w">      </span><span class="k">call </span><span class="n">create_landuse_cable_restart</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">cend</span><span class="p">(</span><span class="n">mland</span><span class="p">),</span><span class="n">lucmp</span><span class="p">,</span><span class="n">cstart</span><span class="p">,</span><span class="n">cend</span><span class="p">,</span><span class="n">nap</span><span class="p">)</span><span class="w"></span>
<a id="ln-1239" name="ln-1239" href="#ln-1239"></a>
<a id="ln-1240" name="ln-1240" href="#ln-1240"></a><span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;deallocating&#39;</span><span class="w"></span>
<a id="ln-1241" name="ln-1241" href="#ln-1241"></a><span class="w">      </span><span class="k">call </span><span class="n">landuse_deallocate_mp</span><span class="p">(</span><span class="n">cend</span><span class="p">(</span><span class="n">mland</span><span class="p">),</span><span class="n">ms</span><span class="p">,</span><span class="n">msn</span><span class="p">,</span><span class="n">nrb</span><span class="p">,</span><span class="n">mplant</span><span class="p">,</span><span class="n">mlitter</span><span class="p">,</span><span class="n">msoil</span><span class="p">,</span><span class="n">mwood</span><span class="p">,</span><span class="n">lucmp</span><span class="p">)</span><span class="w"></span>
<a id="ln-1242" name="ln-1242" href="#ln-1242"></a>
<a id="ln-1243" name="ln-1243" href="#ln-1243"></a><span class="w">  </span><span class="k">ENDIF</span>
<a id="ln-1244" name="ln-1244" href="#ln-1244"></a>
<a id="ln-1245" name="ln-1245" href="#ln-1245"></a><span class="k">  IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">POPLUC</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1246" name="ln-1246" href="#ln-1246"></a><span class="k">     CALL </span><span class="n">WRITE_LUC_RESTART_NC</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">POPLUC</span><span class="p">,</span><span class="w"> </span><span class="n">YYYY</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1247" name="ln-1247" href="#ln-1247"></a><span class="w">  </span><span class="k">ENDIF</span>
<a id="ln-1248" name="ln-1248" href="#ln-1248"></a>
<a id="ln-1249" name="ln-1249" href="#ln-1249"></a><span class="k">  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">l_landuse</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-1250" name="ln-1250" href="#ln-1250"></a><span class="w">     </span><span class="c">! Write restart file if requested:</span>
<a id="ln-1251" name="ln-1251" href="#ln-1251"></a><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">output</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span><span class="w">						  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1252" name="ln-1252" href="#ln-1252"></a><span class="w">          </span><span class="k">CALL </span><span class="n">create_restart</span><span class="p">(</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1253" name="ln-1253" href="#ln-1253"></a><span class="w">          </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1254" name="ln-1254" href="#ln-1254"></a><span class="w">     </span><span class="c">!mpidiff</span>
<a id="ln-1255" name="ln-1255" href="#ln-1255"></a><span class="w">     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_climate</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1256" name="ln-1256" href="#ln-1256"></a><span class="w">          </span><span class="k">CALL </span><span class="n">WRITE_CLIMATE_RESTART_NC</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1257" name="ln-1257" href="#ln-1257"></a>
<a id="ln-1258" name="ln-1258" href="#ln-1258"></a><span class="w">     </span><span class="c">!--- LN ------------------------------------------[</span>
<a id="ln-1259" name="ln-1259" href="#ln-1259"></a><span class="w">  </span><span class="k">ENDIF</span>
<a id="ln-1260" name="ln-1260" href="#ln-1260"></a>
<a id="ln-1261" name="ln-1261" href="#ln-1261"></a>
<a id="ln-1262" name="ln-1262" href="#ln-1262"></a>
<a id="ln-1263" name="ln-1263" href="#ln-1263"></a><span class="k">  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;gswp&quot;</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1264" name="ln-1264" href="#ln-1264"></a><span class="w">       </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;plum&quot;</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1265" name="ln-1265" href="#ln-1265"></a><span class="w">       </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;cru&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">close_met_file</span><span class="w"></span>
<a id="ln-1266" name="ln-1266" href="#ln-1266"></a>
<a id="ln-1267" name="ln-1267" href="#ln-1267"></a><span class="w">  </span><span class="c">!WRITE(logn,*) bal%wbal_tot, bal%ebal_tot, bal%ebal_tot_cncheck</span>
<a id="ln-1268" name="ln-1268" href="#ln-1268"></a><span class="w">  </span><span class="k">CALL </span><span class="nb">CPU_TIME</span><span class="p">(</span><span class="nb">etime</span><span class="p">)</span><span class="w"></span>
<a id="ln-1269" name="ln-1269" href="#ln-1269"></a><span class="w">  </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Finished. &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">etime</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; seconds needed for &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="s1">&#39; hours&#39;</span><span class="w"></span>
<a id="ln-1270" name="ln-1270" href="#ln-1270"></a><span class="w">  </span><span class="c">! Close log file</span>
<a id="ln-1271" name="ln-1271" href="#ln-1271"></a><span class="w">  </span><span class="k">CLOSE</span><span class="p">(</span><span class="n">logn</span><span class="p">)</span><span class="w"></span>
<a id="ln-1272" name="ln-1272" href="#ln-1272"></a><span class="w">  </span><span class="k">CALL </span><span class="nb">CPU_TIME</span><span class="p">(</span><span class="nb">etime</span><span class="p">)</span><span class="w"></span>
<a id="ln-1273" name="ln-1273" href="#ln-1273"></a><span class="w">  </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Finished. &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">etime</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; seconds needed for &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="s1">&#39; hours&#39;</span><span class="w"></span>
<a id="ln-1274" name="ln-1274" href="#ln-1274"></a>
<a id="ln-1275" name="ln-1275" href="#ln-1275"></a><span class="k">END PROGRAM </span><span class="n">cable_offline_driver</span><span class="w"></span>
<a id="ln-1276" name="ln-1276" href="#ln-1276"></a>
<a id="ln-1277" name="ln-1277" href="#ln-1277"></a>
<a id="ln-1278" name="ln-1278" href="#ln-1278"></a><span class="k">SUBROUTINE </span><span class="n">prepareFiles</span><span class="p">(</span><span class="n">ncciy</span><span class="p">)</span><span class="w"></span>
<a id="ln-1279" name="ln-1279" href="#ln-1279"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="w"></span>
<a id="ln-1280" name="ln-1280" href="#ln-1280"></a><span class="w">  </span><span class="k">IMPLICIT NONE</span>
<a id="ln-1281" name="ln-1281" href="#ln-1281"></a><span class="k">  </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-1282" name="ln-1282" href="#ln-1282"></a>
<a id="ln-1283" name="ln-1283" href="#ln-1283"></a><span class="w">  </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;CABLE offline global run using gswp forcing for &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-1284" name="ln-1284" href="#ln-1284"></a><span class="w">  </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w">	</span><span class="s1">&#39;CABLE offline global run using gswp forcing for &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-1285" name="ln-1285" href="#ln-1285"></a>
<a id="ln-1286" name="ln-1286" href="#ln-1286"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">rainf</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;rainf&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1287" name="ln-1287" href="#ln-1287"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">snowf</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;snowf&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1288" name="ln-1288" href="#ln-1288"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">LWdown</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;LWdown&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1289" name="ln-1289" href="#ln-1289"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">SWdown</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;SWdown&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1290" name="ln-1290" href="#ln-1290"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">PSurf</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;PSurf&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1291" name="ln-1291" href="#ln-1291"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">Qair</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;Qair&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1292" name="ln-1292" href="#ln-1292"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">Tair</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;Tair&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1293" name="ln-1293" href="#ln-1293"></a><span class="w">  </span><span class="k">CALL </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">%</span><span class="n">wind</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="s1">&#39;wind&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1294" name="ln-1294" href="#ln-1294"></a>
<a id="ln-1295" name="ln-1295" href="#ln-1295"></a><span class="k">END SUBROUTINE </span><span class="n">prepareFiles</span><span class="w"></span>
<a id="ln-1296" name="ln-1296" href="#ln-1296"></a>
<a id="ln-1297" name="ln-1297" href="#ln-1297"></a>
<a id="ln-1298" name="ln-1298" href="#ln-1298"></a>
<a id="ln-1299" name="ln-1299" href="#ln-1299"></a><span class="k">SUBROUTINE </span><span class="n">renameFiles</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="n">inFile</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="n">inName</span><span class="p">)</span><span class="w"></span>
<a id="ln-1300" name="ln-1300" href="#ln-1300"></a><span class="w">  </span><span class="k">IMPLICIT NONE</span>
<a id="ln-1301" name="ln-1301" href="#ln-1301"></a><span class="k">  </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-1302" name="ln-1302" href="#ln-1302"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="kd">::</span><span class="w"> </span><span class="n">nn</span><span class="w"></span>
<a id="ln-1303" name="ln-1303" href="#ln-1303"></a><span class="w">  </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inFile</span><span class="w"></span>
<a id="ln-1304" name="ln-1304" href="#ln-1304"></a><span class="w">  </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span><span class="w">  </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">	   </span><span class="kd">::</span><span class="w"> </span><span class="n">inName</span><span class="w"></span>
<a id="ln-1305" name="ln-1305" href="#ln-1305"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idummy</span><span class="w"></span>
<a id="ln-1306" name="ln-1306" href="#ln-1306"></a>
<a id="ln-1307" name="ln-1307" href="#ln-1307"></a><span class="w">  </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INDEX</span><span class="p">(</span><span class="n">inFile</span><span class="p">,</span><span class="s1">&#39;19&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-1308" name="ln-1308" href="#ln-1308"></a><span class="w">  </span><span class="k">READ</span><span class="p">(</span><span class="n">inFile</span><span class="p">(</span><span class="n">nn</span><span class="p">:</span><span class="n">nn</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;(i4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">idummy</span><span class="w"></span>
<a id="ln-1309" name="ln-1309" href="#ln-1309"></a><span class="w">  </span><span class="k">WRITE</span><span class="p">(</span><span class="n">inFile</span><span class="p">(</span><span class="n">nn</span><span class="p">:</span><span class="n">nn</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;(i4.4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">ncciy</span><span class="w"></span>
<a id="ln-1310" name="ln-1310" href="#ln-1310"></a><span class="w">  </span><span class="k">WRITE</span><span class="p">(</span><span class="n">logn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">inName</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; global data from &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">inFile</span><span class="p">)</span><span class="w"></span>
<a id="ln-1311" name="ln-1311" href="#ln-1311"></a>
<a id="ln-1312" name="ln-1312" href="#ln-1312"></a><span class="k">END SUBROUTINE </span><span class="n">renameFiles</span><span class="w"></span>
<a id="ln-1313" name="ln-1313" href="#ln-1313"></a>
<a id="ln-1314" name="ln-1314" href="#ln-1314"></a><span class="c">!***************************************************************************************</span>
<a id="ln-1315" name="ln-1315" href="#ln-1315"></a><span class="c">! subroutine for reading LU input data, zeroing biomass in empty secondary forest tiles</span>
<a id="ln-1316" name="ln-1316" href="#ln-1316"></a><span class="c">! and tranferring LUC-based age weights for secondary forest to POP structure</span>
<a id="ln-1317" name="ln-1317" href="#ln-1317"></a>
<a id="ln-1318" name="ln-1318" href="#ln-1318"></a>
<a id="ln-1319" name="ln-1319" href="#ln-1319"></a><span class="k">SUBROUTINE </span><span class="n">LUCdriver</span><span class="p">(</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1320" name="ln-1320" href="#ln-1320"></a><span class="w">     </span><span class="n">casaflux</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">LUC_EXPT</span><span class="p">,</span><span class="w"> </span><span class="n">POPLUC</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-1321" name="ln-1321" href="#ln-1321"></a>
<a id="ln-1322" name="ln-1322" href="#ln-1322"></a>
<a id="ln-1323" name="ln-1323" href="#ln-1323"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">veg_parameter_type</span><span class="p">,</span><span class="w"> </span><span class="n">mland</span><span class="w"></span>
<a id="ln-1324" name="ln-1324" href="#ln-1324"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_carbon_module</span><span class="w"></span>
<a id="ln-1325" name="ln-1325" href="#ln-1325"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">,</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-1326" name="ln-1326" href="#ln-1326"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_ncdf_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">is_casa_time</span><span class="w"></span>
<a id="ln-1327" name="ln-1327" href="#ln-1327"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="w"> </span><span class="n">landpt</span><span class="p">,</span><span class="w"> </span><span class="n">patch</span><span class="w"></span>
<a id="ln-1328" name="ln-1328" href="#ln-1328"></a><span class="w">  </span><span class="k">USE </span><span class="n">casadimension</span><span class="w"></span>
<a id="ln-1329" name="ln-1329" href="#ln-1329"></a><span class="w">  </span><span class="k">USE </span><span class="n">casaparm</span><span class="w"></span>
<a id="ln-1330" name="ln-1330" href="#ln-1330"></a><span class="w">  </span><span class="k">USE </span><span class="n">casavariable</span><span class="w"></span>
<a id="ln-1331" name="ln-1331" href="#ln-1331"></a><span class="w">  </span><span class="k">USE </span><span class="n">POP_Types</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POP_TYPE</span><span class="w"></span>
<a id="ln-1332" name="ln-1332" href="#ln-1332"></a><span class="w">  </span><span class="k">USE </span><span class="n">POPMODULE</span><span class="p">,</span><span class="w">            </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POPStep</span><span class="p">,</span><span class="w"> </span><span class="n">POP_init_single</span><span class="w"></span>
<a id="ln-1333" name="ln-1333" href="#ln-1333"></a><span class="w">  </span><span class="k">USE </span><span class="n">TypeDef</span><span class="p">,</span><span class="w">              </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">i4b</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"></span>
<a id="ln-1334" name="ln-1334" href="#ln-1334"></a><span class="w">  </span><span class="k">USE </span><span class="n">CABLE_LUC_EXPT</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">LUC_EXPT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">read_LUH2</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-1335" name="ln-1335" href="#ln-1335"></a><span class="w">       </span><span class="n">ptos</span><span class="p">,</span><span class="n">ptog</span><span class="p">,</span><span class="n">stog</span><span class="p">,</span><span class="n">gtos</span><span class="p">,</span><span class="n">grassfrac</span><span class="p">,</span><span class="w"> </span><span class="n">pharv</span><span class="p">,</span><span class="w"> </span><span class="n">smharv</span><span class="p">,</span><span class="w"> </span><span class="n">syharv</span><span class="w"></span>
<a id="ln-1336" name="ln-1336" href="#ln-1336"></a><span class="w">  </span><span class="k">USE </span><span class="n">POPLUC_Types</span><span class="w"></span>
<a id="ln-1337" name="ln-1337" href="#ln-1337"></a><span class="w">  </span><span class="k">USE </span><span class="n">POPLUC_Module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POPLUCStep</span><span class="p">,</span><span class="w"> </span><span class="n">POPLUC_weights_Transfer</span><span class="p">,</span><span class="w"> </span><span class="n">WRITE_LUC_OUTPUT_NC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1338" name="ln-1338" href="#ln-1338"></a><span class="w">       </span><span class="n">POP_LUC_CASA_transfer</span><span class="p">,</span><span class="w">  </span><span class="n">WRITE_LUC_RESTART_NC</span><span class="p">,</span><span class="w"> </span><span class="n">READ_LUC_RESTART_NC</span><span class="w"></span>
<a id="ln-1339" name="ln-1339" href="#ln-1339"></a>
<a id="ln-1340" name="ln-1340" href="#ln-1340"></a>
<a id="ln-1341" name="ln-1341" href="#ln-1341"></a>
<a id="ln-1342" name="ln-1342" href="#ln-1342"></a><span class="w">  </span><span class="k">IMPLICIT NONE</span>
<a id="ln-1343" name="ln-1343" href="#ln-1343"></a>
<a id="ln-1344" name="ln-1344" href="#ln-1344"></a><span class="k">  TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_biome</span><span class="p">),</span><span class="w">            </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabiome</span><span class="w"></span>
<a id="ln-1345" name="ln-1345" href="#ln-1345"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">),</span><span class="w">             </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-1346" name="ln-1346" href="#ln-1346"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">),</span><span class="w">             </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-1347" name="ln-1347" href="#ln-1347"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">POP_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">POP</span><span class="w"></span>
<a id="ln-1348" name="ln-1348" href="#ln-1348"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">LUC_EXPT_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="w"></span>
<a id="ln-1349" name="ln-1349" href="#ln-1349"></a><span class="w">  </span><span class="k">TYPE</span><span class="p">(</span><span class="n">POPLUC_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">POPLUC</span><span class="w"></span>
<a id="ln-1350" name="ln-1350" href="#ln-1350"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="w">    </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w">  </span><span class="c">! vegetation parameters</span>
<a id="ln-1351" name="ln-1351" href="#ln-1351"></a>
<a id="ln-1352" name="ln-1352" href="#ln-1352"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="w"></span>
<a id="ln-1353" name="ln-1353" href="#ln-1353"></a>
<a id="ln-1354" name="ln-1354" href="#ln-1354"></a>
<a id="ln-1355" name="ln-1355" href="#ln-1355"></a>
<a id="ln-1356" name="ln-1356" href="#ln-1356"></a><span class="w">  </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;cablecasa_LUC&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-1357" name="ln-1357" href="#ln-1357"></a><span class="w">  </span><span class="n">yyyy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CurYear</span><span class="w"></span>
<a id="ln-1358" name="ln-1358" href="#ln-1358"></a>
<a id="ln-1359" name="ln-1359" href="#ln-1359"></a>
<a id="ln-1360" name="ln-1360" href="#ln-1360"></a>
<a id="ln-1361" name="ln-1361" href="#ln-1361"></a><span class="w">  </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">CTSTEP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yyyy</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">FirstYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1362" name="ln-1362" href="#ln-1362"></a>
<a id="ln-1363" name="ln-1363" href="#ln-1363"></a><span class="w">  </span><span class="k">CALL </span><span class="n">READ_LUH2</span><span class="p">(</span><span class="n">LUC_EXPT</span><span class="p">)</span><span class="w"></span>
<a id="ln-1364" name="ln-1364" href="#ln-1364"></a>
<a id="ln-1365" name="ln-1365" href="#ln-1365"></a><span class="w">  </span><span class="k">DO </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mland</span><span class="w"></span>
<a id="ln-1366" name="ln-1366" href="#ln-1366"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">ptos</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">ptos</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1367" name="ln-1367" href="#ln-1367"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">ptog</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">ptog</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1368" name="ln-1368" href="#ln-1368"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="k">stop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-1369" name="ln-1369" href="#ln-1369"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">stog</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">stog</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1370" name="ln-1370" href="#ln-1370"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">gtop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-1371" name="ln-1371" href="#ln-1371"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">gtos</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">gtos</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1372" name="ln-1372" href="#ln-1372"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">pharv</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">pharv</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1373" name="ln-1373" href="#ln-1373"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">smharv</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">smharv</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1374" name="ln-1374" href="#ln-1374"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">syharv</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">INPUT</span><span class="p">(</span><span class="n">syharv</span><span class="p">)%</span><span class="n">VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-1375" name="ln-1375" href="#ln-1375"></a><span class="w">     </span><span class="n">POPLUC</span><span class="p">%</span><span class="n">thisyear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yyyy</span><span class="w"></span>
<a id="ln-1376" name="ln-1376" href="#ln-1376"></a><span class="w">  </span><span class="k">ENDDO</span><span class="w"></span>
<a id="ln-1377" name="ln-1377" href="#ln-1377"></a>
<a id="ln-1378" name="ln-1378" href="#ln-1378"></a><span class="w">  </span><span class="c">! zero secondary forest tiles in POP where secondary forest area is zero</span>
<a id="ln-1379" name="ln-1379" href="#ln-1379"></a><span class="w">  </span><span class="k">DO </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mland</span><span class="w"></span>
<a id="ln-1380" name="ln-1380" href="#ln-1380"></a><span class="w">     </span><span class="k">IF</span><span class="w"> </span><span class="p">((</span><span class="n">POPLUC</span><span class="p">%</span><span class="n">frac_primf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="n">POPLUC</span><span class="p">%</span><span class="n">frac_forest</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">==</span><span class="mf">0.0</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-1381" name="ln-1381" href="#ln-1381"></a><span class="w">          </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">LUC_EXPT</span><span class="p">%</span><span class="n">prim_only</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1382" name="ln-1382" href="#ln-1382"></a><span class="k">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">landpt</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">cstart</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-1383" name="ln-1383" href="#ln-1383"></a><span class="w">        </span><span class="k">DO </span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">SIZE</span><span class="p">(</span><span class="n">POP</span><span class="p">%</span><span class="n">Iwood</span><span class="p">)</span><span class="w"></span>
<a id="ln-1384" name="ln-1384" href="#ln-1384"></a><span class="w">           </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">Iwood</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1385" name="ln-1385" href="#ln-1385"></a><span class="k">              CALL </span><span class="n">POP_init_single</span><span class="p">(</span><span class="n">POP</span><span class="p">,</span><span class="n">veg</span><span class="p">%</span><span class="n">disturbance_interval</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<a id="ln-1386" name="ln-1386" href="#ln-1386"></a><span class="w">              </span><span class="k">EXIT</span>
<a id="ln-1387" name="ln-1387" href="#ln-1387"></a><span class="k">           ENDIF</span>
<a id="ln-1388" name="ln-1388" href="#ln-1388"></a><span class="k">        ENDDO</span>
<a id="ln-1389" name="ln-1389" href="#ln-1389"></a>
<a id="ln-1390" name="ln-1390" href="#ln-1390"></a><span class="k">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">leaf</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<a id="ln-1391" name="ln-1391" href="#ln-1391"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">nplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">leaf</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNCplantmin</span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">leaf</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">leaf</span><span class="p">)</span><span class="w"></span>
<a id="ln-1392" name="ln-1392" href="#ln-1392"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">pplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">leaf</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioPCplantmin</span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">leaf</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">leaf</span><span class="p">)</span><span class="w"></span>
<a id="ln-1393" name="ln-1393" href="#ln-1393"></a>
<a id="ln-1394" name="ln-1394" href="#ln-1394"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">froot</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<a id="ln-1395" name="ln-1395" href="#ln-1395"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">nplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">froot</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNCplantmin</span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">froot</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">froot</span><span class="p">)</span><span class="w"></span>
<a id="ln-1396" name="ln-1396" href="#ln-1396"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">pplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">froot</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioPCplantmin</span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">froot</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">froot</span><span class="p">)</span><span class="w"></span>
<a id="ln-1397" name="ln-1397" href="#ln-1397"></a>
<a id="ln-1398" name="ln-1398" href="#ln-1398"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">wood</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<a id="ln-1399" name="ln-1399" href="#ln-1399"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">nplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">wood</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNCplantmin</span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">wood</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">wood</span><span class="p">)</span><span class="w"></span>
<a id="ln-1400" name="ln-1400" href="#ln-1400"></a><span class="w">        </span><span class="n">casapool</span><span class="p">%</span><span class="n">pplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">wood</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioPCplantmin</span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">wood</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">wood</span><span class="p">)</span><span class="w"></span>
<a id="ln-1401" name="ln-1401" href="#ln-1401"></a><span class="w">        </span><span class="n">casaflux</span><span class="p">%</span><span class="n">frac_sapwood</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"></span>
<a id="ln-1402" name="ln-1402" href="#ln-1402"></a>
<a id="ln-1403" name="ln-1403" href="#ln-1403"></a><span class="w">     </span><span class="k">ENDIF</span>
<a id="ln-1404" name="ln-1404" href="#ln-1404"></a><span class="k">  ENDDO</span>
<a id="ln-1405" name="ln-1405" href="#ln-1405"></a>
<a id="ln-1406" name="ln-1406" href="#ln-1406"></a><span class="k">  CALL </span><span class="n">POPLUCStep</span><span class="p">(</span><span class="n">POPLUC</span><span class="p">,</span><span class="n">yyyy</span><span class="p">)</span><span class="w"></span>
<a id="ln-1407" name="ln-1407" href="#ln-1407"></a>
<a id="ln-1408" name="ln-1408" href="#ln-1408"></a><span class="w">  </span><span class="k">CALL </span><span class="n">POPLUC_weights_transfer</span><span class="p">(</span><span class="n">POPLUC</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">LUC_EXPT</span><span class="p">)</span><span class="w"></span>
<a id="ln-1409" name="ln-1409" href="#ln-1409"></a>
<a id="ln-1410" name="ln-1410" href="#ln-1410"></a><span class="k">END SUBROUTINE </span><span class="n">LUCdriver</span><span class="w"></span>
</pre></div>

    </section>
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>CABLE was developed by CABLE community<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>